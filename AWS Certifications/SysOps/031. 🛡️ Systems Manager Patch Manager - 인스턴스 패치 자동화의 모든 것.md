
안녕하세요! 이번에는 AWS Systems Manager의 중요한 기능인 **패치 관리자(Patch Manager)**에 대해 자세히 살펴보겠습니다. Patch Manager는 EC2 인스턴스 및 온프레미스 서버의 운영 체제와 애플리케이션에 대한 패치 작업을 자동화하여 시스템의 보안과 안정성을 유지하는 데 도움을 줍니다.

---

## 🧐 Patch Manager의 핵심 구성 요소

Patch Manager는 크게 두 가지 핵심 구성 요소로 이루어져 있습니다. 이 둘을 조합하여 인스턴스에 대한 패치 전략을 정의하고 실행할 수 있습니다.

### 1. 패치 기준선 (Patch Baselines)

**패치 기준선**은 **어떤 패치를 설치할지, 그리고 어떤 패치를 설치하지 않을지**를 정의하는 규칙의 집합입니다.

- **사전 정의된 기준선**: AWS에서 기본적으로 제공하는 기준선으로, 운영체제별로 미리 정의되어 있습니다. 일반적으로 중요 및 보안 패치만 자동으로 승인됩니다.
    
- **사용자 지정 기준선**: 사용자가 직접 승인(Approved) 또는 거부(Rejected)할 패치를 지정하여 커스텀 기준선을 만들 수 있습니다. 특정 패치가 릴리스된 후 자동으로 승인될 시점을 지정할 수도 있습니다.
    

### 2. 패치 그룹 (Patch Groups)

**패치 그룹**은 특정 **패치 기준선**과 연결된 **인스턴스 집합**입니다. 인스턴스에 `Patch Group`이라는 태그를 사용하여 특정 패치 그룹에 포함시킬 수 있습니다.

- **주의사항**:
    
    - 하나의 인스턴스는 오직 하나의 `Patch Group`에만 속할 수 있습니다.
        
    - 하나의 `Patch Group`은 오직 하나의 **패치 기준선**에만 연결될 수 있습니다.

위 다이어그램은 이 관계를 명확하게 보여줍니다.

|EC2 Instance Tag|Patch Group|Associated Patch Baseline|
|---|---|---|
|`Patch Group: dev`|`dev`|`PB98...` (사용자 지정)|
|`(태그 없음)`|`Default`|`PB0123...` (기본값)|
|`(태그 없음)`|`Default`|`PB0123...` (기본값)|

---

## ⚙️ Patch Manager의 작동 원리

![[Pasted image 20250927190545.png]]

Patch Manager는 다음과 같은 과정을 통해 인스턴스를 패치합니다.

1. **시작**: 사용자는 AWS 콘솔, CLI, SDK 또는 **유지 관리 기간(Maintenance Window)**을 통해 패치 작업을 시작합니다.
    
2. **SSM 문서 실행**: `AWS-RunPatchBaseline`이라는 SSM 문서가 대상 인스턴스에 실행됩니다.
    
3. **인스턴스 태그 확인**: SSM Agent는 자신이 속한 패치 그룹 태그를 확인합니다.
    
4. **패치 기준선 조회**: SSM Agent는 패치 그룹에 연결된 패치 기준선을 조회하여 어떤 패치를 설치해야 할지 파악합니다.
    
5. **패치 설치**: SSM Agent가 인스턴스에 필요한 패치를 자동으로 설치합니다.
    
6. **보고서 생성**: 패치 작업 완료 후, 인스턴스별 패치 준수 보고서가 생성됩니다. 이 보고서는 Systems Manager 콘솔에서 확인할 수 있으며, 필요 시 S3 버킷으로 보내 추가 분석을 진행할 수 있습니다.
    

---

## ⏱️ 유지 관리 기간 (Maintenance Windows)

**유지 관리 기간**은 Patch Manager와 함께 사용되는 중요한 기능입니다. 이는 인스턴스에 대한 작업(패치, 드라이버 업데이트, 소프트웨어 설치 등)을 수행할 시간을 정기적으로 정의하는 기능입니다.

- **주요 구성 요소**:
    
    - **스케줄**: 작업이 실행될 시간 및 빈도 (예: 매주 일요일 새벽 3시)
        
    - **대상**: 작업을 수행할 인스턴스 집합 (예: 태그가 `Environment: prod`인 모든 인스턴스)
        
    - **작업**: 유지 관리 기간 동안 실행될 작업 (예: 패치 설치, 재시작 등)
        

유지 관리 기간을 활용하면 운영 중인 시스템에 대한 영향을 최소화하면서 안정적으로 패치 작업을 수행할 수 있습니다.

---

## 📚 마무리

Patch Manager는 복잡한 패치 프로세스를 자동화하여 관리 부담을 줄이고 보안을 강화하는 필수적인 도구입니다. **패치 기준선**으로 패치 정책을 정의하고, **패치 그룹**으로 인스턴스들을 분류하며, **유지 관리 기간**으로 실행 시간을 스케줄링함으로써 효율적이고 안전한 패치 관리를 구현할 수 있습니다.