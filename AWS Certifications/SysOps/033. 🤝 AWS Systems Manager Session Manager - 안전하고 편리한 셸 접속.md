
안녕하세요! 이번 시간에는 AWS Systems Manager의 강력한 기능인 **세션 관리자(Session Manager)**에 대해 알아보겠습니다. 세션 관리자는 EC2 인스턴스에 직접 SSH로 접속하지 않고도 안전하게 셸 환경에 접근할 수 있게 해주는 기능입니다.

---

## 🧐 Session Manager란?

**Session Manager**는 브라우저 기반의 AWS 콘솔, AWS CLI 또는 SDK를 통해 EC2 인스턴스에 대한 대화형 셸을 제공합니다. 이 기능의 가장 큰 장점은 인스턴스에 SSH 포트를 열어두거나 키 페어를 관리할 필요가 없다는 것입니다.

### 기존 SSH 방식과의 차이점

|특징|SSH (전통적인 방식)|Session Manager|
|---|---|---|
|**접속 방식**|SSH 키 페어 사용, 인스턴스에 인바운드 규칙 필요 (Port 22)|IAM 권한 기반, 인스턴스에 인바운드 규칙 불필요|
|**보안**|키 관리 부담, 인스턴스에 직접 포트 노출|외부 노출 없음, IAM 정책으로 세밀한 접근 제어|
|**명령어 기록**|수동으로 로깅 설정 필요 (번거로움)|모든 세션과 명령어 자동 로깅 (S3, CloudWatch Logs)|
|**지원 OS**|Linux, macOS|Linux, macOS, Windows|

### 작동 원리

![[Pasted image 20250927190830.png]]

1. **사전 준비**: EC2 인스턴스에 SSM 에이전트가 설치되어 있어야 하며, SSM 서비스에 연결할 수 있는 적절한 IAM 역할이 인스턴스에 부여되어야 합니다.
    
2. **사용자 접속**: 사용자는 적절한 IAM 권한을 가지고 **Session Manager 서비스**에 접속을 요청합니다.
    
3. **명령 전달**: Session Manager 서비스는 인스턴스 내부의 SSM 에이전트를 통해 사용자의 셸 명령을 실행합니다.
    
4. **보안**: 모든 통신은 AWS 내부 네트워크를 통해 이루어지므로, 인스턴스의 보안 그룹에 인바운드 규칙을 추가할 필요가 없습니다.
    

---

## 🔐 세션 관리자의 보안 및 규정 준수 이점

Session Manager는 기존 SSH 방식에 비해 여러 가지 보안 및 규정 준수 이점을 제공합니다.

- **IAM 기반 권한 제어**: IAM 정책을 사용하여 '누가', '어떤 인스턴스에', '어떤 명령어'를 실행할 수 있는지 매우 세밀하게 제어할 수 있습니다. 예를 들어, 특정 사용자에게 태그가 `Environment: dev`인 인스턴스에만 접속을 허용하는 정책을 만들 수 있습니다.
    
- **명령어 로깅**: 모든 세션 활동과 실행된 명령어는 S3 버킷이나 CloudWatch Logs에 자동으로 기록됩니다. 이를 통해 누가 언제 어떤 작업을 했는지 명확하게 추적할 수 있어 **감사(Audit)** 및 **보안 컴플라이언스** 요구사항을 쉽게 충족할 수 있습니다.
    
- **CloudTrail 통합**: `StartSession` 이벤트는 CloudTrail에 기록되어 세션 시작에 대한 정보를 감사할 수 있습니다.
    

### 📜 IAM 정책 예시

다음은 `Environment` 태그가 `dev`로 설정된 모든 인스턴스에 대한 세션 접속을 허용하는 IAM 정책의 예시입니다.

```JSON
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "SessionManagerConnect",
            "Effect": "Allow",
            "Action": "ssm:StartSession",
            "Resource": [
                "arn:aws:ec2:*:*:instance/*"
            ],
            "Condition": {
                "StringLike": {
                    "ssm:resourceTag/Environment": [
                        "dev"
                    ]
                }
            }
        },
        {
            "Sid": "SessionManagerAccess",
            "Effect": "Allow",
            "Action": [
                "ssm:DescribeSessions",
                "ssm:GetConnectionStatus",
                "ssm:TerminateSession"
            ],
            "Resource": "*"
        }
    ]
}
```

---

## 📚 마무리

**Session Manager**는 보안을 강화하면서도 편리한 방식으로 인스턴스에 접근할 수 있게 해주는 혁신적인 서비스입니다. 인바운드 규칙을 열지 않아도 되고, 키 페어를 관리할 필요도 없으며, 모든 활동이 자동으로 기록되기 때문에 운영 효율성과 보안을 동시에 확보할 수 있습니다.

**Run Command**가 단발성 명령 실행에 초점을 맞춘다면, **Session Manager**는 대화형 셸 환경을 제공한다는 점에서 차이가 있습니다. 앞으로의 실습에서 이 기능을 직접 사용해보며 그 편리함을 경험해 보시길 바랍니다!