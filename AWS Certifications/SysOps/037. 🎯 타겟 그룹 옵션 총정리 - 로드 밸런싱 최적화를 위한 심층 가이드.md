
안녕하세요! 이번 시간에는 AWS 로드 밸런싱의 핵심 구성 요소인 **타겟 그룹(Target Group)**에 설정할 수 있는 다양한 옵션들을 자세히 살펴보겠습니다. 이 옵션들은 로드 밸런싱의 동작 방식을 미세 조정하여 애플리케이션의 성능과 안정성을 최적화하는 데 매우 중요합니다.

---

## 1. ⏱️ 주요 설정 옵션

### **1.1. Deregistration delay (등록 해제 지연)**

- **설명**: 타겟 그룹에서 인스턴스를 등록 해제할 때, 로드 밸런서가 해당 인스턴스로 트래픽 전송을 완전히 중단하기 전까지 기다리는 시간입니다.
    
- **목적**: 기존에 처리 중이던 요청이 완료될 시간을 주어 서비스 중단을 방지합니다.
    

### **1.2. Slow start (느린 시작)**

- **설명**: 새로운 인스턴스가 타겟 그룹에 추가될 때, 즉시 전체 트래픽을 받지 않고 트래픽을 점진적으로 증가시키는 기능입니다.
    
- **목적**: 인스턴스가 갑작스러운 트래픽 폭주로 인해 과부하되는 것을 방지하고, 충분히 워밍업(warm-up)할 시간을 제공합니다.
    
- **작동 방식**:
    
    - **Slow start 비활성화 (기본값)**: 인스턴스가 `healthy` 상태가 되면 즉시 전체 트래픽을 받습니다.
        
    - **Slow start 활성화**: 설정된 시간(예: 30초) 동안 트래픽이 `0%`에서 `100%`까지 선형적으로 증가합니다.
  

---

## 2. ⚖️ 요청 라우팅 알고리즘

타겟 그룹은 요청을 어떤 인스턴스로 보낼지 결정하는 라우팅 알고리즘을 설정할 수 있습니다.

### **2.1. Least Outstanding Requests (최소 미처리 요청)**


![[Pasted image 20250927191339.png]]

- **설명**: 현재 처리 중인 요청이 가장 적은 인스턴스로 새로운 요청을 보냅니다.
    
- **적용**: ALB(Application Load Balancer), CLB(Classic Load Balancer)
    
- **장점**: 각 인스턴스의 부하를 실시간으로 고려하여 균등하게 분산시킵니다. 트래픽 처리 속도가 인스턴스마다 다른 경우에 특히 유용합니다.

### **2.2. Round Robin (라운드 로빈)**

![[Pasted image 20250927191354.png]]

- **설명**: 인스턴스들이 순서대로 번갈아 가며 요청을 받습니다.
    
- **적용**: ALB, CLB
    
- **장점**: 가장 단순하고 공평한 방식입니다. 모든 인스턴스의 처리 속도가 거의 동일할 때 효율적입니다.

### **2.3. Flow Hash (플로우 해시)**

![[Pasted image 20250927191403.png]]

- **설명**: 소스 IP, 목적지 IP, 포트 번호 등 연결 정보를 해시(hash)하여 동일한 연결의 모든 요청이 동일한 인스턴스로 라우팅되도록 합니다.
    
- **적용**: NLB(Network Load Balancer)
    
- **장점**: TCP/UDP 연결의 생명주기 동안 동일한 타겟으로 트래픽을 보내므로, 세션 일관성을 유지해야 하는 애플리케이션에 적합합니다. 이는 **NLB의 스티키 세션**과 같은 역할을 합니다.


---

## 3. 🍪 스티키 세션 (Stickiness)

**스티키 세션**은 특정 사용자의 모든 요청이 동일한 인스턴스로 전송되도록 보장하는 기능입니다.

- **설명**: HTTP/HTTPS 기반의 로드 밸런서(ALB, CLB)에서 특정 쿠키를 사용하여 세션 일관성을 유지합니다.
    
- **유형**:
    
    - **Application-based**: 애플리케이션에서 직접 발행하는 쿠키를 사용합니다.
        
    - **Duration-based**: 로드 밸런서가 발행하는 쿠키를 사용하며, 설정된 기간 동안 세션이 유지됩니다.

---

## 4. ⚙️ 실습: 타겟 그룹 옵션 설정 변경하기

1. **EC2 콘솔**에서 **Target Groups**로 이동합니다.
    
2. 설정을 변경할 타겟 그룹을 선택하고, **Attributes** 탭을 클릭한 후 **Edit**을 누릅니다.
    
3. `Deregistration delay`, `Slow start duration`, `Algorithm`, `Stickiness` 등 다양한 옵션을 확인할 수 있습니다.
    
4. 예를 들어, **Slow start duration**을 30초로 설정하여 새로운 인스턴스가 점진적으로 트래픽을 받도록 할 수 있습니다. 또한 **Routing algorithm**을 `Round Robin` 대신 `Least Outstanding Requests`로 변경하여 부하가 가장 적은 인스턴스로 요청을 보내도록 설정할 수 있습니다.
    

---

## 📚 마무리

타겟 그룹의 옵션들을 이해하고 적절하게 설정하는 것은 로드 밸런서의 성능을 최적화하고, 애플리케이션의 안정성을 높이는 데 필수적입니다. 특히, **Slow start**는 새로운 인스턴스가 서비스에 합류할 때 발생할 수 있는 과부하를 방지하는 중요한 기능이며, **라우팅 알고리즘**은 애플리케이션의 특성에 따라 부하 분산 방식을 선택하는 데 결정적인 역할을 합니다.