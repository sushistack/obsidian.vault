
## 🚦 EC2 상태 확인(Status Checks)이란?

![[Pasted image 20250921164341.png]]

**EC2 상태 확인(Status Checks)**은 AWS에서 제공하는 자동화된 모니터링 기능으로, EC2 인스턴스의 하드웨어 및 소프트웨어 문제를 식별하는 데 사용됩니다. 이 기능은 문제를 조기에 발견하고 대응하여 서비스 가용성을 높이는 데 필수적입니다.

EC2 상태 확인은 크게 세 가지 유형으로 나뉩니다.

### 1. 시스템 상태 확인 (System Status Check)

이 확인은 인스턴스가 실행되는 **물리적 호스트(Physical Host)**의 문제를 감지합니다. AWS 인프라의 하드웨어 오류나 전원 손실과 같은 문제입니다.

- **주요 원인:**
    
    - 하드웨어 손실
        
    - AWS 시스템 소프트웨어 문제
        
    - 네트워크 연결 문제
        
    - 호스트 전원 손실
        
- **해결 방법:** 인스턴스를 **정지(Stop)했다가 다시 시작(Start)**하면, AWS가 인스턴스를 문제없는 다른 물리적 호스트로 마이그레이션하여 문제를 해결할 수 있습니다. `재부팅(Reboot)`은 동일한 호스트 내에서만 작동하므로 효과가 없습니다.
    

### 2. 인스턴스 상태 확인 (Instance Status Check)

이 확인은 인스턴스 자체의 **소프트웨어 및 네트워크 구성** 문제를 감지합니다.

- **주요 원인:**
    
    - OS(운영체제) 오작동 또는 충돌
        
    - 잘못된 네트워크 설정
        
    - 메모리 부족으로 인한 인스턴스 정지
        
    - 인스턴스 내부의 손상된 파일 시스템
        
- **해결 방법:** 인스턴스를 **재부팅(Reboot)**하거나, 인스턴스 설정을 변경하여 문제를 해결할 수 있습니다.
    

### 3. EBS 연결 상태 확인 (Attached EBS Status Check)

이 확인은 인스턴스에 연결된 **EBS 볼륨의 연결 상태**를 감지합니다.

- **주요 원인:**
    
    - EBS 볼륨이 인스턴스에 올바르게 연결되지 않았거나, I/O 작업이 불가능한 경우.
        
- **해결 방법:** 인스턴스를 **재부팅(Reboot)**하거나, 영향을 받는 **EBS 볼륨을 교체**하여 문제를 해결합니다.
    

---

## 🤖 자동 복구(Automated Recovery) 전략

AWS CloudWatch와 다른 서비스를 연동하여 EC2 상태 확인 실패 시 인스턴스를 자동으로 복구할 수 있습니다.

![[Pasted image 20250921164427.png]]

### 1. CloudWatch 경보 및 복구 작업 (CloudWatch Alarm and Recovery Action)

이 전략은 **단일 인스턴스**의 중요한 상태를 보존하면서 자동 복구를 수행하는 가장 선호되는 방법입니다.

- **동작 원리:**
    
    1. CloudWatch가 `StatusCheckFailed_System` 또는 `StatusCheckFailed_Instance`와 같은 지표를 모니터링합니다.
        
    2. 지표 값이 `1`(실패)로 변경되면 CloudWatch 경보가 트리거됩니다.
        
    3. 경보의 작업으로 **`인스턴스 복구(Recover Instance)`**를 설정합니다.
        
- **복구 특징:** 인스턴스 복구 작업은 실패한 인스턴스를 다른 정상적인 하드웨어로 옮기지만, **동일한 인스턴스 ID, 프라이빗 IP, 퍼블릭 IP, EIP 및 메타데이터**를 유지합니다. 이는 인스턴스의 중요한 속성을 그대로 보존해야 하는 경우에 매우 유용합니다.
    
- **알림:** 경보가 트리거될 때 **SNS(Simple Notification Service)**로 알림을 전송하여 사용자에게 문제 발생을 통보할 수 있습니다.
    

### 2. 오토 스케일링 그룹 (Auto Scaling Group)

이 전략은 인스턴스의 속성 유지보다는 **서비스의 지속적인 가용성**을 중요시할 때 사용합니다.

- **동작 원리:**
    
    1. `Min` 및 `Desired` 용량을 `1`로 설정한 오토 스케일링 그룹을 구성합니다.
        
    2. 오토 스케일링 그룹의 **상태 확인(Health Check)**을 EC2 상태 확인에 연동합니다.
        
    3. `System Status Check`나 `Instance Status Check`가 실패하면, 오토 스케일링 그룹은 해당 인스턴스를 **비정상(unhealthy)**으로 판단하고 자동으로 **종료(terminate)**합니다.
        
- **복구 특징:** 오토 스케일링 그룹은 종료된 인스턴스를 대신하여 **새로운 인스턴스**를 시작합니다. 이 과정에서 **새로운 프라이빗 IP, 퍼블릭 IP, 인스턴스 ID**가 할당됩니다.
    
- **용도:** 웹 서버 같이 상태가 없는(stateless) 애플리케이션에 적합합니다.
    

---

## 📝 상태 점검 및 복구 요약

|상태 점검 유형|원인|복구 방법|권장 자동 복구 전략|
|---|---|---|---|
|**시스템**|AWS 물리적 호스트 문제|**Stop & Start**|CloudWatch 경보 (복구 작업)|
|**인스턴스**|인스턴스 OS/네트워크 문제|**Reboot**|CloudWatch 경보 (복구 작업)|
|**EBS**|EBS 볼륨 연결 문제|**Reboot**|CloudWatch 경보 (복구 작업)|

이러한 상태 확인과 자동 복구 전략을 활용하면, EC2 인스턴스의 잠재적인 문제를 신속하게 해결하고, 애플리케이션의 높은 가용성을 보장할 수 있습니다.