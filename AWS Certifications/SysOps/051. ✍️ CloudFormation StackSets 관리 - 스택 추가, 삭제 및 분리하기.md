
## ➕ StackSets에 스택 추가하기

기존에 생성된 **StackSets**에 새로운 스택 인스턴스를 추가하여 배포 범위를 확장할 수 있습니다. 이는 새로운 계정이나 리전에 리소스를 추가로 배포해야 할 때 유용합니다.

### 작업 단계

1. **StackSets 콘솔 접속**: AWS CloudFormation 콘솔의 **StackSets** 메뉴로 이동합니다.
    
2. **`Actions` 클릭**: 관리하려는 StackSet을 선택한 후, `Actions` 메뉴에서 **`Add stacks to StackSet`**을 클릭합니다.
    
3. **대상 지정**:
    
    - **계정**: 추가할 AWS 계정 ID를 입력합니다. 여러 계정을 추가할 수 있습니다.
        
    - **리전**: 스택 인스턴스를 배포할 리전을 선택합니다. 기존에 배포된 리전 외에 새로운 리전을 추가할 수 있습니다.
        
4. **배포 옵션 설정**: 기존 StackSets 배포와 동일하게 동시 배포 수, 실패 허용치 등 배포 옵션을 설정합니다.
    
5. **제출**: 모든 설정을 확인하고 제출하면, StackSets는 지정된 계정과 리전에 새로운 스택 인스턴스를 생성하는 작업을 시작합니다.
    

이 작업은 새로운 배포 작업(Operation)으로 기록되며, StackSets 콘솔에서 진행 상황을 실시간으로 모니터링할 수 있습니다.

---

## ➖ StackSets에서 스택 제거하기

StackSets에서 스택 인스턴스를 제거하는 방법은 두 가지가 있습니다.

### 1. StackSets에서 스택 **분리(Detach)**하기

특정 스택 인스턴스를 StackSets의 관리 대상에서 제외하고 싶을 때 사용합니다. 스택 인스턴스는 제거되지만, **실제 스택 리소스는 AWS 계정에 그대로 남아 있습니다.** 이는 특정 리전을 StackSets 관리 범위에서 제외하면서도 해당 리소스는 계속 유지하고 싶을 때 유용합니다.

|작업 단계|설명|
|---|---|
|`Actions` > `Delete stacks from StackSet`|삭제 작업을 시작합니다.|
|계정 및 리전 지정|분리할 스택 인스턴스의 계정 ID와 리전을 선택합니다.|
|**`Retain stacks` 옵션 활성화**|**가장 중요한 단계입니다.** 이 옵션을 활성화하면 스택 인스턴스는 StackSets에서 관리되지 않게 되지만, 실제 스택과 리소스는 삭제되지 않고 유지됩니다.|
|제출|작업을 제출합니다.|

이 작업이 완료되면 StackSets 콘솔의 `Stack instances` 목록에서 해당 인스턴스가 사라지지만, 해당 리전의 CloudFormation 스택 목록에는 여전히 존재합니다.

### 2. StackSets에서 스택 **삭제(Delete)**하기

StackSets의 관리 대상에서 스택 인스턴스를 완전히 제거하고, **해당 스택과 모든 리소스를 실제로 삭제**합니다.

|작업 단계|설명|
|---|---|
|`Actions` > `Delete stacks from StackSet`|삭제 작업을 시작합니다.|
|계정 및 리전 지정|삭제할 스택 인스턴스의 계정 ID와 리전을 선택합니다. 모든 스택 인스턴스를 삭제하려면 모두 선택합니다.|
|**`Retain stacks` 옵션 비활성화**|이 옵션이 비활성화된 상태로 진행하면 실제 스택과 모든 리소스가 삭제됩니다.|
|제출|작업을 제출합니다.|

이 작업은 시간이 다소 소요될 수 있으며, 작업 완료 후에는 해당 스택과 모든 리소스가 AWS 계정에서 삭제됩니다.

---

## 🧹 StackSets 전체 삭제 및 정리

StackSets 자체를 삭제하기 위해서는 먼저 해당 StackSets에 포함된 **모든 스택 인스턴스가 삭제되어야 합니다.**

### 작업 단계

1. **스택 인스턴스 전체 삭제**: 위에서 설명한 "StackSets에서 스택 삭제하기" 방법을 사용하여 모든 스택 인스턴스를 완전히 삭제합니다.
    
2. **StackSets 삭제**: 모든 스택 인스턴스가 제거되면, `Actions` > `Delete StackSet`을 클릭하여 StackSets를 삭제합니다.
    

### 최종 정리

StackSets를 완전히 정리하려면, 초기 설정 단계에서 생성했던 **관리자(Admin) 및 실행(Execution) IAM 역할**도 함께 삭제해야 합니다. 이 역할들은 CloudFormation 스택으로 생성되었으므로, 해당 스택을 삭제하면 역할도 함께 정리됩니다.

이러한 관리 절차를 통해 StackSets를 효율적으로 운영하고, 불필요한 리소스와 IAM 역할을 안전하게 정리할 수 있습니다.