
## 🚀 EC2 인스턴스 종료 동작(Shutdown Behavior) 이해하기

EC2 인스턴스의 **종료 동작(Shutdown Behavior)**은 인스턴스 내에서 운영체제(OS) 종료 명령(`sudo shutdown`)이 실행되었을 때, 인스턴스가 어떻게 반응할지를 결정하는 설정입니다. 이 설정은 AWS 콘솔이나 CLI를 통해 인스턴스를 종료(terminate)하는 것과는 다른 동작을 합니다.

![[Pasted image 20250921162919.png]]

종료 동작에는 두 가지 옵션이 있습니다.

|옵션|설명|
|---|---|
|**Stop** (기본값)|인스턴스 내에서 운영체제가 종료되면, **EC2 인스턴스는 중지(Stop)됩니다.** 인스턴스가 중지 상태가 되면 다시 시작할 수 있으며, 데이터는 유지됩니다.|
|**Terminate**|인스턴스 내에서 운영체제가 종료되면, **EC2 인스턴스는 즉시 종료(Terminate)됩니다.** 인스턴스가 종료되면 복구할 수 없으며, 모든 데이터가 손실됩니다.|

---

## 🛡️ 종료 보호(Termination Protection) 설정하기

**종료 보호(Termination Protection)**는 실수로 AWS 콘솔이나 CLI를 통해 인스턴스가 종료되는 것을 방지하는 기능입니다. 이 설정을 활성화하면, 사용자가 직접 인스턴스를 종료하려고 시도할 때 오류 메시지가 표시되며 종료가 허용되지 않습니다.

### 🤔 종료 보호와 종료 동작의 관계

많은 사람들이 혼동하는 부분은 바로 **종료 보호**와 **종료 동작**의 상호작용입니다. 두 설정은 다음과 같은 중요한 차이점을 가지고 있습니다.

- **종료 보호:** **AWS 콘솔/CLI**를 통한 **외부**의 종료 명령을 막습니다.
    
- **종료 동작:** 인스턴스 **내부 OS**에서 시작된 종료 명령에 대한 동작을 결정합니다.
    

**💡 핵심 요약:**

> 종료 동작을 **Terminate**로 설정하고, 동시에 **종료 보호**를 활성화하더라도, **인스턴스 내부에서 `sudo shutdown` 명령을 실행하면 인스턴스는 보호 설정을 무시하고 종료됩니다.**

이것이 가능한 이유는 `sudo shutdown` 명령이 인스턴스 내부에서 발생한 이벤트이고, 종료 보호는 외부(콘솔/CLI)로부터의 API 호출을 보호하기 때문입니다.

---

## 🖥️ 실습: 종료 동작과 종료 보호 함께 사용해보기

다음 실습을 통해 두 설정의 동작 방식을 직접 확인해 보겠습니다.

### 1. EC2 인스턴스 생성 및 설정

1. EC2 대시보드에서 **'인스턴스 시작'**을 클릭합니다.
    
2. `Amazon Linux 2` AMI를 선택하고, `t2.micro`와 같은 인스턴스 유형을 선택합니다.
    
3. **'고급 세부 정보'** 섹션을 확장합니다.
    
4. **'종료 동작(Shutdown Behavior)'**을 **`종료(Terminate)`**로 설정합니다.
    
5. **'종료 방지(Termination Protection)'**를 **`활성화(Enable)`**로 설정합니다.
    
6. 필요한 다른 설정을 완료하고 인스턴스를 시작합니다.
    

### 2. AWS 콘솔에서 종료 시도하기 (실패)

1. 인스턴스가 `running` 상태가 되면, EC2 대시보드에서 해당 인스턴스를 선택합니다.
    
2. **'인스턴스 상태'** 메뉴에서 **'인스턴스 종료'**를 클릭합니다.
    
3. 종료가 실패하고 오류 메시지가 나타나는 것을 확인할 수 있습니다. 이는 **종료 보호**가 활성화되어 있기 때문입니다.
    

### 3. 인스턴스 내부에서 종료 명령 실행하기 (성공)

1. EC2 인스턴스에 접속합니다. (예: EC2 Instance Connect, SSH)
    
2. 다음 명령어를 입력하여 인스턴스 내부에서 종료를 시작합니다.
    
    Bash
    
    ```
    sudo shutdown
    ```
    
3. 명령어가 실행되면 인스턴스에 대한 연결이 끊어집니다.
    
4. EC2 대시보드로 돌아가서 인스턴스 상태를 확인하면, 잠시 후 인스턴스가 `terminated` 상태로 변경되는 것을 볼 수 있습니다.
    

---

## 📝 결론

이 실습을 통해 **종료 보호**는 **콘솔/CLI**를 통한 의도치 않은 종료를 막지만, 인스턴스 내에서 **OS 종료 명령**이 발생했을 때는 **종료 동작** 설정에 따라 인스턴스가 종료될 수 있다는 것을 명확히 이해할 수 있습니다. 각 설정의 역할을 정확히 파악하여 인스턴스를 안전하게 운영하는 것이 중요합니다.