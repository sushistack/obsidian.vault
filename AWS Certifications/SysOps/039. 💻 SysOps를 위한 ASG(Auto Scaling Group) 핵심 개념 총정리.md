

안녕하세요! AWS SysOps 자격증 시험을 준비하는 분들을 위해 Auto Scaling Group(ASG)의 핵심 기능들을 상세히 정리해 보았습니다. ASG는 고가용성과 확장성을 보장하는 데 필수적인 서비스입니다.

---

## 1. 🔄 라이프사이클 훅 (Lifecycle Hooks)

![[Pasted image 20250927191657.png]]

**라이프사이클 훅**은 ASG가 인스턴스를 시작하거나 종료할 때, 특정 시점에 사용자 정의 작업을 수행하도록 돕는 기능입니다. 이를 통해 인스턴스가 서비스에 완전히 투입되기 전 또는 종료되기 전에 필요한 작업을 완료할 수 있습니다.

|단계|라이프사이클 훅 상태|설명|
|---|---|---|
|**인스턴스 시작**|`Pending` → **`Pending:Wait`** → `Pending:Proceed` → `InService`|인스턴스가 서비스에 투입되기 전, 초기 설정 스크립트 실행 등 맞춤형 로직을 수행할 시간을 확보합니다.|
|**인스턴스 종료**|`InService` → `Terminating` → **`Terminating:Wait`** → `Terminating:Proceed` → `Terminated`|인스턴스 종료 직전, 로그 추출, EBS 스냅샷 생성 등 정리 작업을 수행할 시간을 확보합니다.|

**통합**: 라이프사이클 훅 이벤트는 **EventBridge, SQS, SNS**와 연동하여 AWS Lambda 함수 등을 트리거할 수 있습니다.

---

## 2. 🚀 시작 구성 vs. 시작 템플릿 (Launch Configuration vs. Launch Templates)

두 기능 모두 ASG가 인스턴스를 시작할 때 사용되는 템플릿이지만, **Launch Templates**가 **Launch Configuration**의 단점을 보완한 최신 기능입니다.

|특징|Launch Configuration|Launch Templates|
|---|---|---|
|**활용성**|단일 버전 (수정 불가, 재생성 필요)|다중 버전 (새로운 버전 생성 가능)|
|**인스턴스 타입**|단일 타입만 가능|여러 타입 가능 (온디맨드, 스팟 혼합)|
|**추가 기능**|제한적 (기존 인스턴스 옵션만 지원)|**배치 그룹, 용량 예약, 전용 호스트** 등 다양한 기능 지원|
|**권장 사항**|**레거시 기능 (사용 권장하지 않음)**|**AWS가 권장하는 최신 기능**|

---

## 3. 📊 SQS와 ASG 연동: 메시지 기반 스케일링

![[Pasted image 20250927191716.png]]

ASG는 **CloudWatch 지표**를 기반으로 스케일링됩니다. SQS 큐의 메시지 수를 지표로 사용하여 ASG를 확장할 수 있습니다.

- **지표**: SQS의 `ApproximateNumberOfMessagesVisible` 지표를 사용합니다.
    
- **작동 방식**: SQS 큐에 메시지 수가 일정 임계치를 초과하면 CloudWatch 알람이 울리고, ASG가 인스턴스를 추가하여 메시지 처리량을 높입니다.
    

---

## 4. 🩺 ASG 헬스 체크

ASG는 여러 종류의 헬스 체크를 통해 인스턴스의 상태를 지속적으로 확인하고, 비정상적인 인스턴스를 자동으로 교체합니다.

- **EC2 상태 검사 (기본)**: 인스턴스의 하드웨어 및 운영 체제 수준의 상태를 확인합니다.
    
- **ELB 헬스 체크**: ELB의 타겟 그룹 헬스 체크와 연동됩니다. ELB가 인스턴스를 `unhealthy`로 판단하면, ASG도 해당 인스턴스를 `unhealthy`로 간주하고 교체합니다.
    
- **사용자 지정 헬스 체크**: `aws autoscaling set-instance-health` CLI 명령어를 사용하여 인스턴스 상태를 ASG에 수동으로 전달합니다.
    

**✅ 중요**: ASG는 비정상 인스턴스를 **재부팅하는 대신 즉시 종료하고 새로운 인스턴스를 시작**합니다.

---

## 5. ⚠️ ASG 문제 해결 팁

- **최대 용량(Maximum capacity) 도달**: ASG의 최대 용량 설정이 현재 인스턴스 수보다 크지 않은지 확인하세요.
    
- **가용 영역(AZ) 용량 부족**: 지정된 AZ에 인스턴스 시작을 위한 용량이 충분하지 않을 수 있습니다.
    
- **시작 템플릿/구성 오류**: 시작 템플릿에 지정된 **보안 그룹**이나 **키 페어**가 삭제되었을 수 있습니다.
    
- **프로세스 일시 중단**: ASG가 24시간 동안 인스턴스를 시작하지 못하면, 자동 스케일링 프로세스를 자동으로 일시 중단합니다. 이 경우 직접 문제를 해결하고 프로세스를 재개해야 합니다.