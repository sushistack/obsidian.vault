
안녕하세요! 오늘은 EC2 인스턴스의 네트워크 성능을 극대화하는 **향상된 네트워킹(Enhanced Networking)** 기술에 대해 알아보겠습니다. 이 기술은 특히 고성능 컴퓨팅 환경에서 중요한 역할을 합니다.

### 1. 향상된 네트워킹이란?

향상된 네트워킹은 EC2 인스턴스에 더 높은 대역폭과 더 많은 패킷 처리량(PPS)을 제공하고, 네트워크 지연 시간(Latency)을 줄여주는 기술입니다. 이를 위해 **SR-IOV(Single Root I/O Virtualization)**라는 가상화 기술을 사용하며, 크게 두 가지 옵션이 있습니다.

|기술|특징|용도|
|---|---|---|
|**Elastic Network Adapter (ENA)**|• 최신 기술 • 최대 100Gbps 대역폭 제공 • 대부분의 최신 인스턴스에서 지원|일반적인 고성능 네트워킹|
|**Intel VF**|• 레거시(Legacy) 기술 • 최대 10Gbps 대역폭 제공|ENA를 지원하지 않는 이전 세대 인스턴스|

---

### 2. Elastic Fabric Adapter (EFA)

**EFA**는 ENA의 향상된 버전으로, 특히 **고성능 컴퓨팅(HPC, High Performance Computing)** 환경에 최적화된 기술입니다. 여러 인스턴스가 하나의 클러스터 내에서 긴밀하게 통신할 때, 네트워크 성능을 극적으로 향상시킵니다.

**EFA의 주요 특징**

- **HPC에 최적화:** MPI(Message Passing Interface) 표준을 활용하여 노드 간 통신을 가속화합니다.
    
- **OS 바이패스:** 리눅스 운영 체제를 우회하여 더욱 낮은 지연 시간으로 데이터를 전송합니다.
    
- **신뢰성 높은 전송:** 신뢰성 있는 전송 메커니즘을 내장하고 있어 데이터 손실 없이 안정적인 통신을 보장합니다.
    
- **리눅스에서만 작동:** 현재 EFA는 리눅스 운영 체제에서만 사용할 수 있습니다.

### 3. 실습: ENA 활성화 확인하기

EC2 인스턴스가 향상된 네트워킹을 사용하고 있는지 확인하는 방법을 살펴보겠습니다. 이를 위해서는 ENA를 지원하는 최신 세대 인스턴스가 필요합니다.

#### **준비 단계**

1. **새로운 인스턴스 생성:** `t3.micro` 타입의 인스턴스를 추가로 생성합니다. `t3.micro`는 `t2.micro`보다 최신 세대 인스턴스로, ENA를 지원합니다.
    
2. **설정:** AMI는 `Amazon Linux 2`, 키 페어는 기존에 사용하던 `DemoKeyPair`를 선택합니다. 보안 그룹은 SSH 접속이 허용된 기존 `AWSSSH`를 사용합니다.
    
3. **인스턴스 시작:** 나머지 설정은 기본값으로 두고 인스턴스를 시작합니다.
    

#### **실습: ENA 드라이버 확인**

**1. `t2.micro` 인스턴스에서 확인 (구세대)**

`t2.micro` 인스턴스에 접속하여 네트워크 드라이버를 확인해 봅시다. `modinfo ena` 명령어를 실행하면 Amazon Linux 2에 ENA 모듈이 설치되어 있음을 확인할 수 있습니다. 하지만 실제로 사용하고 있는지 확인하려면 `ethtool` 명령어를 사용해야 합니다.

```Bash
# ENA 모듈이 설치되어 있는지 확인
modinfo ena

# 네트워크 인터페이스 드라이버 확인
ethtool -i eth0
```

`ethtool -i eth0` 명령어의 결과에서 `driver` 항목을 보면 `vif`라고 표시됩니다. 이는 **EBS 기반 인스턴스이므로 모듈은 설치되어 있지만, 구세대 인스턴스이기에 ENA를 사용하지 않고 레거시 드라이버를 사용하고 있다는 의미**입니다.

**2. `t3.micro` 인스턴스에서 확인 (신세대)**

이번에는 `t3.micro` 인스턴스에 접속하여 같은 명령어를 실행해 봅시다.

```Bash
# ENA 모듈이 설치되어 있는지 확인
modinfo ena

# 네트워크 인터페이스 드라이버 확인
ethtool -i eth0
```

`t3.micro` 인스턴스에서도 `modinfo ena` 결과는 동일합니다. 그러나 `ethtool -i eth0` 결과에서 `driver` 항목을 보면 **`ena`**라고 표시됩니다.

|인스턴스 타입|`ethtool -i eth0` 드라이버|향상된 네트워킹 사용 여부|
|---|---|---|
|**`t2.micro`**|`vif`|❌ (사용하지 않음)|
|**`t3.micro`**|`ena`|✅ (사용 중)|

이 결과는 **ENA 기반의 향상된 네트워킹을 활용하려면 최신 세대 EC2 인스턴스를 사용해야 한다는 것을 명확히 보여줍니다.** Amazon Linux 2를 사용하면 ENA 모듈이 기본적으로 설치되어 있어 편리합니다.

### 4. 정리 및 마무리

- **ENA(Elastic Network Adapter):** 일반적인 고성능 네트워킹에 사용됩니다.
    
- **EFA(Elastic Fabric Adapter):** HPC 클러스터와 같이 노드 간 긴밀한 통신이 필요한 환경에 특화된, ENA보다 더 강력한 솔루션입니다.
    

실습을 마쳤다면, 불필요한 비용이 발생하지 않도록 **`t3.micro` 인스턴스를 반드시 종료(Terminate)해 주세요.**

궁금한 점이 있다면 언제든지 질문해 주세요. 다음 강의에서 뵙겠습니다!