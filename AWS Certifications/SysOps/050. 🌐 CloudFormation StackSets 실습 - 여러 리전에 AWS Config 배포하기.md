
## π€ AWS StackSetsλ¥Ό ν™μ©ν• μΈν”„λΌ λ°°ν¬ μλ™ν™”

![[Pasted image 20250928160727.png]]

μ΄ μ‹¤μµμ—μ„λ” AWS CloudFormation **StackSets**λ¥Ό μ‚¬μ©ν•μ—¬ λ‹¨μΌ κ³„μ • λ‚΄μ μ—¬λ¬ λ¦¬μ „(Region)μ— **AWS Config**λ¥Ό λ°°ν¬ν•λ” λ°©λ²•μ„ μ•μ•„λ΄…λ‹λ‹¤. μ΄ μ‹λ‚λ¦¬μ¤λ” μΈν”„λΌμ κµ¬μ„±μ„ μ§€μ†μ μΌλ΅ μ¶”μ ν•κ³  κ΄€λ¦¬ν•΄μ•Ό ν•λ” μΌλ°μ μΈ μ‚¬μ© μ‚¬λ΅€λ¥Ό λ°μν•©λ‹λ‹¤.

AWS Configλ” κ³„μ • λ‚΄ λ¨λ“  λ¦¬μ†μ¤μ κµ¬μ„± λ³€κ²½ μ‚¬ν•­μ„ κΈ°λ΅ν•λ” κ΄€λ¦¬ μ„λΉ„μ¤μ…λ‹λ‹¤. StackSetsλ¥Ό ν™μ©ν•λ©΄ λ¨λ“  λ¦¬μ „μ— AWS Configλ¥Ό μΌκ΄€λκ² ν™μ„±ν™”ν•μ—¬ μ¤‘μ•™ μ§‘μ¤‘μ‹μΌλ΅ μΈν”„λΌμ λ³€ν™”λ¥Ό λ¨λ‹ν„°λ§ν•  μ μμµλ‹λ‹¤.

---

## π› οΈ StackSets λ°°ν¬λ¥Ό μ„ν• μ‚¬μ „ μ¤€λΉ„: IAM μ—­ν•  μ„¤μ •

StackSetsλ¥Ό μ‚¬μ©ν•λ ¤λ©΄ κ΄€λ¦¬μ κ³„μ •κ³Ό λ€μƒ κ³„μ • κ°„μ— **IAM μ—­ν• (IAM Role)**μ„ ν†µν• κ¶ν• μ„¤μ •μ΄ ν•„μμ μ…λ‹λ‹¤. μ΄ μ‹¤μµμ€ λ‹¨μΌ AWS κ³„μ •μ—μ„ μ§„ν–‰λλ―€λ΅, ν•΄λ‹Ή κ³„μ •μ€ κ΄€λ¦¬μ κ³„μ •μ΄μ λ€μƒ κ³„μ •μ΄ λ©λ‹λ‹¤.

### 1. κ΄€λ¦¬μ μ—­ν• (Admin Role) μƒμ„±

μ΄ μ—­ν• μ€ CloudFormation StackSets μ„λΉ„μ¤κ°€ μ¤νƒμ„ λ°°ν¬ν•κΈ° μ„ν•΄ μ‚¬μ©ν•©λ‹λ‹¤.

- **μ—­ν•  μ΄λ¦„**: `AWSCloudFormationStackSetAdministrationRole`
    
- **μ‹ λΆ° μ •μ±…**: CloudFormation μ„λΉ„μ¤κ°€ μ΄ μ—­ν• μ„ λ§΅μ„ μ μλ„λ΅ ν—μ©ν•©λ‹λ‹¤.
    
- **κ¶ν• μ •μ±…**: λ€μƒ κ³„μ •μ `AWSCloudFormationStackSetExecutionRole`μ„ λ§΅μ„ μ μλ” κ¶ν•μ„ λ¶€μ—¬ν•©λ‹λ‹¤.

CloudFormation ν…ν”λ¦Ώμ„ μ‚¬μ©ν•μ—¬ μ΄ μ—­ν• μ„ μ†μ‰½κ² μƒμ„±ν•  μ μμµλ‹λ‹¤.

### 2. μ‹¤ν–‰ μ—­ν• (Execution Role) μƒμ„±

μ΄ μ—­ν• μ€ StackSetsκ°€ λ€μƒ κ³„μ •μ—μ„ μ‹¤μ  λ¦¬μ†μ¤λ¥Ό μƒμ„±, μ—…λ°μ΄νΈ, μ‚­μ ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤.

- **μ—­ν•  μ΄λ¦„**: `AWSCloudFormationStackSetExecutionRole`
    
- **μ‹ λΆ° μ •μ±…**: κ΄€λ¦¬μ κ³„μ •μ IDλ¥Ό μ‹ λΆ° κ΄€κ³„μ— μ¶”κ°€ν•μ—¬ κ΄€λ¦¬μ μ—­ν• μ΄ μ΄ μ—­ν• μ„ λ§΅μ„ μ μλ„λ΅ ν—μ©ν•©λ‹λ‹¤.
    
- **κ¶ν• μ •μ±…**: λ¦¬μ†μ¤ λ°°ν¬μ— ν•„μ”ν• κ¶ν•(μ: AWS Config ν™μ„±ν™”μ— ν•„μ”ν• κ¶ν•)μ„ λ¶€μ—¬ν•©λ‹λ‹¤.

μ΄ μ—­ν• λ„ CloudFormation ν…ν”λ¦ΏμΌλ΅ μƒμ„±ν•λ©°, ν…ν”λ¦Ώ μ‹¤ν–‰ μ‹ **κ΄€λ¦¬μ κ³„μ • ID**λ¥Ό νλΌλ―Έν„°λ΅ μ…λ ¥ν•΄μ•Ό ν•©λ‹λ‹¤.

λ‘ μ—­ν• μ΄ μ„±κ³µμ μΌλ΅ μƒμ„±λλ©΄, AWS StackSets μ½μ†”μ—μ„ StackSets λ°°ν¬λ¥Ό μ‹μ‘ν•  μ¤€λΉ„κ°€ λ κ²ƒμ…λ‹λ‹¤.

---

## β™οΈ StackSets λ°°ν¬: AWS Config ν…ν”λ¦Ώ ν™μ©ν•κΈ°

StackSetsλ¥Ό λ°°ν¬ν•λ ¤λ©΄ AWS Configλ¥Ό ν™μ„±ν™”ν•λ” CloudFormation ν…ν”λ¦Ώμ΄ ν•„μ”ν•©λ‹λ‹¤. μ΄ ν…ν”λ¦Ώμ€ λ‹¤μκ³Ό κ°™μ€ νΉμ§•μ„ κ°€μ§ μ μμµλ‹λ‹¤.

- **λ‹¤μ–‘ν• νλΌλ―Έν„°**: `AWSConfig` ν™μ„±ν™” μ‹ ν¬ν•¨ν•  λ¦¬μ†μ¤ μ ν•, μ „μ—­ λ¦¬μ†μ¤ ν¬ν•¨ μ—¬λ¶€, μ•λ¦Ό μ±„λ„ λ“± λ‹¤μ–‘ν• μµμ…μ„ νλΌλ―Έν„°λ΅ μ„¤μ •ν•μ—¬ μ μ—°ν•κ² κµ¬μ„±ν•  μ μμµλ‹λ‹¤.
    
- **κ³ κΈ‰ CloudFormation κΈ°λ¥**:
    
    - **`Conditions`**: νΉμ • μ΅°κ±΄μ— λ”°λΌ λ¦¬μ†μ¤ μƒμ„±μ„ μ μ–΄ν•©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, μ•λ¦Όμ© SNS Topic μƒμ„± μ—¬λ¶€λ¥Ό νλΌλ―Έν„°μ— λ”°λΌ κ²°μ •ν•  μ μμµλ‹λ‹¤.
        
    - **`Mappings`**: νλΌλ―Έν„°μ μ‚¬μ©μ μΉν™”μ μΈ κ°’μ„ μ‹¤μ  CloudFormationμ΄ μ‚¬μ©ν•λ” κ°’μΌλ΅ λ§¤ν•‘ν•©λ‹λ‹¤.
        
    - **`DependsOn`**: λ¦¬μ†μ¤ κ°„μ λ…μ‹μ μΈ μƒμ„± μμ„λ¥Ό μ •μν•©λ‹λ‹¤.
        
    - **`Fn::If`**: λ¦¬μ†μ¤ μ†μ„±μ— μ΅°κ±΄λ¶€ λ΅μ§μ„ μ μ©ν•μ—¬ `AWS::NoValue`μ™€ κ°™μ€ μμ‚¬ λ³€μ(Pseudo-Variables)λ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

### StackSets λ°°ν¬ λ‹¨κ³„

1. **StackSets μƒμ„±**: CloudFormation μ½μ†”μ—μ„ "StackSets" λ©”λ‰΄λ΅ μ΄λ™ν•μ—¬ μƒ StackSetμ„ μƒμ„±ν•©λ‹λ‹¤.
    
2. **ν…ν”λ¦Ώ μ—…λ΅λ“**: AWS Config ν…ν”λ¦Ώ νμΌμ„ μ—…λ΅λ“ν•©λ‹λ‹¤.
    
3. **νλΌλ―Έν„° μ„¤μ •**: ν…ν”λ¦Ώμ νλΌλ―Έν„° κ°’μ„ μ„¤μ •ν•©λ‹λ‹¤. μ΄ μ‹¤μµμ—μ„λ” κΈ°λ³Έκ°’μΌλ΅ μ„¤μ •ν•κ³  μ§„ν–‰ν•©λ‹λ‹¤.
    
4. **κ¶ν• μ„¤μ •**: λ―Έλ¦¬ μƒμ„±ν•΄λ‘” **κ΄€λ¦¬μ μ—­ν•  ARN**κ³Ό **μ‹¤ν–‰ μ—­ν•  μ΄λ¦„**μ„ μ§€μ •ν•©λ‹λ‹¤.
    
5. **λ°°ν¬ λ€μƒ μ§€μ •**:
    
    - **κ³„μ • λ²νΈ**: μ¤νƒμ„ λ°°ν¬ν•  κ³„μ • IDλ¥Ό μ…λ ¥ν•©λ‹λ‹¤.
        
    - **λ¦¬μ „**: μ¤νƒμ„ λ°°ν¬ν•  λ¦¬μ „μ„ μ„ νƒν•©λ‹λ‹¤. μ΄ μ‹¤μµμ—μ„λ” μ λ½(EU)μ λ‘ λ¦¬μ „(ν”„λ‘ν¬ν‘Έλ¥΄νΈ, μ•„μΌλλ“)μ„ μ„ νƒν•©λ‹λ‹¤.

6. **λ°°ν¬ μµμ…**:
    
    - **λ™μ‹ λ°°ν¬ κ³„μ • μ**: ν• λ²μ— λ‡ κ°μ κ³„μ •μ— λ°°ν¬ν• μ§€ μ§€μ •ν•©λ‹λ‹¤.
        
    - **μ‹¤ν¨ ν—μ©μΉ**: μ „μ²΄ λ°°ν¬κ°€ μ‹¤ν¨ν•κΈ° μ „μ— ν—μ©ν•  μ¤νƒ μΈμ¤ν„΄μ¤μ μ‹¤ν¨ νμλ¥Ό μ§€μ •ν•©λ‹λ‹¤.
        
    - **λ¦¬μ „ λ™μ‹ λ°°ν¬**: λ¦¬μ „λ³„λ΅ μμ°¨μ μΌλ΅ λ°°ν¬ν• μ§€, λ³‘λ ¬λ΅ λ°°ν¬ν• μ§€ μ„ νƒν•©λ‹λ‹¤. λ³‘λ ¬ λ°°ν¬λ¥Ό μ„ νƒν•μ—¬ μ‹κ°„μ„ λ‹¨μ¶•ν•©λ‹λ‹¤.

7. **λ°°ν¬ μ‹μ‘**: λ¨λ“  μ„¤μ •μ„ ν™•μΈν• ν›„ λ°°ν¬λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.

λ°°ν¬κ°€ μ‹μ‘λλ©΄ StackSets μ½μ†”μ—μ„ κ° λ¦¬μ „μ μ¤νƒ μΈμ¤ν„΄μ¤ μƒμ„± μƒνƒλ¥Ό λ¨λ‹ν„°λ§ν•  μ μμµλ‹λ‹¤. μ μ‹ ν›„, μ„ νƒν• λ‘ λ¦¬μ „μ— AWS Config μ¤νƒμ΄ μ„±κ³µμ μΌλ΅ λ°°ν¬λλ” κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

---

## β… κ²°κ³Ό ν™•μΈ λ° μ •λ¦¬

- **μ¤νƒ μΈμ¤ν„΄μ¤ ν™•μΈ**: μ„ νƒν• λ¦¬μ „μ—μ„ AWS Config μ¤νƒμ΄ μ„±κ³µμ μΌλ΅ μƒμ„±λμ—λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
    
- **μ¤νƒ μ‚­μ **: μ‹¤μµ ν›„ λ¶ν•„μ”ν• λΉ„μ©μ΄ λ°μƒν•μ§€ μ•λ„λ΅ StackSetsλ¥Ό μ‚­μ ν•μ—¬ λ°°ν¬λ μ¤νƒ μΈμ¤ν„΄μ¤λ¥Ό μΌκ΄„μ μΌλ΅ μ‚­μ ν•©λ‹λ‹¤.
    

μ΄ μ‹¤μµμ€ StackSetsμ κ°•λ ¥ν• κΈ°λ¥μ„ ν†µν•΄ λ€κ·λ¨ ν™κ²½μ—μ„ λ°λ³µμ μ΄κ³  λ³µμ΅ν• λ°°ν¬ μ‘μ—…μ„ μ–Όλ§λ‚ ν¨μ¨μ μΌλ΅ μλ™ν™”ν•  μ μλ”μ§€ λ³΄μ—¬μ¤λ‹λ‹¤. μ΄λ” κ±°λ²„λ„μ¤, μ»΄ν”λΌμ΄μ–Έμ¤, κ·Έλ¦¬κ³  μ΄μ ν¨μ¨μ„± μΈ΅λ©΄μ—μ„ λ§¤μ° μ¤‘μ”ν• κΈ°μ μ…λ‹λ‹¤.