
## 🚀 CloudFormation StackSets란?

**CloudFormation StackSets**는 단일 작업으로 여러 AWS 계정과 리전에 걸쳐 CloudFormation 스택을 배포, 업데이트 및 삭제할 수 있게 해주는 기능입니다. 이는 대규모 인프라 배포를 중앙에서 관리하는 데 매우 유용합니다.

StackSets는 다음과 같은 두 가지 유형의 계정으로 구성됩니다.

![[Pasted image 20250928160536.png]]

1. **관리자 계정 (Administrator Account)**: StackSets를 생성, 관리, 업데이트하는 중앙 계정입니다.
    
2. **대상 계정 (Target Account)**: StackSets에 의해 스택 인스턴스(Stack Instance)가 배포되는 계정입니다.
    

관리자 계정에서 StackSets를 업데이트하면 모든 대상 계정의 지정된 리전에 해당 업데이트가 자동으로 적용됩니다.

---

## 🛡️ StackSets 권한 모델

![[Pasted image 20250928160546.png]]

StackSets를 사용하려면 관리자 계정과 대상 계정 간에 **IAM 역할(IAM Role)**을 통한 권한 설정이 필요합니다. 권한 모델은 크게 두 가지로 나뉩니다.

### 1. 셀프 관리형 권한 (Self-Managed Permissions)

AWS Organizations를 사용하지 않는 경우, 각 계정에 필요한 IAM 역할을 수동으로 생성해야 합니다.

- **관리자 계정**: `AWSCloudFormationStackSetAdministrationRole` 역할을 생성하고, 이 역할에 대상 계정의 `AWSCloudFormationStackSetExecutionRole`을 신뢰하도록 설정합니다.
    
- **대상 계정**: `AWSCloudFormationStackSetExecutionRole` 역할을 생성하고, 관리자 계정의 `AWSCloudFormationStackSetAdministrationRole`을 신뢰하도록 설정합니다.
    

이 방법은 초기 설정에 수동 작업이 필요하지만, AWS Organizations가 없는 환경에서 유연하게 사용할 수 있습니다.

### 2. 서비스 관리형 권한 (Service-Managed Permissions)

AWS Organizations를 사용하는 경우, CloudFormation과 Organizations 간의 **신뢰할 수 있는 액세스(Trusted Access)**를 활성화하면 IAM 역할을 자동으로 생성하고 관리할 수 있습니다.

- **설정 방법**:
    
    1. AWS Organizations에서 모든 기능(All Features)을 활성화합니다.
        
    2. CloudFormation 콘솔에서 신뢰할 수 있는 액세스를 활성화합니다.
        
- **장점**:
    
    - **IAM 역할 자동 관리**: 별도의 IAM 역할 생성 없이 StackSets를 배포할 수 있습니다.
        
    - **새 계정 자동 배포**: Organizations에 새로 추가되는 계정에 StackSets를 자동으로 배포하도록 설정할 수 있습니다.
        
    - **관리 권한 위임**: 특정 멤버 계정을 StackSets 관리자로 지정하여 중앙 관리 계정의 부담을 줄일 수 있습니다.
        

서비스 관리형 권한은 대규모 조직 환경에서 효율성과 보안을 동시에 확보할 수 있는 모범 사례입니다.

---

## 📊 StackSets와 AWS Organizations 활용 예시

![[Pasted image 20250928160608.png]]

AWS Organizations와 StackSets를 함께 사용하면 조직의 여러 부서(OU: Organizational Unit)에 걸쳐 인프라를 일관성 있게 배포할 수 있습니다.

|                                                                                                    |                                                  |
| -------------------------------------------------------------------------------------------------- | ------------------------------------------------ |
| **관리 계정 (Management Account)** 또는 **위임된 관리자 계정 (Delegated Administrator)**이 StackSets를 생성 및 관리합니다. | `Prod OU` 또는 `Dev OU`와 같은 대상 계정에 스택 인스턴스를 배포합니다. |
| **자동 배포 기능 활성화**: 만약 `Dev OU`에 새로운 개발 계정이 추가되면, StackSets가 해당 계정에 자동으로 배포되도록 설정할 수 있습니다.           |                                                  |
| **보안 강화**: 각 OU의 필요에 따라 특정 StackSets만 배포되도록 정책을 적용할 수 있습니다.                                        |                                                  |

이러한 중앙 집중식 관리는 거버넌스, 컴플라이언스 및 보안 요구 사항을 충족하는 데 큰 도움이 됩니다. StackSets는 복잡한 분산 환경에서 인프라를 배포하고 관리하는 데 있어 필수적인 도구입니다.