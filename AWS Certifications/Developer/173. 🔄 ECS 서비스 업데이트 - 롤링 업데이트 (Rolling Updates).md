
Amazon ECS 서비스에서 애플리케이션을 새로운 버전으로 업데이트할 때, **롤링 업데이트(Rolling Updates)**는 가동 중단 시간(downtime) 없이 태스크를 점진적으로 교체하는 전략입니다. 이 과정은 **최소 정상 백분율(Minimum Healthy Percent)**과 **최대 백분율(Maximum Percent)**이라는 두 가지 설정으로 제어됩니다.

---

### 1. 롤링 업데이트의 핵심 설정 ⚙️

![[Pasted image 20250810193719.png]]

롤링 업데이트는 기존 태스크(v1)를 새로운 태스크(v2)로 교체하는 과정을 제어하는 두 가지 파라미터를 사용합니다.

- **최소 정상 백분율 (Minimum Healthy Percent):**
    
    - 배포 과정에서 **`RUNNING` 상태를 유지해야 하는 태스크의 최소 수**를 백분율로 정의합니다.
    - 기본값은 `50%`입니다.
    - 이 값을 `100%`로 설정하면, 기존 태스크를 종료하기 전에 반드시 새로운 태스크가 정상적으로 시작되어야 합니다. 이는 가동 중단 시간을 최소화하는 데 효과적입니다.
    
- **최대 백분율 (Maximum Percent):**
    
    - 배포 과정에서 **`RUNNING` 또는 `PENDING` 상태일 수 있는 태스크의 최대 수**를 백분율로 정의합니다.
    - 기본값은 `200%`입니다.
    - 이 값을 통해 한 번에 얼마나 많은 새로운 태스크를 시작할 수 있는지 제어합니다.


---

### 2. 롤링 업데이트 시나리오 분석 📝

두 가지 설정 조합에 따라 업데이트 방식이 달라집니다.

#### 시나리오 1: Min 50%, Max 100% (리소스 절약형)

![[Pasted image 20250810193745.png]]

- **시작:** 4개의 태스크(100% 용량)가 실행 중입니다.
- **과정:**
    1. `최소 정상 백분율(50%)`을 만족하기 위해 2개의 기존 태스크를 먼저 종료합니다. (현재 50% 용량)
    2. `최대 백분율(100%)`을 넘지 않는 선에서 2개의 새로운 태스크를 시작합니다. (다시 100% 용량)
    3. 남은 2개의 기존 태스크를 종료합니다. (현재 50% 용량)
    4. 2개의 새로운 태스크를 시작하여 업데이트를 완료합니다. (다시 100% 용량)

- **특징:** 추가적인 컴퓨팅 리소스가 필요하지 않습니다. 기존 태스크를 먼저 종료하고 그 공간에 새로운 태스크를 시작하는 방식입니다.
    

#### 시나리오 2: Min 100%, Max 150% (가동 중단 시간 최소화)

![[Pasted image 20250810193809.png]]

- **시작:** 4개의 태스크(100% 용량)가 실행 중입니다.
- **과정:**
    
    1. `최소 정상 백분율(100%)`을 유지해야 하므로 기존 태스크를 종료할 수 없습니다.
    2. `최대 백분율(150%)`을 만족하기 위해 2개의 새로운 태스크를 시작합니다. (총 6개의 태스크, 150% 용량)
    3. `최소 정상 백분율(100%)`을 이미 만족하고 있으므로 2개의 기존 태스크를 종료합니다. (총 4개의 태스크, 100% 용량)
    4. 남은 2개의 새로운 태스크를 시작합니다. (총 6개의 태스크, 150% 용량)
    5. 남은 2개의 기존 태스크를 종료하여 업데이트를 완료합니다. (총 4개의 태스크, 100% 용량)

- **특징:** 새로운 태스크를 먼저 시작하고 그 후에 기존 태스크를 종료하여 가동 중단 시간을 최소화합니다. 이 방식을 사용하려면 추가적인 컴퓨팅 리소스가 필요합니다.