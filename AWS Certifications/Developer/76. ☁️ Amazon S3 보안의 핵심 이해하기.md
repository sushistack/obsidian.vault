
Amazon S3(Simple Storage Service)는 클라우드 스토리지 서비스로, 방대한 양의 데이터를 저장하고 관리할 수 있습니다. S3를 안전하게 사용하기 위해서는 다양한 보안 메커니즘을 이해하고 적절히 적용하는 것이 매우 중요합니다. 이번 아티클에서는 S3 보안의 주요 구성 요소들을 사용자(User-Based) 및 리소스(Resource-Based) 관점에서 자세히 살펴보겠습니다.

---

### 🔑 사용자 기반 보안 (User-Based Security)

사용자 기반 보안은 AWS **IAM(Identity and Access Management)**을 활용하여 특정 IAM 사용자 또는 역할(Role)에게 S3 버킷에 대한 접근 권한을 부여하는 방식입니다.

#### IAM 정책 (IAM Policies)

**IAM 정책**은 특정 사용자, 그룹 또는 역할이 어떤 AWS API 호출을 수행할 수 있는지 허용(Allow)하거나 거부(Deny)하는 규칙입니다. S3 버킷에 접근하려는 IAM 사용자에게 이 정책을 연결하면, 사용자가 수행할 수 있는 작업(예: `GetObject`, `PutObject`, `ListBucket`)을 제어할 수 있습니다.

- **예시:** 특정 IAM 사용자가 `my-example-bucket`의 객체를 읽을 수 있도록 허용하는 IAM 정책

```JSON
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::my-example-bucket/*"
        }
    ]
}
```

---

### 🛡️ 리소스 기반 보안 (Resource-Based Security)

리소스 기반 보안은 S3 버킷 자체에 보안 정책을 직접 설정하여, 어떤 사용자가 어떤 방식으로 버킷에 접근할 수 있는지 제어하는 방식입니다. 이는 주로 **S3 버킷 정책(Bucket Policies)**을 통해 이루어집니다.


#### S3 버킷 정책 (S3 Bucket Policies)

**S3 버킷 정책**은 S3 버킷에 직접 연결되는 JSON 기반의 규칙입니다. 버킷 전체에 적용되는 광범위한 보안 규칙을 정의하며, 다음과 같은 용도로 사용될 수 있습니다.

- **공개 접근 설정:** 버킷을 공개(public)로 만들어 전 세계 누구나 접근할 수 있게 합니다.
- **교차 계정 접근 (Cross-Account Access):** 다른 AWS 계정의 IAM 사용자에게 내 S3 버킷에 대한 접근을 허용합니다.
- **객체 암호화 강제:** 모든 업로드 객체가 특정 암호화 방식을 사용하도록 강제합니다.
- 예시: 버킷 공개 접근 설정
    아래 정책은 my-example-bucket 내의 모든 객체(*)에 대해 누구나(*) 읽기(s3:GetObject)를 허용하는 정책입니다. 이 정책을 버킷에 적용하면 해당 버킷이 공개적으로 접근 가능해집니다.



```JSON
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::my-example-bucket/*"
        }
    ]
}
```

---

### 🤝 사용자 기반 vs. 리소스 기반: 액세스 결정 로직

S3 객체에 대한 접근은 **사용자 기반 권한**과 **리소스 기반 권한**을 모두 고려하여 결정됩니다.

**액세스 허용 조건:**

1. IAM 정책이 접근을 **허용**하거나,
2. S3 버킷 정책이 접근을 **허용**하는 경우

위 두 가지 조건 중 하나라도 충족되면 액세스가 허용됩니다. 단, 두 정책 중 어느 한쪽에라도 **명시적 거부(Explicit Deny)** 규칙이 있다면, 접근은 무조건 거부됩니다.

|구분|IAM 정책|S3 버킷 정책|결과|
|---|---|---|---|
|**Case 1**|허용(Allow)|없음|**허용 (Allow)**|
|**Case 2**|허용(Allow)|허용(Allow)|**허용 (Allow)**|
|**Case 3**|허용(Allow)|거부(Deny)|**거부 (Deny)**|
|**Case 4**|거부(Deny)|허용(Allow)|**거부 (Deny)**|
|**Case 5**|없음|허용(Allow)|**허용 (Allow)**|

---

### ⚙️ 추가적인 S3 보안 설정

#### 1. 객체 ACL (Access Control Lists) 및 버킷 ACL

ACL은 더 세밀한 권한 제어를 위해 사용되는 보안 방식이었으나, 현재는 **버킷 정책**을 사용하는 것이 더 일반적이고 권장됩니다. ACL은 버킷 및 객체 수준에서 개별적으로 접근 권한을 설정할 수 있지만, 복잡성을 증가시키므로 특별한 이유가 없다면 비활성화하는 것이 좋습니다.

#### 2. S3 버킷 퍼블릭 액세스 차단 (Block Public Access) 🔒

![[Pasted image 20250802215839.png]]

AWS는 데이터 유출을 방지하기 위해 **S3 버킷 퍼블릭 액세스 차단** 기능을 제공합니다. 이 설정은 버킷 생성 시 기본적으로 활성화되어 있으며, **가장 강력한 보안 계층**입니다.

- 이 설정이 활성화되어 있으면, **버킷 정책으로 퍼블릭 접근을 허용하더라도 접근이 차단**됩니다.
- 만약 버킷을 절대 공개해서는 안 된다면, 이 설정을 항상 **활성화** 상태로 유지하는 것이 중요합니다.
- 이 설정은 계정 전체 또는 개별 버킷 단위로 적용할 수 있습니다.

#### 3. 객체 암호화 (Object Encryption) 🔐

S3는 객체 업로드 시 데이터를 암호화하여 저장하는 기능을 제공합니다. 이를 통해 민감한 데이터를 안전하게 보호할 수 있습니다.

- **S3 관리 키(SSE-S3):** AWS가 관리하는 암호화 키를 사용합니다.
- **KMS 관리 키(SSE-KMS):** AWS KMS(Key Management Service)를 사용하여 키를 관리하고 더 세분화된 권한 제어가 가능합니다.
- **고객 관리 키(SSE-C):** 사용자가 직접 암호화 키를 제공하고 관리합니다.

---

### 📋 S3 보안 설정 요약

|보안 방식|적용 대상|주요 사용 사례|특징|
|---|---|---|---|
|**IAM 정책**|IAM 사용자/역할|특정 사용자 권한 제어|사용자 기반 권한 제어|
|**S3 버킷 정책**|S3 버킷|공개 접근, 교차 계정 접근, 암호화 강제|리소스 기반 권한 제어, 가장 일반적|
|**퍼블릭 액세스 차단**|S3 버킷 (또는 계정)|데이터 유출 방지|**가장 높은 우선순위**, 퍼블릭 접근을 무조건 차단|
|**객체 암호화**|S3 객체|민감 데이터 보호|저장된 데이터 보호|

이러한 다양한 S3 보안 기능을 적절히 조합하여 사용하면, 데이터의 기밀성과 무결성을 효과적으로 보호할 수 있습니다. 어떤 상황에 어떤 보안 기능을 사용해야 할지 명확히 이해하고 적용하는 것이 중요합니다. 