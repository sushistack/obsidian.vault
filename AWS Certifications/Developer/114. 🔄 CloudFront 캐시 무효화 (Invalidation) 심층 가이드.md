

CloudFront 캐시 무효화는 원본 콘텐츠가 업데이트되었을 때, 엣지 로케이션에 캐시된 콘텐츠를 강제로 갱신하는 기능입니다. 이 과정은 캐시 객체의 **TTL(Time To Live)** 만료를 기다리지 않고 즉시 최신 콘텐츠를 사용자에게 제공할 수 있도록 해줍니다.

---

### 1. 캐시 무효화의 필요성 ⏰

CloudFront는 한 번 캐시된 객체를 지정된 TTL 기간 동안 유지합니다. 이 기간이 만료되어야만 엣지 로케이션이 원본 서버로 새로운 요청을 보내 최신 콘텐츠를 가져옵니다. 그러나 다음과 같은 경우에는 TTL 만료를 기다릴 수 없습니다.

- **긴급한 콘텐츠 업데이트:** 웹사이트의 중요한 오류를 수정하거나, 긴급 공지를 게시해야 할 때.
- **파일 수정:** 원본 S3 버킷의 이미지 파일을 새로운 버전으로 덮어썼을 때.
- **빠른 배포:** 업데이트된 콘텐츠를 전 세계 사용자에게 즉시 배포해야 할 때.

이러한 상황에서는 **캐시 무효화** 기능을 사용하여 캐시를 강제로 제거해야 합니다.

---

### 2. 캐시 무효화 작동 방식 🗑️

![[Pasted image 20250809233247.png]]

캐시 무효화는 CloudFront 배포에 대해 특정 파일 경로를 지정하여 실행됩니다.

1. **원본 콘텐츠 업데이트:** S3 버킷과 같은 원본 서버의 파일을 수정하거나 새 파일을 업로드합니다.
2. **무효화 요청:** CloudFront 콘솔, CLI, 또는 SDK를 사용하여 무효화 요청을 보냅니다.
3. **경로 지정:** 무효화할 캐시 객체의 경로를 지정합니다.
    - **특정 파일:** `/index.html`
    - **와일드카드:** `/images/*` (images 폴더 내 모든 파일 무효화) 또는 `/*` (배포의 모든 캐시 객체 무효화)
4. **캐시 제거:** CloudFront는 지정된 경로에 해당하는 모든 엣지 로케이션의 캐시 객체를 즉시 무효화 상태로 만듭니다.
5. **최신 콘텐츠 제공:** 이후 사용자가 무효화된 객체를 요청하면, 엣지 로케이션은 캐시에 유효한 객체가 없음을 인지하고 원본 서버로 새로운 요청을 보냅니다. 원본에서 가져온 최신 콘텐츠가 사용자에게 전달되며, 동시에 새로운 TTL로 다시 캐싱됩니다.

### 3. TTL과 캐시 무효화의 관계 ⚖️

- **TTL (Time To Live):** 콘텐츠가 정기적으로 업데이트되는 경우(예: 블로그 게시물, 뉴스 기사)에 사용하며, 비용 효율적인 캐시 관리 방법입니다.

- **캐시 무효화 (Invalidation):** 콘텐츠를 즉시 갱신해야 하는 경우에 사용하며, 유료 서비스이므로 꼭 필요한 경우에만 신중하게 사용해야 합니다. 과도한 사용은 비용 증가로 이어질 수 있습니다.


따라서 캐시 정책을 설정할 때는 적절한 TTL을 지정하고, 긴급한 상황에만 무효화 기능을 활용하는 것이 모범 사례입니다.