
이번 글에서는 AWS AppSync를 사용하여 GraphQL API를 직접 구축하고, DynamoDB를 데이터 소스로 연결하여 데이터를 관리하는 과정을 상세히 실습해 보겠습니다.

---

## 1. ⚙️ AppSync API 생성 및 스키마 정의

AppSync API는 GraphQL 스키마를 기반으로 생성됩니다.

1. AWS AppSync 콘솔로 이동하여 **'API 생성(Create API)'**을 클릭합니다.
    
2. **'GraphQL API'**를 선택하고, **'처음부터 구축(Design from scratch)'**을 선택합니다.
    
3. API 이름을 `MyAppSyncAPI`로 지정합니다.
    
4. **모델 생성**: GraphQL의 데이터 모델을 정의합니다. 여기서는 DynamoDB 테이블에 데이터를 저장하기 위해 `create a type backed by a DynamoDB table`을 선택합니다.
    - 모델 이름: `Student`
    - 필드 추가:
        - `id`: `ID` (필수)
        - `name`: `String` (필수)
        - `age`: `Int` (선택 사항)
        - `certified`: `Boolean` (선택 사항)

5. **테이블 설정**: `Student` 모델과 연결될 DynamoDB 테이블을 구성합니다.
    - 테이블 이름: `StudentTable`
    - 기본 키: `id`

이 과정을 마치면 AppSync가 자동으로 GraphQL 스키마와 연결된 DynamoDB 테이블을 생성합니다.

---

## 2. 🔌 DynamoDB 연동 및 데이터 관리

AppSync는 모델 정의를 기반으로 CRUD(Create, Read, Update, Delete) 작업을 위한 GraphQL 쿼리(Query)와 변이(Mutation)를 자동으로 생성합니다.

1. **쿼리 탐색기(Queries)**: AppSync 콘솔의 **'쿼리(Queries)'** 탭에서 생성된 쿼리와 변이(mutation)를 확인할 수 있습니다.
    
2. **데이터 생성(Mutation)**: `createStudent` 변이를 사용하여 학생 데이터를 생성합니다.
	- `createStudent` 변이 선택 후, 입력 필드에 아래와 같이 값을 입력하고 실행합니다.
    
```GraphQL
mutation MyMutation {
  createStudent(input: {name: "Mike", age: 25, certified: true}) {
	id
	name
	age
	certified
  }
}
```
    
3. **데이터 조회(Query)**: `listStudents` 쿼리를 실행하여 DynamoDB에 저장된 학생 목록을 조회합니다.

```GraphQL
query MyQuery {
  listStudents {
	items {
	  id
	  name
	  age
	  certified
	}
  }
}
```
    
이 쿼리를 실행하면, DynamoDB에 저장된 Mike와 Alice의 정보가 GraphQL 형식으로 반환됩니다. AWS DynamoDB 콘솔에서도 `StudentTable`에 데이터가 정상적으로 저장된 것을 확인할 수 있습니다.
    

---

## 3. 🔐 API 설정 및 인증

AppSync는 다양한 인증 모드를 지원하며, API 엔드포인트와 기타 설정을 관리할 수 있습니다.

- **설정(Settings)**: GraphQL API 엔드포인트와 실시간(Real-time) 엔드포인트를 확인할 수 있습니다.
    
- **권한 부여(Authorization)**: API 키, IAM, OpenID Connect, Cognito User Pools 등 다양한 인증 방식을 설정하여 API에 대한 접근을 제어할 수 있습니다. 여러 인증 모드를 동시에 사용하는 것도 가능합니다.
    
- **모니터링(Monitoring)**: CloudWatch를 통해 API 요청, 오류, 지연 시간 등 다양한 지표를 확인할 수 있습니다.
    
- **사용자 지정 도메인(Custom Domain)**: API를 커스텀 도메인으로 호스팅할 수 있습니다.
    

이 실습을 통해 AppSync가 DynamoDB와 같은 백엔드 데이터 소스 위에 GraphQL API를 구축하는 과정을 얼마나 단순화하는지 확인할 수 있습니다. GraphQL의 유연한 데이터 요청 방식과 AppSync의 완전 관리형 서비스는 웹 및 모바일 애플리케이션 개발을 크게 효율화합니다.