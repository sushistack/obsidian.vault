

AWS를 사용할 때는 서비스가 제공하는 **할당량(Quotas)** 또는 **제한(Limits)**을 이해하는 것이 중요합니다. 이는 서비스의 안정성을 보장하고 공정한 사용을 유지하기 위해 존재하며, 크게 두 가지 유형으로 나눌 수 있습니다.

---

### 1. API 요청 속도 제한 (API Rate Limits)

AWS API를 호출하는 속도에 대한 제한입니다.

- **개념:** 특정 API를 초당 몇 번 호출할 수 있는지에 대한 제한. 예를 들어, `EC2 DescribeInstances` API는 초당 100회로 제한될 수 있습니다.

- **오류:** 이 제한을 초과하면 **`ThrottlingException`** 같은 간헐적 오류(Intermittent Error)가 발생하며 요청이 조절(throttling)됩니다.
    
- **대처 방안:**
    
    - **간헐적 오류:** **지수 백오프(Exponential Backoff)** 전략을 사용하여 재시도합니다.
    - **지속적 초과:** 애플리케이션의 사용량이 많아 지속적으로 제한을 초과하는 경우, **AWS Support**에 문의하여 API 요청 제한 증가를 요청할 수 있습니다.


### 2. 서비스 할당량 (Service Quotas)

AWS 계정에서 실행할 수 있는 리소스의 총량에 대한 제한입니다.

- **개념:** 예를 들어, EC2 온디맨드 인스턴스는 한 계정에서 최대 1152개의 vCPU를 사용할 수 있습니다.
- **대처 방안:** 이 할당량을 초과해야 할 경우, **Service Quotas 콘솔** 또는 API를 통해 할당량 증가를 요청해야 합니다. 요청 후 AWS 엔지니어링 팀의 검토를 거쳐 할당량이 조정됩니다.


### Exponential Backoff (지수 백오프) 전략 📈

`ThrottlingException` 같은 간헐적 서버 오류(Server Error)가 발생했을 때 재시도하는 효과적인 전략입니다.

- **작동 방식:**
    1. 첫 번째 요청이 실패하면 짧은 시간(예: 1초) 후에 재시도합니다.
    2. 두 번째 요청이 실패하면 대기 시간을 두 배로 늘려(예: 2초) 재시도합니다.
    3. 세 번째 요청이 실패하면 다시 대기 시간을 두 배로 늘려(예: 4초) 재시도합니다.
    4. 이런 식으로 **재시도 간의 대기 시간을 기하급수적으로 늘려** 서버에 대한 부하를 줄입니다.

- **주요 특징:**
    
    - **서버 부하 분산:** 여러 클라이언트가 동시에 요청 실패를 겪을 때, 재시도 요청이 한꺼번에 몰리는 것을 방지하여 서버의 과부하를 막습니다.
    - **AWS SDK:** 대부분의 AWS SDK에는 이 재시도 메커니즘이 **기본적으로 포함**되어 있습니다.
    - **커스텀 구현 시:** 직접 HTTP 호출을 구현하는 경우, 5xx(서버 오류) 에러 코드에 대해서만 지수 백오프를 적용해야 합니다. 4xx(클라이언트 오류)는 재시도해도 같은 오류가 발생하므로 재시도해서는 안 됩니다.

### 요약 테이블

|구분|API 요청 속도 제한 (API Rate Limits)|서비스 할당량 (Service Quotas)|
|---|---|---|
|**제한 대상**|API 호출 속도 (초당 요청 수)|계정 내 리소스 사용량 (예: vCPU 수)|
|**오류 유형**|`ThrottlingException`|리소스 생성 실패 등|
|**일시적 문제 해결**|**지수 백오프** 전략 사용|해당 없음|
|**영구적 한도 초과**|AWS Support에 제한 증가 요청|Service Quotas 콘솔/API로 할당량 증가 요청|
|**핵심 키워드**|Throttling, Exponential Backoff|Service Limits, Quota Increase|