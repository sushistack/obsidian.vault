
이번 아티클에서는 **AWS Lambda의 비동기식 호출(Asynchronous Invocation)**에 대해 자세히 살펴보겠습니다. 동기식 호출과 어떻게 다른지, 어떤 서비스에서 사용되는지, 그리고 재시도 및 오류 처리 방식에 대해 알아보겠습니다.

### 📜 비동기식 호출이란?

**비동기식 호출**은 호출자가 Lambda 함수가 완료될 때까지 기다리지 않고, 이벤트를 전송한 후 즉시 다른 작업을 계속하는 방식입니다. 이 방식은 백그라운드에서 실행되어야 하거나, 호출 결과를 즉시 받을 필요가 없는 작업에 적합합니다.

### 🔄 비동기식 호출 과정

비동기식 호출은 다음과 같은 단계로 이루어집니다.


![[Pasted image 20250826214405.png]]

1. **이벤트 전송**: S3, SNS, CloudWatch Events와 같은 AWS 서비스가 Lambda 함수를 비동기식으로 호출합니다.
    
2. **내부 이벤트 대기열**: Lambda 서비스는 수신된 이벤트를 **내부 이벤트 대기열(Internal Event Queue)**에 즉시 추가합니다. 호출자는 이벤트가 대기열에 들어가는 즉시 성공 응답을 받습니다.
    
3. **함수 실행**: Lambda 함수는 이 대기열에서 이벤트를 가져와 처리합니다.

### 🔁 재시도 메커니즘과 멱등성(Idempotency)

비동기식 호출에서 함수 실행이 실패하면 Lambda는 자동으로 **재시도**를 수행합니다.

- **재시도 횟수**: 총 **3회**의 재시도가 이루어집니다.
    
- **재시도 간격**:
    
    - 첫 번째 실패 후 **즉시** 재시도
        
    - 두 번째 실패 후 **1분 뒤** 재시도
        
    - 세 번째 실패 후 **2분 뒤** 재시도
        
- **주의사항**: 재시도로 인해 동일한 이벤트가 여러 번 처리될 수 있습니다. 따라서 Lambda 함수는 **멱등성(Idempotency)**을 갖도록 설계되어야 합니다. 멱등성이란, 동일한 입력으로 여러 번 호출되어도 항상 같은 결과를 보장하는 속성을 의미합니다. 예를 들어, 데이터베이스에 값을 추가하는 함수가 재시도될 경우 중복된 데이터가 생성될 수 있으므로, 중복 삽입을 방지하는 로직을 추가해야 합니다.
    

### ⚠️ 실패한 이벤트 처리: 데드 레터 큐(DLQ)

세 번의 재시도에도 불구하고 함수 실행이 계속 실패할 경우, Lambda는 해당 이벤트를 **데드 레터 큐(Dead-Letter Queue, DLQ)**로 보낼 수 있습니다. DLQ는 Lambda 함수 설정에서 SQS 또는 SNS로 지정할 수 있습니다.

|DLQ 설정|설명|
|---|---|
|**SQS(Simple Queue Service)**|실패한 이벤트를 SQS 큐에 메시지로 보냅니다. 추후 재처리를 위해 메시지를 모아두는 데 유용합니다.|
|**SNS(Simple Notification Service)**|실패한 이벤트를 SNS 토픽에 발행합니다. 여러 구독자에게 실패 알림을 보내는 데 유용합니다.|

DLQ를 사용하면 실패한 이벤트를 나중에 분석하거나 재처리할 수 있어 데이터 손실을 방지하고 오류 관리를 효율적으로 할 수 있습니다.

---

### 🚀 비동기식 호출의 장점

1. **높은 처리량**: 비동기식 호출은 대량의 이벤트를 동시에 처리할 수 있어 처리 속도를 크게 높입니다. 호출자는 결과를 기다리지 않으므로, 수천 개의 이벤트를 동시에 Lambda로 보낼 수 있습니다.
    
2. **느슨한 결합**: 호출자와 함수 간에 직접적인 연결이 없으므로 시스템 구성 요소 간의 의존성이 낮아집니다.
    

### 🔗 비동기식 호출을 사용하는 주요 AWS 서비스

이러한 비동기 호출 모델은 여러 AWS 서비스에서 사용됩니다. 자격증명 시험을 대비하여 특히 중요한 서비스는 다음과 같습니다.

|서비스|설명|
|---|---|
|**Amazon S3**|새로운 파일이 업로드되거나 삭제될 때 발생하는 S3 이벤트 알림을 통해 Lambda를 호출합니다.|
|**Amazon SNS**|SNS 토픽에 메시지가 발행되면 구독 중인 Lambda 함수를 호출합니다.|
|**Amazon CloudWatch Events / EventBridge**|AWS 인프라에서 발생하는 다양한 이벤트에 반응하여 Lambda 함수를 트리거합니다.|

이 외에도 AWS CodeCommit, CodePipeline, SES, IoT 등 다양한 서비스가 비동기식으로 Lambda를 호출합니다. 비동기식 호출은 특히 이벤트 기반 아키텍처에서 중요한 역할을 합니다.