## 핵심 차이점 및 활용 사례

AWS RDS는 관계형 데이터베이스의 성능, 가용성 및 재해 복구 기능을 향상시키기 위해 **읽기 전용 복제본 (Read Replicas)**과 **다중 AZ (Multi-AZ)**라는 두 가지 핵심 기능을 제공합니다. 이 두 가지는 종종 혼동되지만, 그 목적과 작동 방식은 명확히 다릅니다. 시험 대비를 위해 이들의 차이점을 정확히 이해하는 것이 매우 중요합니다.

---

### 1. RDS 읽기 전용 복제본 (Read Replicas)

**목적:** 읽기 성능 확장(Scale Reads)

#### 1.1. 개요

![[Pasted image 20250706135302.png]]

읽기 전용 복제본은 메인 RDS 데이터베이스 인스턴스(마스터 DB)의 복사본을 생성하여 읽기 트래픽을 분산시키는 데 사용됩니다.

- **최대 15개의 복제본:** 하나의 마스터 DB에서 최대 15개의 읽기 전용 복제본을 생성할 수 있습니다.
- **위치:**
    - **동일 가용 영역 (Same Availability Zone, AZ):** 마스터 DB와 동일한 AZ에 위치.
    - **교차 가용 영역 (Cross Availability Zone, Cross-AZ):** 마스터 DB와 다른 AZ에 위치.
    - **교차 리전 (Cross Region, Cross-Region):** 마스터 DB와 다른 AWS 리전(Region)에 위치.

#### 1.2. 복제 방식: 비동기 복제 (Asynchronous Replication)

- **작동 방식:** 마스터 DB에서 발생한 데이터 변경 사항이 읽기 전용 복제본으로 **비동기적으로** 복제됩니다.
- **결과적 일관성 (Eventually Consistent):** 비동기 복제이므로, 읽기 전용 복제본이 마스터 DB의 최신 변경 사항을 반영하는 데 약간의 지연(replication lag)이 있을 수 있습니다. 따라서 복제본에서 데이터를 읽을 때 간혹 최신이 아닌 데이터를 얻을 수 있습니다.

#### 1.3. 주요 특징

- **읽기 전용:** `SELECT` 문과 같은 읽기 작업만 수행할 수 있습니다. `INSERT`, `UPDATE`, `DELETE`와 같은 데이터 변경(쓰기) 작업은 허용되지 않습니다.
- **독립적인 DB로 승격 가능:** 읽기 전용 복제본은 필요에 따라 독립적인 RDS 데이터베이스 인스턴스로 **승격(Promote)**될 수 있습니다. 승격되면 더 이상 마스터 DB의 복제본이 아니며, 자체적인 읽기/쓰기 작업을 처리할 수 있게 됩니다.

#### 1.4. 활용 사례

![[Pasted image 20250706135415.png]]

- **읽기 트래픽 분산:** 웹 애플리케이션의 읽기 요청이 많아 마스터 DB에 부하가 집중될 때, 읽기 전용 복제본으로 읽기 트래픽을 분산하여 마스터 DB의 부담을 줄이고 성능을 향상시킵니다.

- **보고 및 분석 워크로드 분리:** 운영 데이터베이스에 직접적인 영향을 주지 않고, 보고서 생성이나 데이터 분석과 같은 무거운 읽기 중심의 작업을 읽기 전용 복제본에서 수행할 수 있습니다.

|시나리오|해결책|이점|
|---|---|---|
|**운영 DB에 과부하**  <br>(생산 애플리케이션 외  <br>보고/분석 앱 연결)|**읽기 전용 복제본 생성**  <br>및 보고/분석 앱 연결|생산 애플리케이션의 성능 저하 없이  <br>보고/분석 작업 수행 가능.|

#### 1.5. 네트워킹 비용

![[Pasted image 20250706135508.png]]

- **동일 리전 내 교차 AZ 복제:** 읽기 전용 복제본이 마스터 DB와 다른 AZ에 있지만 동일한 리전 내에 있다면, 복제 트래픽에 대한 **네트워크 비용은 발생하지 않습니다.** (RDS는 관리형 서비스이므로 AWS가 이 비용을 면제해 줍니다.)

- **교차 리전 복제:** 읽기 전용 복제본이 마스터 DB와 다른 리전에 있다면, 복제 트래픽에 대한 **네트워크 비용이 발생합니다.**

---

### 2. RDS 다중 AZ (Multi-AZ) 배포

**목적:** 재해 복구(Disaster Recovery) 및 고가용성(High Availability)

#### 2.1. 개요

다중 AZ 배포는 주(Primary) 데이터베이스 인스턴스와 별도의 가용 영역(AZ)에 대기(Standby) 인스턴스를 동기적으로 복제하여, 주 인스턴스에 문제가 발생할 경우 자동으로 대기 인스턴스로 **페일오버(Failover)**되도록 하는 기능입니다.

#### 2.2. 복제 방식: 동기 복제 (Synchronous Replication)

- **작동 방식:** 마스터 DB에 발생한 모든 데이터 변경 사항이 대기 인스턴스로 **동기적으로** 복제됩니다. 즉, 마스터 DB에서 쓰기 작업이 완료되려면 대기 인스턴스에도 해당 변경 사항이 성공적으로 복제되어야 합니다.
    
- **강력한 일관성 (Strong Consistency):** 데이터 손실 위험이 거의 없으며, 항상 최신 데이터를 보장합니다.

#### 2.3. 주요 특징

![[Pasted image 20250706135644.png]]

- **단일 DNS 이름:** 애플리케이션은 단일 DNS 엔드포인트(Endpoint)를 통해 데이터베이스에 연결됩니다. 페일오버가 발생해도 이 DNS 이름은 변경되지 않으므로, 애플리케이션의 수동 개입이 필요 없습니다.

- **자동 페일오버:** 주 인스턴스 또는 해당 AZ에 문제가 발생하면(인스턴스 장애, 스토리지 장애, 네트워크 장애 등), 자동으로 대기 인스턴스가 새로운 주 인스턴스로 승격됩니다.

- **고가용성:** 인프라 장애 시에도 서비스 중단 시간을 최소화하여 높은 가용성을 제공합니다.

- **읽기 확장용이 아님:** 대기 인스턴스는 오직 고가용성 목적으로만 존재하며, 읽기 또는 쓰기 트래픽을 직접 처리하지 않습니다. (숨겨진 인스턴스로 간주).

#### 2.4. 활용 사례

- **재해 복구:** 가용 영역 전체의 장애 발생 시에도 데이터 손실 없이 서비스 연속성을 보장합니다.
- **계획된 유지보수:** DB 인스턴스의 패치나 업그레이드 시에도 서비스 중단 없이 진행될 수 있습니다.

---

### 3. 읽기 전용 복제본과 다중 AZ의 비교

|특징|읽기 전용 복제본 (Read Replicas)|다중 AZ (Multi-AZ)|
|---|---|---|
|**주요 목적**|읽기 성능 확장|고가용성 및 재해 복구|
|**복제 방식**|비동기|동기|
|**데이터 일관성**|결과적 일관성|강력한 일관성|
|**쓰기 작업 허용 여부**|불가능 (읽기만 가능)|불가능 (주 인스턴스에서만 쓰기 가능)|
|**비용 (동일 리전 내 교차 AZ 복제 트래픽)**|무료|무료|
|**자동 페일오버**|없음|있음|
|**단일 DNS 이름**|각 복제본마다 별도의 엔드포인트|단일 엔드포인트 (페일오버 시에도 동일)|
|**데이터 손실 위험**|잠재적 가능성 있음 (최신 데이터 유실)|거의 없음|

---

### 4. 읽기 전용 복제본에 다중 AZ 설정 가능 여부

**예, 가능합니다.**

읽기 전용 복제본 자체도 Multi-AZ로 설정할 수 있습니다. 이는 읽기 전용 복제본에 대한 고가용성을 추가하여, 읽기 복제본 자체에 장애가 발생하더라도 자동으로 페일오버되어 읽기 서비스를 계속 제공할 수 있도록 합니다. 이는 시험에 자주 출제되는 부분입니다.

---

### 5. 단일 AZ에서 다중 AZ로 전환 (Zero Downtime Operation)

![[Pasted image 20250706135719.png]]

기존의 단일 AZ RDS 데이터베이스 인스턴스를 Multi-AZ로 변경하는 것은 **제로 다운타임(Zero Downtime)** 작업입니다.

- **작동 방식:**
    
    1. RDS 콘솔에서 해당 데이터베이스 인스턴스를 선택하고 **"Modify"**를 클릭합니다.
    2. "Multi-AZ deployment" 옵션을 **"Yes"**로 변경하고 저장을 클릭합니다.
    3. **내부적으로는 다음 과정이 수행됩니다:**
        - RDS가 주 데이터베이스의 스냅샷을 자동으로 생성합니다.
        - 이 스냅샷을 사용하여 다른 가용 영역에 새로운 대기(Standby) 데이터베이스를 복원합니다.
        - 주 데이터베이스와 새로 생성된 대기 데이터베이스 간에 동기 복제를 설정하고, 대기 데이터베이스가 주 데이터베이스와 동기화될 때까지 변경 사항을 따라잡습니다.
        - 이 모든 과정이 진행되는 동안 애플리케이션은 계속 주 데이터베이스에 접근할 수 있습니다.

이러한 유연한 전환 기능은 운영 중인 서비스의 가용성을 저해하지 않고 아키텍처의 견고성을 향상시키는 데 큰 도움이 됩니다.
