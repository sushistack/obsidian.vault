**AWS CloudTrail**은 AWS 계정의 모든 활동에 대한 기록을 제공하는 핵심 서비스입니다. 기본적으로 활성화되어 있으며, 콘솔, SDK, CLI를 통해 이루어지는 모든 API 호출을 기록합니다. 

CloudTrail은 계정의 보안 분석, 거버넌스 및 규정 준수 목표를 달성하는 데 필수적입니다.

![[Pasted image 20250824211716.png]]

## 📝 CloudTrail 이벤트 유형

CloudTrail은 크게 세 가지 유형의 이벤트를 기록합니다.
### 1. 관리 이벤트 (Management Events)

관리 이벤트는 AWS 계정의 리소스에 대한 **제어 영역(Control Plane)** 작업에 해당합니다. 리소스를 생성, 수정 또는 삭제하는 모든 API 호출이 여기에 속합니다.

- **기본 설정**: 모든 Trail은 기본적으로 관리 이벤트를 로깅합니다.

- **세분화**: `Read` 이벤트(예: `ListUsers`, `DescribeInstances`)와 `Write` 이벤트(예: `TerminateInstances`, `AttachRolePolicy`)로 구분할 수 있습니다. `Write` 이벤트는 인프라에 직접적인 변경을 가하므로 보안상 더 중요하게 다루어집니다.

### 2. 데이터 이벤트 (Data Events)

데이터 이벤트는 S3 객체 수준의 활동이나 Lambda 함수 실행과 같은 **데이터 영역(Data Plane)** 작업에 해당합니다. 이들은 매우 빈번하게 발생할 수 있으므로, **기본적으로 로깅되지 않습니다**. 사용자가 원하는 경우에만 활성화할 수 있습니다.

- **예시**:
    - **Amazon S3**: `GetObject`, `PutObject`, `DeleteObject`와 같은 객체 수준 API 호출
    - **AWS Lambda**: `Invoke` API를 통한 함수 실행 활동

### 3. CloudTrail Insights 이벤트 (Insights Events)

CloudTrail Insights는 관리 이벤트를 분석하여 계정에서 발생하는 **비정상적이거나 비정상적인 활동(unusual activity)**을 자동으로 탐지하는 기능입니다.

- **작동 방식**: CloudTrail Insights는 정상적인 관리 활동의 기준선(baseline)을 설정한 후, 이를 벗어나는 패턴을 감지합니다.
    
- **탐지 예시**:
    - 비정상적인 리소스 프로비저닝 증가
    - 특정 API 호출의 비정상적인 버스트(burst)

- **활성화**: 이 기능은 유료이며, 사용자가 직접 활성화해야 합니다. Insights 이벤트가 발생하면 CloudTrail 콘솔에 나타나고, Amazon S3로 전송되며, **EventBridge(CloudWatch Events)** 이벤트로도 생성되어 자동화된 알림(예: 이메일 전송)을 구성할 수 있습니다.

## ⏳ CloudTrail 이벤트 보존 기간

CloudTrail에 기록된 이벤트는 기본적으로 **90일** 동안 보존됩니다. 90일이 지나면 이벤트는 자동으로 삭제됩니다.

- **장기 보존**: 90일 이상 이벤트를 보관하고 싶다면, Trail을 구성하여 이벤트를 **Amazon S3 버킷**에 저장해야 합니다. S3는 무제한의 저렴한 스토리지 공간을 제공하므로 장기 감사 및 분석에 적합합니다.

- **데이터 분석**: S3에 저장된 CloudTrail 로그는 **Amazon Athena**를 사용하여 쉽게 쿼리하고 분석할 수 있습니다. Athena는 서버리스 서비스로, 표준 SQL을 사용하여 S3의 데이터를 직접 분석할 수 있어 매우 편리합니다.

|이벤트 유형|기본 로깅 여부|특징|
|---|---|---|
|**관리 이벤트**|✅ (예)|AWS 리소스 구성 및 관리에 대한 모든 API 호출.|
|**데이터 이벤트**|❌ (아니요)|대량으로 발생하는 S3, Lambda 등의 데이터 활동.|
|**Insights 이벤트**|❌ (아니요)|관리 이벤트에서 감지된 비정상적인 활동에 대한 이벤트.|