
**람다 레이어(Lambda Layers)**는 람다 함수에 재사용 가능한 코드와 종속성을 패키징하여 관리하는 기능입니다. 이 기능은 함수의 코드와 외부 라이브러리/종속성을 분리하여 배포 프로세스를 간소화하고, 여러 함수 간에 코드를 쉽게 공유할 수 있도록 돕습니다.

---

## 1. 람다 레이어를 사용하는 이유

![[Pasted image 20250831213207.png]]

- **코드 재사용성 향상:** 여러 람다 함수가 공통으로 사용하는 라이브러리(예: AWS SDK, Pandas)를 레이어에 포함시켜, 각 함수에 중복해서 패키징할 필요가 없습니다.
    
- **배포 패키지 크기 감소:** 레이어를 사용하면 람다 함수의 배포 패키지 크기가 크게 줄어듭니다. 이는 업로드 시간을 단축하고, 함수 업데이트를 더 빠르게 만듭니다.
    
- **커스텀 런타임 지원:** 람다에서 기본적으로 지원하지 않는 언어(예: C++, Rust)의 커스텀 런타임을 레이어를 통해 제공할 수 있습니다.
    

기존 방식의 문제점:

기존에는 외부 라이브러리가 포함된 큰 압축 파일(30MB 이상)을 매번 함수 코드와 함께 업로드해야 했습니다. 이는 함수 코드가 단 몇 KB만 변경되어도 전체 패키지를 다시 업로드해야 하는 비효율적인 방식이었습니다.

**람다 레이어의 해결책:**

- **함수 코드:** 자주 변경되는 코드만 포함하므로 패키지 크기가 작고(20KB 등), 배포가 빠릅니다.
    
- **레이어:** 잘 변하지 않는 무거운 종속성(예: 라이브러리)을 별도의 레이어로 분리하고, 여러 함수가 이 레이어를 참조합니다.
    

---

## 2. 람다 레이어 실습: Pandas 라이브러리 사용하기

이번 실습에서는 Pandas 라이브러리를 람다 레이어로 추가하여 함수에서 사용하는 방법을 살펴보겠습니다. Pandas는 데이터 조작 및 분석에 사용되는 무거운 라이브러리로, 레이어 사용의 이점을 잘 보여줍니다.

### 1단계: 람다 함수 생성 및 코드 작성

먼저 `lambda-layer-demo`라는 람다 함수를 생성하고, Pandas 라이브러리를 사용하는 코드를 작성합니다.


```Python
import pandas as pd

def lambda_handler(event, context):
    sample_data = {
        'age': [25, 31, 35, 42, 55],
        'name': ['Alice', 'Bob', 'Charlie', 'David', 'Eve']
    }
    df = pd.DataFrame(sample_data)
    
    # 30세 이상인 데이터만 필터링
    filtered_df = df[df['age'] > 30]
    
    print("Filtered Data:")
    print(filtered_df)
    
    return filtered_df.to_json()
```

이 상태에서 함수를 배포하고 테스트하면, Pandas 라이브러리가 없기 때문에 `ModuleNotFoundError: No module named 'pandas'` 오류가 발생합니다.

### 2단계: 람다 레이어 추가

이제 람다 함수에 Pandas 라이브러리가 포함된 레이어를 추가합니다.

1. 람다 함수의 **`Code`** 탭 하단에 있는 **`Layers`** 섹션에서 **`Add a layer`**를 클릭합니다.
    
2. **`Choose a layer`**에서 **`AWS layers`**를 선택합니다. AWS는 Pandas와 같은 공통 라이브러리에 대한 공식 레이어를 제공합니다.
    
3. **`AWSSDKPandas-Python313`** (또는 사용 중인 Python 버전에 맞는 Pandas 레이어)를 선택하고 **`Add`**를 클릭합니다.

### 3단계: 함수 재테스트

레이어를 추가한 후 함수를 다시 테스트합니다.

- **결과:** 이번에는 함수가 성공적으로 실행됩니다.
    
- **로그 확인:** CloudWatch Logs를 확인하면 Pandas를 사용하여 데이터가 성공적으로 필터링된 결과가 출력되는 것을 볼 수 있습니다.

이 실습을 통해 함수 코드를 수정하지 않고도 외부 종속성 문제를 해결하고, 여러 함수에서 동일한 라이브러리를 효율적으로 공유할 수 있음을 확인했습니다.