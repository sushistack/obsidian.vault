
Amazon Athena는 AWS S3에 저장된 데이터를 **표준 SQL**로 직접 분석할 수 있는 **서버리스 쿼리 서비스**입니다. 데이터를 다른 곳으로 옮기거나 데이터베이스를 프로비저닝할 필요 없이, S3의 파일을 바로 쿼리할 수 있습니다. Athena는 내부적으로 **Presto** 엔진을 기반으로 작동합니다.

---

## 1. ⚙️ Athena의 기본 특징

![[Pasted image 20250914194002.png]]

- **서버리스**: 별도의 인스턴스나 클러스터를 관리할 필요 없이, 필요한 시점에 바로 쿼리를 실행할 수 있습니다.
    
- **SQL 사용**: 사용자는 친숙한 SQL 언어를 사용하여 S3 데이터를 분석할 수 있습니다.
    
- **다양한 파일 형식 지원**: CSV, JSON, ORC, Avro, Parquet 등 다양한 파일 형식을 지원합니다.
    
- **과금 방식**: 스캔한 데이터의 양(테라바이트당)에 따라 비용이 부과됩니다. 쿼리를 실행할 때만 비용이 발생하므로 매우 경제적입니다.
    
- **주요 용도**: S3에 저장된 AWS 서비스 로그(VPC Flow Logs, CloudTrail 등)나 데이터 레이크의 데이터를 분석하고, BI 도구(예: Amazon QuickSight)의 데이터 소스로 활용됩니다.
    

---

## 2. 🚀 Athena 성능 최적화 및 비용 절감 방안

Athena는 스캔한 데이터 양에 비례하여 비용이 발생하므로, 성능을 최적화하고 비용을 절감하는 것이 중요합니다.

|최적화 방안|설명|효과|
|---|---|---|
|**컬럼 기반 포맷**|**Parquet** 또는 **ORC**와 같은 컬럼 기반 파일 포맷을 사용합니다.|필요한 컬럼만 읽어오므로 **데이터 스캔 양이 대폭 감소**하고 쿼리 속도가 향상됩니다.|
|**데이터 압축**|GZIP, Snappy 등 압축 포맷을 사용하여 파일 크기를 줄입니다.|스캔할 데이터의 크기가 작아져 **비용이 절감**되고 쿼리 성능이 개선됩니다.|
|**파티셔닝**|폴더 구조를 사용하여 데이터를 파티셔닝합니다.<br>(예: `.../year=2023/month=09/...`)|`WHERE` 절에 파티션 컬럼을 사용하여 **스캔 범위를 최소화**합니다.|
|**파일 크기 최적화**|수많은 작은 파일 대신 **128MB 이상**의 큰 파일을 사용합니다.|오버헤드가 줄어들어 쿼리 성능이 향상됩니다.|

---

## 3. 🌐 페더레이티드 쿼리 (Federated Query)

![[Pasted image 20250914194022.png]]

Athena의 가장 강력한 기능 중 하나는 **페더레이티드 쿼리**입니다. 이 기능을 사용하면 S3 외부에 저장된 데이터 소스를 쿼리할 수 있습니다.

- **원리**: **데이터 소스 커넥터(Data Source Connector)**라는 **AWS Lambda 함수**를 사용하여 Athena 쿼리를 다른 데이터베이스나 서비스로 확장합니다.
    
- **지원 데이터 소스**: Amazon RDS, DynamoDB, DocumentDB, ElastiCache 등 AWS 서비스는 물론, 온프레미스 데이터베이스까지 쿼리할 수 있습니다.
    
- **활용**: S3의 데이터와 RDS 데이터베이스의 데이터를 JOIN하는 등 복잡한 분석 쿼리를 단일 SQL 문으로 실행할 수 있습니다. 쿼리 결과는 S3 버킷에 저장됩니다.
    

---

## 4. 🎯 결론

Amazon Athena는 S3 데이터를 SQL로 분석할 때 가장 먼저 고려해야 할 **서버리스 솔루션**입니다. `Parquet/ORC` 포맷, `파티셔닝`, `압축`을 통해 성능과 비용을 최적화하는 방법을 이해하는 것이 중요하며, `페더레이티드 쿼리`를 통해 S3 외의 다양한 데이터 소스를 통합 분석할 수 있습니다. 시험 문제에서 **"S3 데이터에 대한 서버리스 SQL 쿼리"**가 언급되면, Athena를 떠올려야 합니다.