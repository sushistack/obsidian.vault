
람다 함수를 운영 환경에서 관리하려면 함수가 어떻게 동작하고 있는지, 성능에 문제는 없는지 등을 지속적으로 모니터링하는 것이 중요합니다. AWS는 람다 함수에 대한 **로깅, 지표, 추적**을 기본적으로 제공하며, 이를 통해 함수의 상태를 쉽게 파악할 수 있습니다.

---

## 1. CloudWatch Logs: 상세한 로그 기록

모든 람다 함수의 실행 로그는 자동으로 **CloudWatch Logs**에 저장됩니다. 이는 람다 함수의 실행 역할에 `AWSLambdaBasicExecutionRole` 정책이 포함되어 있어야 가능하며, 이 정책은 로그 그룹을 생성하고 로그 스트림에 로그 이벤트를 쓸 수 있는 권한을 부여합니다.

- **로그 스트림**: 함수가 호출될 때마다 새로운 로그 스트림이 생성되며, 함수 내의 `print` (Python), `console.log` (Node.js) 등 모든 로그가 여기에 기록됩니다.
    
- **Request ID**: 각 호출에는 고유한 **요청 ID(Request ID)**가 부여되며, 로그 시작과 끝에 이 ID가 포함되어 특정 호출의 모든 로그를 쉽게 추적할 수 있습니다.
    
- **Report**: 함수 실행이 완료되면 **`REPORT`** 라인이 추가되어 `Duration` (실행 시간), `Billed Duration` (청구 시간), `Memory Size` (할당 메모리), `Max Memory Used` (최대 사용 메모리) 등의 정보를 요약해서 보여줍니다.

---

## 2. CloudWatch Metrics: 성능 지표

람다 함수는 별도의 설정 없이도 다양한 성능 지표를 **CloudWatch Metrics**로 자동 전송합니다. 이 지표들은 CloudWatch 콘솔 또는 람다 함수의 **`Monitor`** 탭에서 그래프 형태로 시각화하여 볼 수 있습니다.

|지표 이름|설명|
|---|---|
|**Invocations**|함수가 호출된 총 횟수|
|**Duration**|함수 실행 시간 (밀리초)|
|**Errors**|함수 실행 중 발생한 오류 횟수|
|**Throttles**|동시성 한도 초과로 인해 호출이 제한된 횟수|
|**IteratorAge**|Kinesis나 DynamoDB Streams와 같이 스트림에서 데이터를 읽는 경우, 마지막으로 처리된 레코드와 최신 레코드 간의 지연 시간 (밀리초)|
|**ConcurrentExecutions**|특정 시점에 동시에 실행되고 있는 함수 인스턴스 수|

이러한 지표를 통해 함수의 성공률, 성능 추이, 동시성 수준 등을 한눈에 파악할 수 있습니다.

---

## 3. X-Ray: 분산 추적(Distributed Tracing)

**AWS X-Ray**는 람다 함수 호출의 전체 흐름을 시각적으로 추적하고 분석하는 서비스입니다. 람다 함수 내에서 **X-Ray 활성 추적(Active Tracing)**을 활성화하면, 함수가 호출하는 다른 AWS 서비스(예: S3, DynamoDB)에 대한 호출 정보까지 추적하여 **서비스 맵(Service Map)**을 생성합니다.

### X-Ray 활성화 단계

1. **람다 설정**: 람다 함수의 **`Configuration`** 탭에서 **`Monitoring and operations tools`**를 선택하고, **`X-Ray`**를 활성화합니다.

2. **IAM 권한**: 콘솔에서 X-Ray를 활성화하면 람다 함수의 실행 역할에 `AWSXRayDaemonWriteAccess` 정책이 자동으로 추가됩니다. 이 정책은 람다 함수가 X-Ray에 추적 데이터를 기록할 수 있는 권한을 부여합니다.

3. **코드**: 필요에 따라 X-Ray SDK를 사용하여 함수 코드 내에서 특정 세그먼트를 세부적으로 계측(instrument)할 수 있습니다.

4. **확인**: 함수를 실행한 후 X-Ray 콘솔로 이동하면, 람다 함수와 연결된 다른 서비스들의 상호작용을 포함한 전체 요청 흐름을 시각화된 서비스 맵으로 볼 수 있습니다.

이를 통해 함수의 지연 원인, 병목 현상 등을 정확히 파악하여 성능을 최적화할 수 있습니다.