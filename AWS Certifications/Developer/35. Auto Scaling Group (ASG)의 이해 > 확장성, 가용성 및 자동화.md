
클라우드 환경에서 웹사이트나 애플리케이션의 트래픽은 시시각각 변합니다. 사용자가 증가하면 더 많은 서버가 필요하고, 감소하면 서버를 줄여 비용을 최적화해야 합니다. 

AWS의 Auto Scaling Group (ASG)은 이러한 요구사항을 자동으로 처리하여 애플리케이션의 확장성(Scalability)과 가용성(Availability)을 보장하는 핵심 서비스입니다.

---
### 1. Auto Scaling Group (ASG)이란 무엇인가요?

ASG의 주요 목표는 EC2 인스턴스를 자동으로 **추가(scale out)**하거나 **제거(scale in)**하여 변화하는 로드에 맞추는 것입니다. 이를 통해 애플리케이션의 성능을 유지하고 비용 효율성을 높일 수 있습니다.

#### 1.1. ASG의 핵심 기능

- **Scale Out (확장):** 로드 증가에 따라 EC2 인스턴스를 자동으로 추가합니다.
- **Scale In (축소):** 로드 감소에 따라 EC2 인스턴스를 자동으로 제거합니다.
- **최소/최대 인스턴스 보장:** ASG 내에서 실행되는 EC2 인스턴스의 **최소(minimum)** 및 **최대(maximum)** 개수를 정의하여 안정적인 운영을 보장합니다.
- **인스턴스 상태 관리:** ASG는 비정상(unhealthy)으로 판단된 EC2 인스턴스를 자동으로 종료하고, 새로운 정상 인스턴스를 생성하여 대체함으로써 애플리케이션의 **고가용성**을 유지합니다.
- **로드 밸런서 연동:** ASG에 속한 모든 EC2 인스턴스는 자동으로 연결된 로드 밸런서(ALB, NLB, CLB)에 등록되어 트래픽을 분산 받습니다.

#### 1.2. 비용

ASG 자체는 무료 서비스입니다. ASG에 의해 생성되고 관리되는 EC2 인스턴스와 같은 AWS 리소스에 대해서만 비용을 지불합니다.

---

### 2. ASG의 작동 원리

ASG는 사용자가 설정한 몇 가지 핵심 파라미터를 기반으로 작동합니다.

![[Pasted image 20250705225702.png]]

#### 2.1. ASG 용량 설정

|설정 항목|설명|예시|
|---|---|---|
|**최소 용량 (Minimum Capacity)**|ASG에 항상 유지되어야 하는 EC2 인스턴스의 최소 개수입니다. 이 값 아래로 인스턴스가 줄어들지 않습니다.|`2`|
|**희망 용량 (Desired Capacity)**|ASG가 현재 유지하기를 원하는 EC2 인스턴스의 개수입니다. 이 값은 최소 용량과 최대 용량 사이에 있어야 합니다.|`4`|
|**최대 용량 (Maximum Capacity)**|ASG에 존재할 수 있는 EC2 인스턴스의 최대 개수입니다. 이 값 위로 인스턴스가 늘어나지 않습니다.|`7`|

- 희망 용량을 증가시키면 ASG는 인스턴스를 추가하여 **스케일 아웃**하고, 감소시키면 인스턴스를 제거하여 **스케일 인**합니다.

#### 2.2. 로드 밸런서 (ELB)와의 통합

![[Pasted image 20250705225721.png]]

ASG는 로드 밸런서와 함께 사용될 때 시너지를 발휘합니다.

- **트래픽 분산:** ASG에 의해 생성된 모든 EC2 인스턴스는 자동으로 연동된 ELB에 등록되어 사용자 트래픽을 효율적으로 분산 받습니다.

- **헬스 체크 연동:** ELB는 주기적으로 EC2 인스턴스의 **헬스 체크(Health Check)**를 수행하여 인스턴스의 건강 상태를 확인합니다. 이 헬스 체크 결과는 ASG로 전달될 수 있습니다.

- **비정상 인스턴스 자동 교체:** ELB의 헬스 체크에서 비정상으로 판단된 EC2 인스턴스는 ASG에 의해 자동으로 종료되고, 새로운 정상 인스턴스로 교체되어 서비스의 연속성을 보장합니다.

---

### 3. ASG 생성에 필요한 속성: 시작 템플릿 (Launch Template)

ASG는 EC2 인스턴스를 생성할 때 어떤 설정으로 생성해야 할지 알아야 합니다. 이 정보를 정의하는 것이 시작 템플릿(Launch Template)입니다. (이전에는 '시작 구성(Launch Configuration)'이 사용되었지만, 현재는 더 유연한 시작 템플릿 사용이 권장됩니다.)

시작 템플릿에는 EC2 인스턴스 생성에 필요한 모든 파라미터가 포함됩니다.

| 설정 항목                                              | 설명                                    |
| -------------------------------------------------- | ------------------------------------- |
| **AMI (Amazon Machine Image)**                     | 인스턴스에 설치될 운영 체제 및 소프트웨어가 포함된 이미지입니다.  |
| **인스턴스 유형 (Instance Type)**                        | EC2 인스턴스의 CPU, 메모리, 스토리지 용량 등을 정의합니다. |
| **EC2 사용자 데이터 (User Data)**                        | 인스턴스 시작 시 실행될 스크립트 또는 명령입니다.          |
| **EBS 볼륨 (EBS Volumes)**                           | 인스턴스에 연결될 스토리지 볼륨 설정입니다.              |
| **보안 그룹 (Security Groups)**                        | 인스턴스의 네트워크 트래픽을 제어하는 방화벽 규칙입니다.       |
| **SSH 키 페어 (SSH Key Pair)**                        | 인스턴스에 안전하게 접속하기 위한 키 페어입니다.           |
| **IAM 역할 (IAM Role)**                              | 인스턴스가 AWS 서비스와 상호작용하기 위한 권한입니다.       |
| **네트워크 및 서브넷 정보 (Network and Subnet Information)** | 인스턴스가 배포될 VPC 및 서브넷 정보입니다.            |
| **로드 밸런서 정보 (Load Balancer Information)**          | ASG가 어떤 로드 밸런서에 인스턴스를 등록할지 정의합니다.     |

---

### 4. 자동 스케일링 정책 (Scaling Policies)

ASG의 "자동" 부분은 CloudWatch 알람(CloudWatch Alarms)과 연동된 스케일링 정책(Scaling Policies)을 통해 구현됩니다.

#### 4.1. CloudWatch 알람 연동

![[Pasted image 20250705225957.png]]

- **CloudWatch:** AWS 리소스와 애플리케이션을 모니터링하는 서비스입니다. 다양한 지표(CPU 사용률, 네트워크 트래픽 등)를 수집하고 알람을 설정할 수 있습니다.
    
- **지표 기반 스케일링:** ASG는 CloudWatch 알람을 통해 특정 **지표(Metric)**가 설정된 임계값을 초과하거나 미달할 때 자동으로 스케일링 작업을 트리거할 수 있습니다.
    
    - **예시:** ASG에 속한 EC2 인스턴스들의 **평균 CPU 사용률**이 일정 시간 동안 70%를 초과하면, CloudWatch 알람이 트리거되고 ASG에 **스케일 아웃** 활동을 지시합니다. 반대로 CPU 사용률이 30% 미만으로 떨어지면 **스케일 인** 활동을 지시할 수 있습니다.

#### 4.2. 스케일링 정책의 종류

CloudWatch 알람이 트리거되면 ASG는 다음 두 가지 유형의 스케일링 정책 중 하나를 실행할 수 있습니다.

- **Scale Out 정책:** 인스턴스 개수를 증가시키는 정책입니다 (예: `+1` 인스턴스 추가, `25%` 증가 등).
- **Scale In 정책:** 인스턴스 개수를 감소시키는 정책입니다 (예: `-1` 인스턴스 제거, `10%` 감소 등).

---

### 결론

Auto Scaling Group은 AWS 클라우드에서 **동적으로 변화하는 트래픽에 대응**하고, **애플리케이션의 가용성을 지속적으로 유지**하며, **비용 효율성을 최적화**하는 데 필수적인 서비스입니다. 로드 밸런서 및 CloudWatch와의 강력한 통합을 통해 거의 모든 웹 서비스 및 애플리케이션 환경에서 핵심적인 역할을 수행합니다.
