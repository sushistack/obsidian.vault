

이번 실습에서는 Amazon ECS(Elastic Container Service) 콘솔을 사용하여 클러스터를 생성하고, **Fargate**와 **EC2**라는 두 가지 시작 유형(Launch Type)을 모두 포함하는 인프라를 구축해 보겠습니다.

---

### 1. ECS 클러스터 생성 🛠️

먼저, 컨테이너를 실행할 클러스터를 생성합니다. 이 클러스터는 Fargate와 EC2 인스턴스를 모두 지원하도록 설정됩니다.

1. **ECS 콘솔**로 이동하여 `클러스터(Clusters)` > `클러스터 생성(Create Cluster)`을 선택합니다.
    
2. **클러스터 이름:** `DemoCluster`
    
3. **인프라:**
    
    - **Fargate (서버리스):** Fargate는 기본으로 활성화되어 있습니다. AWS가 컨테이너 실행을 위한 컴퓨팅 인프라를 자동으로 관리합니다.
    - **Amazon EC2 인스턴스 (관리형):** `Amazon EC2 instances`를 활성화합니다.

4. **Auto Scaling Group 설정:**
    
    - **운영 체제:** `Amazon Linux 2` 또는 `Amazon Linux 2023`을 선택합니다.
    - **EC2 인스턴스 유형:** `t2.micro` (프리티어)
    - **용량:** `최소 용량: 0`, `최대 용량: 5`, `원하는 용량: 0`으로 설정합니다.

5. **네트워크 설정:** 기본 VPC와 사용 가능한 모든 서브넷을 선택합니다.
    
6. `생성(Create)`을 클릭하여 클러스터를 생성합니다.
    

### 2. 클러스터 인프라 확인 🔎

클러스터 생성이 완료되면, ECS가 자동으로 생성한 리소스들을 확인해 봅니다.

1. **Auto Scaling 그룹 확인:** EC2 콘솔에서 `Auto Scaling 그룹(Auto Scaling Groups)` 메뉴로 이동합니다.
    
    - `infra-ECS-Cluster`와 같은 이름의 Auto Scaling 그룹이 생성된 것을 볼 수 있습니다.
    - 원하는 용량이 `0`이므로, 현재는 EC2 인스턴스가 실행되고 있지 않습니다.

2. **ECS 클러스터 상세 정보 확인:** ECS 콘솔에서 `DemoCluster`로 이동합니다.
    
    - `인프라(Infrastructure)` 탭을 클릭하면 클러스터에 연결된 **용량 공급자(Capacity Providers)**가 보입니다.
    - **FARGATE**와 **FARGATE_SPOT**은 Fargate 태스크를 실행하기 위한 용량 공급자입니다.
    - **ASGProvider**는 EC2 시작 유형을 지원하기 위한 용량 공급자입니다.

---

### 3. EC2 인스턴스 용량 추가 📈

EC2 시작 유형을 사용하려면 컨테이너를 실행할 인스턴스가 필요합니다.

1. `DemoCluster`의 `인프라` 탭에서 **`ASGProvider`**를 선택하고 `세부 정보(Details)` > `편집(Edit)`을 클릭합니다.
2. `원하는 크기(Desired capacity)`를 `1`로 변경하고 저장합니다.
3. ECS가 이 설정을 바탕으로 EC2 인스턴스를 프로비저닝하고, 인스턴스가 클러스터에 등록되기까지 잠시 기다립니다.

**결과 확인:**

- 클러스터의 `ECS 인스턴스(Container Instances)` 탭으로 이동하면, **t2.micro** 인스턴스가 클러스터에 등록되어 있는 것을 볼 수 있습니다.
- 이 인스턴스에 할당된 CPU 및 메모리 용량도 확인할 수 있습니다. 이제 이 인스턴스 위에 ECS 태스크를 배치할 수 있습니다.

이 실습을 통해 ECS 클러스터가 Fargate와 EC2라는 두 가지 인프라를 동시에 지원하도록 설정하는 방법을 익혔습니다. 다음 단계에서는 이 클러스터에 실제 컨테이너를 배포하는 방법을 알아보겠습니다.