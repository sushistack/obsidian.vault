
이번 강의에서는 Amazon EFS (Elastic File System)에 대해 알아보겠습니다. EFS는 AWS에서 제공하는 관리형 NFS (Network File System)입니다. 네트워크 파일 시스템이기 때문에 여러 EC2 인스턴스에 마운트할 수 있으며, 중요한 점은 이러한 EC2 인스턴스들이 서로 다른 가용 영역 (Availability Zone, AZ)에 있을 수 있다는 것입니다. 이것이 바로 EFS의 강력한 장점입니다.

**특징 요약:**
- **고가용성 (Highly Available)**
- **높은 확장성 (Very Scalable)**
- **종량제 (Pay per Use)**: 용량을 미리 프로비저닝할 필요가 없습니다.
- **비용**: GP2 EBS 볼륨 대비 약 3배 정도 비쌉니다.
- **Linux 기반 AMI 호환**: Windows 기반 AMI와는 호환되지 않습니다.

### EFS 작동 방식

EFS 파일 시스템을 생성하고 보안 그룹으로 보호합니다. 그런 다음, 여러 AZ (예: `us-east-1a`, `us-east-1b`, `us-east-1c`)에 있는 여러 EC2 인스턴스가 EFS를 통해 동일한 네트워크 파일 시스템에 동시에 연결할 수 있습니다.

![[Pasted image 20250602145405.png]]
### EFS 사용 사례

- 콘텐츠 관리 (Content Management)
- 웹 서버 (Web Serving)
- 데이터 공유 (Data Sharing)
- WordPress

내부적으로 NFS 프로토콜을 사용하며, EFS에 대한 접근 제어는 보안 그룹을 통해 설정합니다. EFS 드라이브에 저장 시 암호화 (at-rest encryption)를 KMS를 사용하여 활성화할 수 있으며, Linux의 표준 파일 시스템 (POSIX 호환) 및 표준 파일 API를 사용합니다.

### EFS의 장점

- **자동 확장**: 용량을 미리 계획할 필요 없이 파일 시스템이 자동으로 확장됩니다.
- **종량제**: EFS에서 사용하는 데이터의 기가바이트당 요금을 지불합니다.

### 성능 모드 (Performance Mode)

EFS 파일 시스템 생성 시 성능 모드를 설정할 수 있습니다.

| **성능 모드**           | **설명**                                        | **사용 사례**              |
| ------------------- | --------------------------------------------- | ---------------------- |
| **General Purpose** | 기본 설정이며, 웹 서버, CMS 등 지연 시간에 민감한 사용 사례에 적합합니다. | 웹 서버, CMS 등            |
| **Max I/O**         | 높은 처리량과 병렬 처리에 최적화되어 있으며, 지연 시간은 높을 수 있습니다.   | 빅 데이터 애플리케이션, 미디어 처리 등 |

### 처리량 모드 (Throughput Mode)

EFS의 처리량 모드를 설정하는 옵션입니다.

| **처리량 모드**      | **설명**                                                |
| --------------- | ----------------------------------------------------- |
| **Bursting**    | 기본 설정으로, 기준 처리량과 버스트 처리량을 제공합니다 (스토리지 크기에 따라 처리량 증가). |
| **Provisioned** | 스토리지 크기와 관계없이 원하는 처리량을 설정할 수 있습니다.                    |
| **Elastic**     | 워크로드에 따라 처리량을 자동으로 확장 및 축소합니다 (읽기/쓰기 최대 처리량 상이).      |

### 스토리지 클래스 (Storage Classes)

EFS는 비용 최적화를 위해 다양한 스토리지 클래스를 제공하며, 수명 주기 관리 (Lifecycle Management) 기능을 통해 파일들을 다른 스토리지 티어로 자동 이동할 수 있습니다.

| **스토리지 티어**  | **접근 빈도**      | **특징**                                     |
| ------------ | -------------- | ------------------------------------------ |
| **Standard** | 자주 접근하는 파일     | 고성능, 고가용성 (Multi-AZ)                       |
| **EFS-IA**   | 드물게 접근하는 파일    | Standard 대비 낮은 스토리지 비용, 파일 검색 시 비용 발생      |
| **Archive**  | 매우 드물게 접근하는 파일 | EFS-IA 대비 더 낮은 스토리지 비용, 파일 검색 시 더 높은 비용 발생 |

**라이프사이클 정책 (Lifecycle Policies)**을 설정하여 파일이 특정 기간 동안 접근되지 않으면 자동으로 다른 스토리지 티어로 이동하도록 구성할 수 있습니다.

```
EFS Standard -> (60일 미접근) -> EFS-IA
```

### 가용성 및 내구성

- **Standard**: Multi-AZ 구성으로 프로덕션 워크로드에 적합하며 재해 복구에 강합니다.
- **One Zone**: 단일 AZ 구성으로 개발 환경 등 저렴한 옵션이 필요할 때 선택하며, 백업 기능은 제공됩니다. IA 스토리지 티어와 호환됩니다 (`EFS One Zone-IA`).

적절한 EFS 스토리지 클래스를 사용하면 비용을 최대 90%까지 절감할 수 있습니다.
