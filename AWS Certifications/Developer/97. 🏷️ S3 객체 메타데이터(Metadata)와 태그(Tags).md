
Amazon S3 객체에는 객체 자체에 대한 정보를 담는 **메타데이터(Metadata)**와 **태그(Tags)**를 추가할 수 있습니다. 이 두 가지는 모두 키-값 쌍(key-value pairs)의 형태지만, 목적과 사용법에 약간의 차이가 있습니다.

---

### 1. 사용자 정의 객체 메타데이터 (User-defined Object Metadata)

- **정의:** 객체와 함께 저장되는 키-값 쌍의 정보입니다. `x-amz-meta-` 접두사를 사용하여 사용자 정의 메타데이터를 추가할 수 있습니다.
    
- **특징:**
    - 객체와 함께 검색되지만, **S3 내에서 메타데이터로 객체를 직접 검색하거나 필터링할 수는 없습니다.**
    - `Content-Length`, `Content-Type` 등 AWS가 자동으로 생성하는 시스템 메타데이터와 구분됩니다.
- **예시:** `x-amz-meta-origin: paris` (`paris`에서 업로드된 파일임을 나타냄)
- **주요 용도:** 객체에 대한 부가 정보를 저장하는 데 사용됩니다.

### 2. S3 객체 태그 (S3 Object Tags)

- **정의:** S3 객체에 할당할 수 있는 키-값 쌍의 레이블입니다.
- **특징:**
    - **세분화된 권한 관리(Fine-grained permissions)**에 사용될 수 있습니다. IAM 정책에서 특정 태그가 있는 객체에만 접근을 허용하는 규칙을 만들 수 있습니다.
    - **비용 관리 및 분석:** S3 분석(Analytics) 도구에서 태그를 기준으로 데이터를 그룹화하고 분석할 수 있습니다.
- **예시:** `Project: Blue`, `PHI: True` (개인 건강 정보 포함 여부)
- **주요 용도:** 권한 제어, 비용 분석, 데이터 분류 등에 사용됩니다.

### 3. 가장 중요한 규칙: 검색 불가능성 🔍

> 메타데이터와 태그 모두 S3 내에서 직접 검색하거나 필터링하는 데 사용할 수 없습니다.
> aws s3 ls --metadata "key=value" 와 같은 명령어는 존재하지 않습니다.

### 4. S3 객체 검색 아키텍처

만약 S3 객체의 메타데이터나 태그를 기준으로 검색 기능을 구현해야 한다면, **외부 데이터베이스에 별도의 인덱스를 구축**해야 합니다.

1. **객체 업로드 이벤트:** S3에 객체가 업로드될 때 이벤트 알림을 트리거합니다.
2. **데이터베이스 저장:** 이벤트 알림에 포함된 메타데이터 및 태그 정보를 **DynamoDB**와 같은 외부 데이터베이스에 저장합니다.
3. **검색 수행:** 애플리케이션은 DynamoDB에서 검색을 수행합니다.
4. **객체 추출:** 검색 결과로 얻은 객체 키를 사용하여 S3에서 실제 객체를 가져옵니다.

이 아키텍처는 S3의 검색 한계를 극복하는 일반적인 모범 사례이며, 시험에 자주 출제되는 중요한 개념입니다.

---

**요약:**

|구분|메타데이터 (Metadata)|태그 (Tags)|
|---|---|---|
|**형식**|`x-amz-meta-`로 시작하는 키-값 쌍|키-값 쌍|
|**주요 용도**|객체에 대한 부가 정보 저장|권한 제어, 비용 분석, 데이터 분류|
|**S3 내 검색**|**불가능**|**불가능**|
|**모범 사례**|검색이 필요하면 외부 데이터베이스에 인덱스 구축|검색이 필요하면 외부 데이터베이스에 인덱스 구축|
