
이번 글에서는 IAM의 고급 개념인 **`iam:PassRole`** 권한과 **신뢰 관계(Trust Relationship)**에 대해 자세히 알아보겠습니다. 이 두 가지 개념은 AWS 서비스에 IAM 역할을 할당하여 서비스가 다른 AWS 리소스에 안전하게 접근하도록 하는 데 필수적입니다.

---

## 1. 🤝 iam:PassRole 권한의 역할

**`iam:PassRole`** 권한은 사용자가 **다른 AWS 서비스에 IAM 역할을 할당**할 수 있도록 허용합니다. 예를 들어, EC2 인스턴스를 생성하면서 S3 버킷에 접근할 수 있는 IAM 역할을 부여할 때 이 권한이 필요합니다.

### 왜 필요한가?

IAM 역할이 서비스에 부여되면, 해당 서비스는 그 역할을 **가정(assume)**하고 역할에 연결된 권한을 일시적으로 사용합니다. 이때, 악의적인 사용자가 과도한 권한을 가진 역할을 서비스에 할당하는 것을 방지하기 위해 `PassRole` 권한을 통해 할당 가능한 역할을 통제합니다.

### 정책 예시

아래 IAM 정책은 사용자에게 EC2 인스턴스에 대한 모든 권한과 함께, `S3Access`라는 이름의 특정 역할만 EC2 인스턴스에 할당할 수 있는 권한을 부여합니다.

```JSON
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "ec2:*",
      "Resource": "*"
    },
    {
      "Effect": "Allow",
      "Action": "iam:PassRole",
      "Resource": "arn:aws:iam::123456789012:role/S3Access"
    }
  ]
}
```

---

## 2. 🛡️ 신뢰 관계(Trust Relationship)

**신뢰 관계(Trust Relationship)**는 어떤 AWS 서비스가 특정 IAM 역할을 가정할 수 있는지 정의하는 IAM 정책입니다. 이것은 역할 자체에 내장된 정책 문서로, 역할의 **신뢰할 수 있는 엔터티(Trusted Entities)**를 명시합니다.

### 신뢰 관계의 중요성

`PassRole` 권한이 역할을 **할당**하는 행위를 제어한다면, 신뢰 관계는 실제로 해당 서비스가 그 역할을 **사용**할 수 있는지 여부를 결정합니다.

예를 들어, EC2 인스턴스가 DynamoDB에 접근하기 위해 `DynamoDBAccessRole`을 할당받았다고 가정해 봅시다.

- **`iam:PassRole`**: 사용자는 `iam:PassRole` 권한을 통해 `DynamoDBAccessRole`을 EC2 인스턴스에 할당합니다.
    
- **신뢰 관계**: `DynamoDBAccessRole`의 신뢰 관계는 **`ec2.amazonaws.com`**을 신뢰할 수 있는 엔터티로 지정해야 합니다. 만약 이 신뢰 관계가 없다면, EC2 인스턴스는 역할을 할당받았더라도 해당 역할을 가정할 수 없어 권한을 사용할 수 없습니다.

### IAM 콘솔에서의 확인

IAM 콘솔에서 특정 역할을 클릭하고 **`신뢰 관계(Trust relationships)`** 탭을 보면, 어떤 서비스가 이 역할을 가정할 수 있는지 JSON 문서로 확인할 수 있습니다.

예시: Lambda 함수 역할

Lambda 함수의 IAM 역할을 보면, 신뢰 관계에 lambda.amazonaws.com이 명시되어 있어 Lambda 서비스가 해당 역할을 가정할 수 있음을 나타냅니다.

```JSON
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "Service": "lambda.amazonaws.com"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}
```

---

## 3. 📝 `iam:PassRole`과 신뢰 관계의 종합적인 역할

1. **신뢰 관계 설정**: 먼저 IAM 역할을 생성하고, 해당 역할을 사용할 서비스(예: `ec2.amazonaws.com`, `lambda.amazonaws.com`)를 **신뢰 관계**에 추가하여 역할 사용을 허용합니다.
    
2. **`iam:PassRole` 권한 부여**: 역할을 할당하려는 사용자에게 `iam:PassRole` 권한을 부여하여, 특정 역할을 서비스에 **넘겨줄 수 있는** 권한을 줍니다.
    
3. **역할 할당**: 사용자는 이제 역할 할당 권한을 이용해 신뢰 관계가 설정된 역할을 해당 서비스에 할당합니다.
    
4. **역할 가정**: 서비스는 할당받은 역할을 가정하여 필요한 작업을 수행합니다.

이러한 단계별 접근은 IAM 보안을 강화하고, 서비스가 꼭 필요한 권한만 갖도록 보장하는 핵심 메커니즘입니다.