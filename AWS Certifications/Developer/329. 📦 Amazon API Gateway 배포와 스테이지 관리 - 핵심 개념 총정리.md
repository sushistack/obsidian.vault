
μ΄λ² μ•„ν‹°ν΄μ—μ„λ” Amazon API Gatewayμ **λ°°ν¬(Deployment)**μ™€ **μ¤ν…μ΄μ§€(Stage)** κ°λ…μ„ κΉμ΄ μκ² λ‹¤λ£Ήλ‹λ‹¤. API λ³€κ²½ μ‚¬ν•­μ„ μ μ©ν•κ³ , μ—¬λ¬ λ²„μ „μ„ λ™μ‹μ— μ΄μν•λ©°, ν™κ²½λ³„ μ„¤μ •μ„ μ μ—°ν•κ² κ΄€λ¦¬ν•λ” λ°©λ²•μ„ μƒμ„Έν μ•μ•„λ³΄κ² μµλ‹λ‹¤.

---

## π€ 1λ‹¨κ³„: λ°°ν¬(Deployment)μ μ΄ν•΄

API Gatewayμ—μ„ API μ„¤μ •μ„ λ³€κ²½ν• ν›„μ—λ” λ°λ“μ‹ **λ°°ν¬(Deployment)** κ³Όμ •μ„ κ±°μ³μ•Όλ§ κ·Έ λ³€κ²½ μ‚¬ν•­μ΄ μ‹¤μ  APIμ— λ°μλ©λ‹λ‹¤. μ΄λ” λ§μ€ μ‚¬μ©μλ“¤μ΄ νΌλ™ν•λ” λ¶€λ¶„ μ¤‘ ν•λ‚μ…λ‹λ‹¤. μ½μ†”μ—μ„ λ©”μ„λ“λ‚ λ¦¬μ†μ¤ μ„¤μ •μ„ λ°”κΎΈλ”λΌλ„, **'API λ°°ν¬'**λ¥Ό ν΄λ¦­ν•μ—¬ νΉμ • **μ¤ν…μ΄μ§€**μ— λ°°ν¬ν•΄μ•Όλ§ μµμΆ…μ μΌλ΅ ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘κ·Όν•  μ μλ” APIμ— μ μ©λ©λ‹λ‹¤.

- **ν•µμ‹¬**: λ³€κ²½μ‚¬ν•­μ„ **'ν™μ„±ν™”'**ν•λ ¤λ©΄ λ°λ“μ‹ λ°°ν¬ν•΄μ•Ό ν•©λ‹λ‹¤.
    
- **νμ¤ν† λ¦¬ κ΄€λ¦¬**: API Gatewayλ” λ°°ν¬ μ΄λ ¥μ„ λ¨λ‘ μ €μ¥ν•λ―€λ΅, λ¬Έμ κ°€ λ°μƒν–μ„ λ• νΉμ • μ‹μ μ λ°°ν¬ μƒνƒλ΅ **μ†μ‰½κ² λ΅¤λ°±**ν•  μ μμµλ‹λ‹¤.

---

## π³ 2λ‹¨κ³„: μ¤ν…μ΄μ§€(Stage)μ ν™μ©

![[Pasted image 20250907193244.png]]

**μ¤ν…μ΄μ§€**λ” APIμ νΉμ • λ°°ν¬ λ²„μ „μ„ κ°€λ¦¬ν‚¤λ” λ…Όλ¦¬μ μΈ μ°Έμ΅°μ μ…λ‹λ‹¤. κ°λ°, ν…μ¤νΈ, μ΄μ λ“± λ‹¤μ–‘ν• ν™κ²½μ„ λ¶„λ¦¬ν•μ—¬ κ΄€λ¦¬ν•λ” λ° μ μ©ν•κ² μ‚¬μ©λ©λ‹λ‹¤.

### π“ μ¤ν…μ΄μ§€μ μ£Όμ” κΈ°λ¥

- **ν™κ²½ λ¶„λ¦¬**: `dev`, `test`, `prod`μ™€ κ°™μ΄ λ…ν™•ν• μ΄λ¦„μ μ¤ν…μ΄μ§€λ¥Ό μƒμ„±ν•μ—¬ κ°κΈ° λ‹¤λ¥Έ ν™κ²½μ APIλ¥Ό λ…λ¦½μ μΌλ΅ μ΄μν•  μ μμµλ‹λ‹¤.
    
- **λ²„μ „ κ΄€λ¦¬**: `v1`, `v2`, `v3` λ“± API λ²„μ „μ„ μ¤ν…μ΄μ§€λ΅ κ΄€λ¦¬ν•μ—¬, **μ΄μ „ λ²„μ „κ³Όμ νΈν™μ„±μ„ μ μ§€**ν•λ©΄μ„ μƒλ΅μ΄ κΈ°λ¥μ„ μ μ§„μ μΌλ΅ μ¶μ‹ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, `v1` μ¤ν…μ΄μ§€λ¥Ό ν†µν•΄ κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈμ API μ”μ²­μ„ μ²λ¦¬ν•λ©΄μ„, μƒλ΅μ΄ `v2` μ¤ν…μ΄μ§€λ¥Ό λ§λ“¤μ–΄ μ‹ κ· ν΄λΌμ΄μ–ΈνΈλ¥Ό λ€μƒμΌλ΅ μ„λΉ„μ¤λ¥Ό μ κ³µν•  μ μμµλ‹λ‹¤.
    
- **κ³ μ ν• URL**: κ° μ¤ν…μ΄μ§€λ” `https://api.example.com/v1` λλ” `https://api.example.com/v2`μ™€ κ°™μ΄ κ³ μ ν• νΈμ¶ URLμ„ κ°€μ§‘λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ ν΄λΌμ΄μ–ΈνΈλ” μμ‹ μ΄ μ›ν•λ” λ²„μ „μ APIμ— μ§μ ‘ μ ‘κ·Όν•  μ μμµλ‹λ‹¤.
    

|μ¤ν…μ΄μ§€|μ©λ„|URL μμ‹|
|---|---|---|
|**`dev`**|κ°λ° ν™κ²½|`https://.../dev`|
|**`test`**|ν…μ¤νΈ ν™κ²½|`https://.../test`|
|**`prod`**|μ΄μ ν™κ²½|`https://.../prod`|
|**`v1`**|API λ²„μ „ 1|`https://.../v1`|
|**`v2`**|API λ²„μ „ 2|`https://.../v2`|

---

## π”§ 3λ‹¨κ³„: μ¤ν…μ΄μ§€ λ³€μ(Stage Variables)μ ν™μ©

**μ¤ν…μ΄μ§€ λ³€μ**λ” API Gateway μ¤ν…μ΄μ§€μ— ν• λ‹Ήλ **ν™κ²½ λ³€μ**μ™€ κ°™μµλ‹λ‹¤. APIλ¥Ό μ¬λ°°ν¬ν•μ§€ μ•κ³ λ„ μ¤ν…μ΄μ§€λ³„λ΅ λ™μ μΌλ΅ μ„¤μ •μ„ λ³€κ²½ν•  μ μλ” λ§¤μ° κ°•λ ¥ν• κΈ°λ¥μ…λ‹λ‹¤.

### π’΅ μ¤ν…μ΄μ§€ λ³€μμ μ‚¬μ© μμ‹

- **Lambda ν•¨μ ARN λ™μ  μ§€μ •**: `dev` μ¤ν…μ΄μ§€μ—μ„λ” `dev` ν™κ²½μ Lambda ν•¨μλ¥Ό, `prod` μ¤ν…μ΄μ§€μ—μ„λ” `prod` ν™κ²½μ Lambda ν•¨μλ¥Ό νΈμ¶ν•λ„λ΅ μ„¤μ •ν•  μ μμµλ‹λ‹¤.
    
- **HTTP μ—”λ“ν¬μΈνΈ λ³€κ²½**: κ°λ° ν™κ²½μ—μ„λ” ν…μ¤νΈμ© μ„λ²„λ¥Ό, μ΄μ ν™κ²½μ—μ„λ” μ‹¤μ  ν”„λ΅λ•μ… μ„λ²„λ¥Ό κ°€λ¦¬ν‚¤λ„λ΅ μ„¤μ •ν•  μ μμµλ‹λ‹¤.
    
- **λ§¤ν•‘ ν…ν”λ¦Ώμ— κ°’ μ „λ‹¬**: μ¤ν…μ΄μ§€ λ³€μμ κ°’μ„ λ§¤ν•‘ ν…ν”λ¦Ώμ„ ν†µν•΄ Lambda ν•¨μλ΅ μ „λ‹¬ν•  μ μμµλ‹λ‹¤.
    

μ¤ν…μ΄μ§€ λ³€μλ” `$stageVariables.variableName` ν•μ‹μΌλ΅ API Gateway λ‚΄μ—μ„ μ°Έμ΅°λ©λ‹λ‹¤.

### π¤ Lambda Aliasμ™€ μ¤ν…μ΄μ§€ λ³€μ μ—°λ™: κ³ κΈ‰ ν¨ν„΄

![[Pasted image 20250907193310.png]]

μ¤ν…μ΄μ§€ λ³€μλ¥Ό ν™μ©ν•λ” κ°€μ¥ μΌλ°μ μ΄κ³  ν¨μ¨μ μΈ ν¨ν„΄ μ¤‘ ν•λ‚λ” **Lambda ν•¨μ Alias**μ™€ μ—°λ™ν•λ” κ²ƒμ…λ‹λ‹¤.

μ΄ ν¨ν„΄μ„ μ‚¬μ©ν•λ©΄ API Gatewayλ” ν•­μƒ νΉμ • **λ³„μΉ­(Alias)**μ„ νΈμ¶ν•κ³ , μ΄ λ³„μΉ­μ΄ μ‹¤μ  νΈλν”½μ„ μ–΄λ–¤ λ²„μ „μ Lambda ν•¨μλ΅ λ³΄λ‚Όμ§€ κ²°μ •ν•©λ‹λ‹¤.

|μ¤ν…μ΄μ§€|μ¤ν…μ΄μ§€ λ³€μ (`lambdaAlias`)|μ—°κ²°λ Lambda Alias|νΈλν”½ λΌμ°ν…|
|---|---|---|---|
|**`dev`**|`dev`|`dev`|100% μµμ‹  λ²„μ „|
|**`test`**|`test`|`test`|v2 λ²„μ „ 100%|
|**`prod`**|`prod`|`prod`|v1 95%, v2 5% (μΉ΄λ‚λ¦¬ λ°°ν¬)|

μ΄ λ°©μ‹μ„ μ‚¬μ©ν•λ©΄ Lambda ν•¨μμ λ²„μ „μ„ λ³€κ²½ν•κ±°λ‚ μΉ΄λ‚λ¦¬ λ°°ν¬λ¥Ό ν•  λ• API Gatewayλ¥Ό μ¬λ°°ν¬ν•  ν•„μ”κ°€ μ—†μµλ‹λ‹¤. λ‹¨μ§€ Lambda λ³„μΉ­μ μ„¤μ •μ„ λ³€κ²½ν•λ” κ²ƒλ§μΌλ΅ νΈλν”½μ„ μ μ–΄ν•  μ μμ–΄, API κ΄€λ¦¬κ°€ ν›¨μ”¬ μ μ—°ν•κ³  ν¨μ¨μ μ΄κ² λ©λ‹λ‹¤.