
Amazon Cognito User Pools(CUP)는 웹 및 모바일 애플리케이션 사용자를 위한 **서버리스 사용자 데이터베이스**입니다. 사용자가 직접 회원가입, 로그인, 비밀번호 재설정 등을 처리할 수 있는 기능을 제공하며, 개발자는 복잡한 인증 시스템을 구축할 필요 없이 사용자 관리를 쉽게 할 수 있습니다. 이 글에서는 CUP의 주요 기능과 AWS 서비스 연동 방식에 대해 자세히 알아보겠습니다.

---

## 🔒 CUP의 핵심 기능

### 1. 사용자 관리 및 인증

CUP은 사용자의 **사용자 이름/이메일**과 **비밀번호** 조합을 통해 애플리케이션에 로그인할 수 있게 해줍니다. 사용자는 비밀번호를 재설정할 수 있으며, 이메일이나 전화번호를 통한 인증 절차도 손쉽게 구현할 수 있습니다.

### 2. 다중 요소 인증(MFA)

보안을 강화하기 위해 **다중 요소 인증(MFA)**을 활성화할 수 있습니다. MFA를 통해 사용자는 비밀번호 외에 추가적인 인증 수단(예: SMS로 전송된 코드)을 통해 로그인해야 합니다.

### 3. 소셜 및 제휴 로그인 (Federated Identities)

CUP은 **구글, 페이스북, 아마존**과 같은 소셜 로그인뿐만 아니라, **SAML(Security Assertion Markup Language)**과 같은 기업용 인증 프로토콜을 통한 로그인도 지원합니다. 이를 **Federated Identities**라고 부르며, 사용자는 기존의 소셜 계정을 이용해 손쉽게 회원가입 및 로그인을 할 수 있습니다.

|로그인 유형|설명|
|---|---|
|**기본 로그인**|사용자 이름/이메일 + 비밀번호 조합|
|**소셜 로그인**|구글, 페이스북, 아마존 계정 연동|
|**SAML/OIDC**|SAML 또는 OpenID Connect를 통한 제휴 로그인|

### 4. 보안 및 토큰 관리

CUP은 사용자의 자격 증명이 유출되었는지 웹을 스캔하여 확인하고, 유출된 경우 사용자에게 알림을 보냅니다. 또한 사용자가 성공적으로 로그인하면, CUP은 **JWT(JSON Web Token)**를 반환합니다. 이 JWT는 애플리케이션의 API나 백엔드 서비스에 접근할 때 사용되는 인증 토큰 역할을 합니다.

---

## 🌐 AWS 서비스와의 통합

CUP은 AWS의 다른 서비스들과 연동하여 강력한 인증 시스템을 구축할 수 있습니다.

![[Pasted image 20250913164020.png]]
### 1. API Gateway 연동

API Gateway는 백엔드 API를 구축하는 데 사용되는 서비스입니다. CUP을 API Gateway와 연동하면, 사용자는 CUP으로부터 받은 **JWT**를 API 호출 시 헤더에 포함시켜 보냅니다. API Gateway는 이 토큰의 유효성을 자동으로 검증하고, 유효한 경우에만 백엔드 리소스에 접근을 허용합니다.

코드 스니펫

```
graph TD
    subgraph "사용자"
        A[웹/모바일 애플리케이션] --> B[Cognito User Pool]
    end

    subgraph "AWS 인프라"
        B -- JWT 반환 --> A
        A -- JWT 포함된 API 요청 --> C[API Gateway]
        C -- 토큰 검증 --> B
        C -- 유효성 확인 후 요청 전달 --> D[백엔드]
    end
```

### 2. Application Load Balancer(ALB) 연동

ALB는 들어오는 트래픽을 여러 타겟(예: EC2 인스턴스, Lambda 함수)에 분산하는 서비스입니다. ALB의 리스너(Listener)와 규칙(Rule)을 설정하여 CUP과 연동할 수 있습니다. 사용자가 ALB에 접근하면, ALB는 CUP을 통해 인증을 수행하고, 인증이 완료된 사용자만 백엔드 타겟 그룹으로 트래픽을 전달합니다.

---

## 🎯 CUP의 동작 원리

CUP은 사용자를 위한 내부 데이터베이스를 가지고 있습니다. 웹 또는 모바일 애플리케이션은 이 데이터베이스에 직접 로그인 요청을 보내며, 요청이 성공하면 CUP은 JWT를 반환합니다. 이 JWT를 사용하여 애플리케이션의 백엔드 서비스에 접근할 수 있습니다. 소셜 로그인과 같은 제휴 인증도 CUP을 통해 처리되므로, 여러 인증 방식을 하나의 시스템으로 통합 관리할 수 있습니다.

CUP은 개발자가 복잡한 사용자 인증 시스템을 직접 구축하는 수고를 덜어주며, 서버리스 방식으로 유연하고 확장 가능한 사용자 관리 기능을 제공합니다.