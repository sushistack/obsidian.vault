
AWS DynamoDB는 워크로드에 맞춰 유연하게 용량을 조절할 수 있는 두 가지 핵심 용량 모드를 제공합니다. 바로 **프로비저닝 모드(Provisioned mode)**와 **온디맨드 모드(On-demand mode)**입니다. 이 아티클은 각 모드의 특징, 비용, 그리고 적합한 사용 사례에 대해 상세히 설명합니다.

---

## 1. 두 가지 용량 모드 개요

|특징|프로비저닝 모드 (Provisioned)|온디맨드 모드 (On-demand)|
|---|---|---|
|**용량 계획**|읽기/쓰기 용량 단위(RCU/WCU)를 미리 지정|별도의 용량 계획 불필요|
|**비용**|프로비저닝한 만큼 지불 (고정 비용)|실제 사용량에 따라 지불 (변동 비용)|
|**확장성**|자동 스케일링 설정 가능|자동으로 무제한 확장|
|**제한**|용량 초과 시 스로틀링 발생|스로틀링 없음|
|**적합한 워크로드**|예측 가능한 트래픽 패턴|예측 불가능한 트래픽 패턴|
|**전환**|24시간마다 한 번씩 다른 모드로 전환 가능|24시간마다 한 번씩 다른 모드로 전환 가능|

---

## 2. 프로비저닝 모드 (Provisioned Mode) 상세 분석

이 모드에서는 미리 **읽기 용량 단위(RCU)**와 **쓰기 용량 단위(WCU)**를 설정해야 합니다.

- **RCU(Read Capacity Unit)**: 초당 1개의 강력한 일관된 읽기 또는 2개의 최종적 일관된 읽기(최대 4KB 항목 기준)를 수행할 수 있는 용량.
    
- **WCU(Write Capacity Unit)**: 초당 1개의 쓰기(최대 1KB 항목 기준)를 수행할 수 있는 용량.

### **계산 공식**

DynamoDB는 항목의 크기에 따라 필요한 용량 단위를 계산합니다.

- **WCU 계산**: `(항목 크기(KB)를 1KB 단위로 올림) x (초당 쓰기 요청 수)`
    
- **RCU 계산**:
    
    - **강력한 일관된 읽기**: `(항목 크기(KB)를 4KB 단위로 올림) x (초당 읽기 요청 수)`
        
    - **최종적 일관된 읽기**: `(항목 크기(KB)를 4KB 단위로 올림) x (초당 읽기 요청 수) / 2`

**예시 문제**

1. **쓰기(WCU)**: 초당 10개의 항목을 쓰며, 평균 항목 크기가 2KB일 경우 필요한 WCU는?
    
    - `(2KB / 1KB) x 10 = 20 WCU`
        
2. **쓰기(WCU)**: 초당 6개의 항목을 쓰며, 평균 항목 크기가 4.5KB일 경우 필요한 WCU는? (DynamoDB는 KB 단위를 항상 올림 처리합니다.)
    
    - `(5KB / 1KB) x 6 = 30 WCU`
        
3. **읽기(RCU)**: 초당 10개의 강력한 일관된 읽기를 수행하며, 평균 항목 크기가 6KB일 경우 필요한 RCU는? (DynamoDB는 4KB 단위를 항상 올림 처리합니다.)
    
    - `(8KB / 4KB) x 10 = 20 RCU`
        

### **읽기 모드: Strong vs. Eventually Consistent**

![[Pasted image 20250902223948.png]]

- **최종적 일관성 읽기(Eventually Consistent Reads)**: 기본값. 읽기 요청 시 데이터가 업데이트되었는지 즉시 보장하지 않습니다. 대부분의 경우 100밀리초 이내에 데이터가 동기화됩니다. 비용이 절반으로 저렴합니다.
    
- **강력한 일관성 읽기(Strongly Consistent Reads)**: 최신 데이터를 보장합니다. 쓰기 직후 읽기 요청 시 정확한 데이터를 반환합니다. 최종적 일관성 읽기보다 두 배 비쌉니다.
    

### **스로틀링 및 핫 파티션**

프로비저닝된 RCU/WCU를 초과하면 **`ProvisionedThroughputExceededException`** 예외가 발생합니다. 이는 보통 다음과 같은 경우에 발생합니다.

- **핫 키(Hot Key)**: 특정 파티션 키에 대한 읽기/쓰기 요청이 집중될 때.
    
- **대용량 항목**: 단일 항목의 크기가 매우 커서 많은 RCU/WCU를 소비할 때.
    

**해결 방안**

- **지수 백오프(Exponential Backoff)**: 예외 발생 시 재시도 간격을 점진적으로 늘리는 전략으로, DynamoDB SDK에 내장되어 있습니다.
    
- **파티션 키 재설계**: 데이터를 균일하게 분산시키기 위해 카디널리티가 높은 파티션 키를 선택해야 합니다.
    
- **DAX(DynamoDB Accelerator)**: 읽기 작업이 많은 경우 DAX 캐시를 사용하여 성능을 향상시킬 수 있습니다.
    

---

## 3. 온디맨드 모드 (On-demand Mode) 상세 분석

온디맨드 모드는 DynamoDB가 자동으로 용량을 관리하므로, 사용자가 RCU/WCU를 설정할 필요가 없습니다.

- **무제한 확장**: 워크로드 증가에 따라 읽기/쓰기 용량을 자동으로 확장합니다. 스로틀링이 발생하지 않습니다.
    
- **종량제(Pay-as-you-go)**: 사용한 실제 읽기 요청 단위(RRU)와 쓰기 요청 단위(WRU)에 대해서만 비용을 지불합니다.
    
- **비용**: 프로비저닝 모드보다 약 **2.5배** 비쌉니다.
    

**적합한 사용 사례**:

- 트래픽 예측이 어려운 신규 애플리케이션
    
- 간헐적으로 트래픽이 폭발적으로 증가하는 워크로드
    

**결론적으로, 안정적이고 예측 가능한 트래픽 패턴에는 프로비저닝 모드를, 트래픽 변동이 심한 경우에는 온디맨드 모드를 사용하는 것이 좋습니다. 💡**