
DynamoDB를 효율적으로 관리하려면 테이블의 데이터를 효과적으로 정리하고 복사하는 방법을 알아야 합니다. 특히 대용량 테이블을 다룰 때, 잘못된 방법을 사용하면 불필요한 비용이 발생하거나 작업 시간이 오래 걸릴 수 있습니다. 이번 아티클에서는 DynamoDB 테이블의 데이터를 삭제하고, 다른 테이블로 복사하는 가장 효율적인 방법에 대해 알아보겠습니다.

---

![[Pasted image 20250906195633.png]]

## 🗑️ 테이블 데이터 정리(Cleanup) 방법

DynamoDB 테이블의 모든 데이터를 삭제하는 두 가지 주요 방법이 있습니다.

### **방법 1: 스캔(Scan) 후 개별 삭제**

가장 직관적인 방법이지만, **매우 비효율적**입니다.

1. **`Scan` 작업 수행**: 테이블의 모든 아이템을 읽기 위해 `Scan` 작업을 수행합니다. 이 과정에서 많은 **RCU(읽기 용량 단위)**를 소모합니다.
    
2. **`DeleteItem` 작업 수행**: 읽어온 각 아이템에 대해 `DeleteItem` 작업을 호출하여 하나씩 삭제합니다. 이 과정에서 많은 **WCU(쓰기 용량 단위)**가 소모됩니다.
    

- **단점**:
    
    - **고비용**: `Scan`과 `DeleteItem` 작업이 모두 용량 단위를 소모하므로 비용이 많이 듭니다.
        
    - **느린 속도**: 대용량 테이블의 경우, 모든 아이템을 스캔하고 삭제하는 데 매우 오랜 시간이 걸립니다.

### **방법 2: 테이블 삭제 후 재생성 (가장 효율적)**

테이블의 모든 데이터를 가장 빠르고 저렴하게 삭제하는 방법입니다.

1. **테이블 삭제(Drop)**: 기존 DynamoDB 테이블을 완전히 삭제합니다. 이 작업은 즉시 이루어지며, 데이터를 개별적으로 삭제하는 과정이 필요 없으므로 비용이 발생하지 않습니다.
    
2. **테이블 재생성(Recreate)**: 삭제했던 테이블과 동일한 이름과 설정을 사용하여 테이블을 새로 생성합니다.
    

- **장점**:
    
    - **고속**: 전체 테이블을 삭제하는 작업은 매우 빠릅니다.
        
    - **저비용**: `Scan` 및 `DeleteItem`과 같은 용량 소모 작업이 필요 없어 비용이 거의 들지 않습니다.
        
- **주의**: 이 방법을 사용하기 전에 테이블의 스키마, 인덱스, 프로비저닝 설정 등을 정확히 파악하고 있어야 합니다.
    

---

## 🔄 테이블 데이터 복사(Copy) 방법

한 DynamoDB 테이블의 데이터를 다른 테이블(같은 계정 또는 다른 계정)로 복사하는 세 가지 방법이 있습니다.

### **1. AWS Backup 서비스 활용**

AWS Backup은 다양한 AWS 서비스의 데이터를 백업하고 복원하는 중앙 집중식 서비스입니다.

- **동작 방식**:
    
    1. 원본 테이블을 백업합니다.
        
    2. AWS Backup 콘솔에서 백업을 선택하고, 이를 다른 테이블로 복원합니다.
        
- **장점**:
    
    - **간편성**: 몇 번의 클릭만으로 손쉽게 백업 및 복원 작업을 수행할 수 있습니다.
        
    - **다계정 복원**: 다른 AWS 계정으로도 데이터를 복원할 수 있어 유연성이 높습니다.
        
- **단점**: 복원된 테이블의 설정(예: 용량 모드)을 수동으로 조정해야 할 수 있습니다.
    

### **2. AWS Glue (ETL 서비스) 활용**

AWS Glue는 서버리스 ETL(Extract, Transform, Load) 서비스로, 데이터를 한 곳에서 다른 곳으로 이동하고 변환하는 데 사용됩니다.

- **동작 방식**:
    
    1. AWS Glue에서 ETL 작업을 생성합니다.
        
    2. Glue는 자동으로 스크립트를 생성하여 원본 DynamoDB 테이블에서 데이터를 읽고(Extract), 필요에 따라 변환(Transform)한 후, 대상 DynamoDB 테이블에 기록(Load)합니다.
        
- **장점**:
    
    - **자동화**: 데이터 이동 및 변환 과정을 스크립트로 자동화할 수 있습니다.
        
    - **유연성**: 데이터를 다른 종류의 데이터베이스나 S3와 같은 다른 스토리지로도 이동할 수 있습니다.
        

### **3. 직접 코드 작성 (API 호출)**

AWS SDK를 사용하여 직접 코드를 작성해 데이터를 복사하는 방법입니다.

- **동작 방식**:
    
    1. `Scan` 또는 `Query` 작업을 사용하여 원본 테이블의 데이터를 읽어옵니다.
        
    2. 읽어온 데이터를 대상 테이블에 `PutItem` 또는 `BatchWriteItem` API를 사용하여 기록합니다.
        
- **장점**:
    
    - **최대 제어**: 복사 과정에 대한 모든 세부 사항을 직접 제어할 수 있습니다.
        
- **단점**:
    
    - **복잡성**: 직접 코드를 작성하고 예외 처리를 해야 하므로 개발 노력이 많이 듭니다.
        
    - **비효율성**: 대용량 데이터의 경우 `Scan` 및 `PutItem` 작업을 개별적으로 수행하면 비용이 많이 들고 성능이 저하될 수 있습니다. `BatchWriteItem`을 사용하면 효율성을 높일 수 있습니다.
        

## 📝 요약

|작업|권장 방법|비권장 방법|
|---|---|---|
|**테이블 데이터 삭제**|**테이블 삭제 후 재생성** (가장 빠르고 저렴)|`Scan` 후 개별 `DeleteItem` (느리고 비쌈)|
|**테이블 데이터 복사**|**AWS Backup** 또는 **AWS Glue** (AWS 관리형 서비스 활용)|직접 코드 작성 (복잡하고 비효율적일 수 있음)|