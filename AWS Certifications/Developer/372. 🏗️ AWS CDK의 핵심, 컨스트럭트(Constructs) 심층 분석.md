
이번 아티클에서는 **AWS CDK(Cloud Development Kit)**의 가장 중요한 구성 요소인 **컨스트럭트(Constructs)**에 대해 자세히 알아보겠습니다. 컨스트럭트는 단일 AWS 리소스부터 여러 리소스를 조합한 복합적인 패턴까지, 모든 클라우드 인프라를 정의하는 기본 빌딩 블록입니다.

---

### 1️⃣ 컨스트럭트란 무엇인가?

**컨스트럭트**는 AWS CDK가 최종 CloudFormation 스택을 생성하는 데 필요한 모든 것을 캡슐화한 코드 컴포넌트입니다.

- **단일 리소스:** S3 버킷, DynamoDB 테이블과 같은 개별 AWS 리소스가 될 수 있습니다.
    
- **복합 리소스:** SQS 큐와 Lambda 함수, 또는 ALB와 Fargate 서비스의 조합과 같이 여러 관련 리소스로 구성된 패턴이 될 수 있습니다.
    

CDK는 이 컨스트럭트들을 모아 **컨스트럭트 라이브러리**를 구성하고, 개발자는 이를 활용하여 인프라를 효율적으로 구축할 수 있습니다.

---

### 2️⃣ CDK 컨스트럭트의 세 가지 계층 (L1, L2, L3)

CDK 컨스트럭트는 추상화 수준에 따라 세 가지 계층으로 나뉩니다. 각 계층은 사용 편의성과 제어 수준에서 차이를 보입니다.

#### **레벨 1 (L1) 컨스트럭트: CFN 리소스**

- **특징:** CloudFormation 리소스 사양과 1대1로 매핑됩니다.
    
- **이름:** `Cfn` 접두사로 시작합니다. 예: `s3.CfnBucket`, `sqs.CfnQueue`.
    
- **역할:** CloudFormation YAML/JSON 파일을 코드로 변환하는 가장 기본적인 방법입니다. CloudFormation의 모든 속성을 개별적으로 구성해야 합니다.
    
- **활용:** 기존 CloudFormation 템플릿을 CDK 코드로 마이그레이션할 때 유용합니다. 모든 세부 속성을 직접 제어해야 할 때 사용합니다.

```JavaScript
// L1 컨스트럭트 예시: S3 버킷
const bucket = new s3.CfnBucket(this, 'MyBucket', {
  bucketName: 'my-cfn-bucket-name',
  accessControl: 'PublicRead',
  # CloudFormation의 모든 속성을 직접 지정
});
```

---

#### **레벨 2 (L2) 컨스트럭트: 상위 레벨 리소스**

- **특징:** L1보다 높은 추상화 수준을 제공하며, **의도(intent)** 기반의 API를 갖습니다.
    
- **이름:** `Cfn` 접두사 없이 리소스 이름만으로 구성됩니다. 예: `s3.Bucket`, `sqs.Queue`.
    
- **역할:** 자주 사용되는 속성에 대해 편리한 기본값과 상용구 코드를 제공하여 개발자의 작업을 간소화합니다. 또한, 리소스에 특정 동작을 추가하는 **편의 메서드(helper methods)**를 제공합니다.
    
- **활용:** 대부분의 CDK 개발에 권장되는 계층입니다. 최소한의 속성만으로 리소스를 생성하고, `addLifecycleRule()`과 같은 메서드로 복잡한 기능을 쉽게 추가할 수 있습니다.


```JavaScript
// L2 컨스트럭트 예시: S3 버킷
const bucket = new s3.Bucket(this, 'MyBucket', {
  versioned: true,
  encryption: s3.BucketEncryption.KMS, // 기본 암호화 설정
});

// 편의 메서드 활용
bucket.addLifecycleRule({
  transitions: [{
    storageClass: s3.StorageClass.GLACIER,
    transitionAfter: cdk.Duration.days(30)
  }]
});
```

---

#### **레벨 3 (L3) 컨스트럭트: 패턴(Patterns)**

- **특징:** 여러 개의 L1 및 L2 컨스트럭트를 조합하여 **공통적인 아키텍처 패턴**을 구현합니다.
    
- **이름:** 특정 패턴을 나타내는 이름으로 구성됩니다. 예: `aws-apigateway.LambdaRestApi`, `aws-ecs-patterns.ApplicationLoadBalancedFargateService`.
    
- **역할:** 복잡한 인프라를 최소한의 코드로 구축할 수 있게 해줍니다. 예를 들어, API Gateway, Lambda, IAM 역할을 단일 컨스트럭트 내에서 함께 정의합니다.
    
- **활용:** 일반적인 아키텍처 패턴을 빠르게 구현할 때 사용합니다. Raw CloudFormation으로 작성하기 매우 복잡한 ALB-Fargate 서비스 같은 인프라를 단 몇 줄의 코드로 완성할 수 있습니다.

```JavaScript
// L3 컨스트럭트 예시: API Gateway + Lambda 통합
new apigw.LambdaRestApi(this, 'MyApi', {
  handler: myLambdaFunction,
  proxy: true,
});

// L3 컨스트럭트 예시: ALB + Fargate 서비스
new ecsPatterns.ApplicationLoadBalancedFargateService(this, 'MyFargateService', {
  cluster: myCluster,
  taskImageOptions: {
    image: ecs.ContainerImage.fromRegistry("my-image")
  },
  publicLoadBalancer: true,
});
```

### 3️⃣ 컨스트럭트 허브(Construct Hub)

**컨스트럭트 허브**는 AWS 공식 컨스트럭트뿐만 아니라, 써드파티 및 오픈 소스 커뮤니티에서 개발된 다양한 컨스트럭트를 제공하는 플랫폼입니다. 이를 통해 개발자는 특정 요구사항에 맞는 컨스트럭트를 찾아 CDK 스택을 더욱 빠르고 효율적으로 구축할 수 있습니다.

결론적으로, CDK의 컨스트럭트 계층 구조는 개발자에게 유연성을 제공합니다. 세부적인 제어가 필요할 때는 L1을, 대부분의 경우 L2를, 그리고 복합적인 패턴을 빠르게 구현할 때는 L3를 선택할 수 있습니다.