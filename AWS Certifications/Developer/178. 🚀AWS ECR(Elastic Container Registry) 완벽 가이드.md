
##  ECR(Elastic Container Registry)이란 무엇인가요?

![[Pasted image 20250811220946.png]]

**Amazon ECR(Elastic Container Registry)**은 AWS에서 제공하는 **완전 관리형 Docker 컨테이너 레지스트리 서비스**입니다. Docker Hub와 같은 공개 레지스트리 대신, AWS 환경에서 컨테이너 이미지를 안전하고 효율적으로 저장, 관리, 배포할 수 있도록 도와줍니다.

ECR은 다음과 같은 특징을 가지고 있습니다.

- **높은 가용성 및 확장성**: S3(Simple Storage Service)를 백엔드로 사용하여 이미지를 저장하므로, 높은 내구성과 확장성을 자랑합니다.
    
- **완전 관리형 서비스**: 사용자가 직접 서버를 관리할 필요 없이, AWS가 모든 인프라를 관리해줍니다.
    
- **보안 강화**: IAM(Identity and Access Management)을 통해 이미지에 대한 접근 권한을 세밀하게 제어할 수 있습니다.
    
- **VPC 통합**: VPC(Virtual Private Cloud) 내에서 프라이빗 엔드포인트를 통해 ECR에 접근할 수 있어, 네트워크 트래픽을 안전하게 유지할 수 있습니다.
    

---

## 📚 ECR의 주요 기능

ECR은 단순히 이미지를 저장하는 것 이상의 다양한 기능을 제공합니다.

### 1. 이미지 취약점 스캔 (Vulnerability Scanning)

ECR은 푸시된 이미지에 대해 CVE(Common Vulnerabilities and Exposures)를 기반으로 **자동 취약점 스캔**을 수행합니다. 이를 통해 보안 위험을 사전에 파악하고 조치할 수 있습니다.

### 2. 버전 관리 및 태그 (Versioning & Tagging)

이미지에 **태그**를 사용하여 버전을 관리할 수 있습니다. 예를 들어 `my-app:v1.0` 또는 `my-app:latest`와 같이 태그를 지정하여 특정 버전의 이미지를 식별하고 관리할 수 있습니다.

### 3. 이미지 라이프사이클 관리 (Image Lifecycle Management)

**라이프사이클 정책**을 설정하여 사용하지 않는 오래된 이미지를 자동으로 삭제할 수 있습니다. 이는 스토리지 비용을 절감하고, 불필요한 이미지로 인해 레지스트리가 복잡해지는 것을 방지하는 데 도움이 됩니다.

---

## 🤝 ECR과 AWS 서비스의 연동

ECR은 다른 AWS 서비스와 긴밀하게 통합되어 있습니다. 특히 **Amazon ECS(Elastic Container Service)**와 함께 사용하면 강력한 시너지를 발휘합니다.

|서비스|연동 방식|
|---|---|
|**Amazon ECS**|ECS 클러스터의 EC2 인스턴스 또는 Fargate가 ECR에 저장된 이미지를 쉽게 풀(Pull)하여 컨테이너를 실행할 수 있습니다.|
|**Amazon EKS**|EKS(Elastic Kubernetes Service) 클러스터에서 ECR을 프라이빗 컨테이너 레지스트리로 사용합니다.|
|**AWS Lambda**|Lambda 함수의 컨테이너 이미지를 ECR에 저장하고, Lambda가 해당 이미지를 사용하여 함수를 실행할 수 있습니다.|

### ECR & IAM 연동 예시

ECS 클러스터의 EC2 인스턴스가 ECR에서 이미지를 가져오기 위해서는 IAM 역할이 필요합니다. 아래는 **IAM 역할**에 할당되는 정책의 예시입니다.


```JSON
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "ecr:GetAuthorizationToken",
        "ecr:BatchCheckLayerAvailability",
        "ecr:GetDownloadUrlForLayer",
        "ecr:BatchGetImage"
      ],
      "Resource": "*"
    }
  ]
}
```

이 정책은 EC2 인스턴스가 ECR에 로그인하고, 이미지를 다운로드하는 데 필요한 권한을 부여합니다. 만약 이미지 Pull 시 권한 오류가 발생한다면, 이 IAM 정책을 확인해봐야 합니다.

---

## 🌐 프라이빗 vs. 퍼블릭 ECR

ECR은 이미지를 저장하는 방식에 따라 **프라이빗(Private)**과 **퍼블릭(Public)** 레지스트리로 나눌 수 있습니다.

- **프라이빗(Private) ECR**: 기본적으로 사용되는 형태로, AWS 계정 내에서만 접근 가능한 비공개 레포지토리입니다. IAM을 통해 접근 권한을 엄격하게 제어할 수 있습니다.
    
- **퍼블릭(Public) ECR**: Docker Hub처럼 누구나 접근할 수 있는 공개 레포지토리입니다. `ECR Public Gallery`에 이미지를 게시하여 다른 사용자와 공유할 수 있습니다.
    

대부분의 경우, 회사 내부 또는 개인 프로젝트의 이미지를 저장할 때는 **프라이빗 ECR**을 사용하며, 공개적으로 공유할 필요가 있는 경우에만 퍼블릭 ECR을 고려하게 됩니다.

---

## 💡 결론

AWS 환경에서 Docker 이미지를 관리해야 한다면, **Amazon ECR**은 가장 적합하고 안전한 선택입니다. ECR의 다양한 기능을 활용하여 컨테이너 워크플로우를 더욱 효율적이고 안전하게 구축할 수 있습니다.

더 궁금한 점이 있다면 언제든지 물어보세요!