
AWS Auto Scaling Group(ASG)은 변화하는 트래픽 부하에 따라 EC2 인스턴스 수를 자동으로 조절하여 애플리케이션의 성능과 가용성을 유지하고 비용을 최적화합니다. 이를 가능하게 하는 것이 바로 다양한 **스케일링 정책(Scaling Policies)**입니다.

---

### 1. ASG 스케일링 정책의 종류

ASG는 여러 가지 스케일링 정책을 제공하여 다양한 사용 패턴에 유연하게 대응할 수 있도록 합니다.

#### 1.1. 다이내믹 스케일링 (Dynamic Scaling)

가장 일반적인 스케일링 방식으로, 실시간 지표 변화에 따라 인스턴스를 자동으로 조절합니다.

##### 1.1.1. 대상 추적 스케일링 (Target Tracking Scaling)

- **설정 간편성:** 설정이 매우 간단합니다.
    
- **작동 방식:** 특정 지표(예: CPU 사용률, RequestCountPerTarget)와 목표 값(예: 40%, 1,000 요청)을 정의하면, ASG가 자동으로 인스턴스를 추가하거나 제거하여 해당 지표가 목표 값 주변으로 유지되도록 합니다.
    
- **장점:** 복잡한 규칙 설정 없이 목표 값만 지정하면 ASG가 알아서 스케일링 로직을 처리해 줍니다.

##### 1.1.2. 단순 스케일링 또는 스텝 스케일링 (Simple / Step Scaling)

- **작동 방식:** CloudWatch 알람을 기반으로 스케일링을 트리거합니다.
    
    - **단순 스케일링:** 알람이 트리거되면 정해진 수의 인스턴스를 추가하거나 제거합니다. 한 번 스케일링이 시작되면 쿨다운(Cooldown) 기간 동안 다른 스케일링 활동은 무시됩니다.
        
    - **스텝 스케일링:** 알람의 임계값에 따라 다른 수의 인스턴스를 추가하거나 제거할 수 있도록 유연성을 제공합니다. (예: CPU 70% 초과 시 1대 추가, 90% 초과 시 2대 추가)
        
- **장점:** 특정 조건에 따라 세밀하게 스케일링 단위를 제어할 수 있습니다.

#### 1.2. 예약 스케일링 (Scheduled Scaling)

- **작동 방식:** 특정 시간에 ASG의 최소, 희망, 최대 용량을 미리 정의된 값으로 변경합니다.
    
- **사용 사례:** 트래픽 패턴이 예측 가능한 경우에 유용합니다.
    - **예시:** "매주 금요일 오후 5시에 사용자 수가 급증하므로, ASG의 최소 용량을 10으로 늘려라."와 같이 설정할 수 있습니다.
        
- **장점:** 피크 시간 전에 미리 인스턴스를 준비하여 트래픽 급증에 대비할 수 있습니다.

#### 1.3. 예측 스케일링 (Predictive Scaling)

![[Pasted image 20250706130757.png]]

- **작동 방식:** 과거 트래픽 데이터를 분석하여 미래의 로드를 예측하고, 이에 따라 선제적으로 스케일링 액션을 예약합니다.
    
- **장점:** 주기적인 패턴(예: 일별, 주별)이 있는 워크로드에 매우 효과적입니다. 실시간 지표 반응보다 미리 인스턴스를 준비할 수 있어 지연 시간을 줄이고 성능을 최적화할 수 있습니다.
    
- **고려 사항:** 충분한 과거 데이터가 있어야 정확한 예측이 가능합니다.

---

### 2. 스케일링에 적합한 지표 (Metrics)

어떤 지표를 기반으로 스케일링할지는 애플리케이션의 특성과 병목 현상에 따라 달라집니다. 다음은 일반적으로 사용되는 몇 가지 지표입니다.

| 지표 (Metric)                          | 설명                                                              | 사용 사례                                         |
| ------------------------------------ | --------------------------------------------------------------- | --------------------------------------------- |
| **CPU Utilization (CPU 사용률)**        | 인스턴스의 평균 CPU 사용률입니다. 요청 처리에 계산 자원이 많이 필요한 애플리케이션에 적합합니다.        | 대부분의 웹 서버 및 애플리케이션 서버.                        |
| **RequestCountPerTarget (대상별 요청 수)** | 로드 밸런서의 대상 그룹에 연결된 각 인스턴스가 처리하는 초당 평균 요청 수입니다.                  | 인스턴스당 처리할 수 있는 최적의 요청 수가 명확한 경우.              |
| **Network In/Out (네트워크 입/출력)**       | 인스턴스 간 또는 인스턴스와 외부 네트워크 간의 데이터 전송량입니다.                          | 업로드/다운로드, 스트리밍 등 네트워크 대역폭이 병목이 될 수 있는 애플리케이션. |
| **Custom Metrics (사용자 지정 지표)**       | CloudWatch로 푸시되는 애플리케이션 관련 사용자 지정 지표입니다 (예: 큐 길이, 데이터베이스 연결 수). | 특정 애플리케이션의 내부 로드 지표를 기반으로 스케일링하고 싶을 때.        |

---

### 3. 스케일링 쿨다운 (Scaling Cooldown)

![[Pasted image 20250706130909.png]]

ASG 스케일링 정책의 중요한 개념 중 하나는 **쿨다운 기간(Cooldown Period)**입니다.

- **목적:** 스케일링 활동(인스턴스 추가 또는 제거)이 발생한 후, 지표가 안정화되고 새로 시작된 인스턴스가 트래픽을 처리하기 시작할 시간을 확보하기 위함입니다.
    
- **작동 방식:**
    1. 스케일링 활동이 발생하면 ASG는 **쿨다운 기간**에 진입합니다.
    2. 이 기간 동안 ASG는 추가적인 스케일링 요청(알람 트리거 등)을 **무시**합니다.
    3. 쿨다운 기간이 끝나야 다음 스케일링 활동이 트리거될 수 있습니다.
- **기본값:** **300초 (5분)**
    
- **최적화 팁:**
    - **"Ready-to-use AMI" 사용:** 미리 설정된 AMI를 사용하면 인스턴스 부팅 및 애플리케이션 초기화 시간을 단축할 수 있습니다. 이는 인스턴스가 더 빨리 "서비스 준비(serving)" 상태가 되어 쿨다운 기간을 단축할 수 있게 해줍니다.
        
    - **쿨다운 기간 조정:** 인스턴스 초기화 시간이 짧다면 쿨다운 기간을 줄여 ASG의 반응성을 높일 수 있습니다. 반대로, 초기화 시간이 길다면 쿨다운 기간을 늘려 불필요한 스케일링을 방지해야 합니다.

#### 3.1. 쿨다운 기간 동안의 ASG 동작 흐름

코드 스니펫

```
graph TD
    A[스케일링 활동 발생<br>(인스턴스 추가/제거)] --> B{쿨다운 기간 중인가?};
    B -- Yes --> C[추가 스케일링 무시];
    B -- No --> D[스케일링 활동 실행];
    D --> E[쿨다운 기간 시작];
    E -- 쿨다운 기간 만료 --> F[다음 스케일링 대기];
```

---

### 4. CloudWatch 상세 모니터링 활성화

ASG의 스케일링 정책이 효과적으로 작동하려면 정확하고 시기적절한 지표 데이터가 필수적입니다.

- **상세 모니터링(Detailed Monitoring) 활성화:** ASG를 사용하는 EC2 인스턴스에 **CloudWatch 상세 모니터링**을 활성화하는 것이 좋습니다.
    
- **지표 수집 주기:** 기본 모니터링은 5분마다 지표를 수집하지만, 상세 모니터링은 **1분마다** 지표를 수집하여 ASG가 더 빠르게 변화에 반응할 수 있도록 합니다.

---
### 결론

ASG의 다양한 스케일링 정책은 예측 가능한 패턴, 실시간 지표 변화, 그리고 과거 데이터 분석을 기반으로 애플리케이션의 요구사항에 맞춰 인스턴스 수를 자동으로 조절합니다. 적절한 지표를 선택하고 쿨다운 기간을 이해하며 상세 모니터링을 활성화하는 것은 ASG를 효과적으로 사용하여 고가용성, 탄력성 및 비용 효율적인 AWS 아키텍처를 구축하는 데 매우 중요합니다.
