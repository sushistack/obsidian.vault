
Amazon RDS Proxy는 Amazon RDS 및 Aurora 데이터베이스를 위한 완전 관리형 데이터베이스 프록시입니다. 이 서비스는 애플리케이션과 데이터베이스 간의 연결을 효율적으로 관리하고, 고가용성을 높이며, 보안을 강화하는 데 중요한 역할을 합니다.

---

### 1. RDS Proxy란 무엇인가요? 🤔

일반적으로 애플리케이션은 RDS 데이터베이스 인스턴스에 직접 연결합니다. 하지만 <mark class="hltr-red">RDS Proxy를 사용하면, 애플리케이션은 데이터베이스 대신 프록시에 연결하고, 프록시가 데이터베이스와의 실제 연결</mark>을 관리합니다.

#### 1.1 연결 풀링(Connection Pooling) 및 공유

- **문제점**: 많은 수의 애플리케이션 연결은 데이터베이스 리소스(CPU, RAM)에 과부하를 주어 비효율성을 초래하고 연결 타임아웃을 유발할 수 있습니다. 특히 서버리스 환경(예: AWS Lambda)에서 <mark class="hltr-red">갑자기 많은 함수가 생성되고 사라지면서 데이터베이스 연결을 열고 닫는 상황은 심각한 문제를 야기</mark>합니다.
    
- **해결책**: RDS Proxy는 애플리케이션의 다수 연결을 풀링(pooling)하고 이를 데이터베이스 인스턴스에 대한 적은 수의 연결로 공유합니다.
    
    - 애플리케이션은 프록시에 연결합니다.
    - 프록시는 이러한 연결을 모아 데이터베이스 인스턴스에 대한 효율적인 연결 풀을 유지합니다.

**💡 핵심**: 이를 통해 데이터베이스 리소스에 대한 **스트레스를 줄이고**, **효율성을 향상**시키며, **열려있는 연결 수와 타임아웃을 최소화**할 수 있습니다.

### 2. RDS Proxy의 주요 이점 ✨

RDS Proxy는 연결 관리 외에도 다양한 핵심 이점을 제공합니다.

![[Pasted image 20250708232246.png]]

#### 2.1 서버리스 및 고가용성

- **완전 서버리스(Fully Serverless)**: RDS Proxy는 AWS가 완전 관리하므로, 사용자가 용량을 관리할 필요가 없습니다. 자동으로 스케일링됩니다.
- **고가용성(Highly Available)**: 여러 가용 영역(Multi-AZ)에 걸쳐 배포되어 프록시 자체의 가용성이 높습니다.

#### 2.2 장애 조치 시간 단축 ⏱️

- **문제점**: RDS 데이터베이스(특히 Multi-AZ)에서 프라이머리 인스턴스에 장애가 발생하여 스탠바이 인스턴스로 장애 조치될 때, 애플리케이션은 새로운 인스턴스에 다시 연결해야 합니다. 이 과정에서 애플리케이션 단의 재연결 로직과 지연이 발생할 수 있습니다.
    
- **해결책**: RDS Proxy는 데이터베이스 인스턴스의 <mark class="hltr-red">장애 조치 시간을 최대 66%까지 단축</mark>시킵니다.
    - 애플리케이션은 장애 조치 사실을 인지할 필요 없이 계속해서 RDS Proxy에 연결됩니다.
    - RDS Proxy가 내부적으로 데이터베이스의 장애 조치를 처리하고, <mark class="hltr-red">새로운 프라이머리 인스턴스로 연결을 자동으로 전환</mark>합니다.
- **적용**: RDS 및 Aurora (MySQL, PostgreSQL 호환) 모두에 해당됩니다.

#### 2.3 IAM 인증 강제 (Enforce IAM Authentication) 🔐

- **보안 강화**: RDS Proxy를 사용하면 데이터베이스에 대한 **IAM 인증을 강제**할 수 있습니다. 즉, 사용자 이름과 암호 대신 IAM 자격 증명(IAM 사용자/역할)을 통해서만 데이터베이스에 연결하도록 설정할 수 있습니다.

- **자격 증명 관리**: 데이터베이스 연결 자격 증명을 **AWS Secrets Manager**에 안전하게 저장하고 관리할 수 있어 보안성이 더욱 향상됩니다.

- **활용 사례**: 애플리케이션(예: EC2 인스턴스)에 IAM 역할을 부여하여, 코드에 하드코딩된 암호 없이 IAM 역할을 통해 데이터베이스에 인증하도록 할 수 있습니다.

#### 2.4 네트워크 접근 제어

- **VPC 내부 접근 전용**: RDS Proxy는 **절대 퍼블릭하게 접근할 수 없습니다.** 즉, 인터넷을 통해 RDS Proxy에 직접 연결할 수 없습니다. 이는 보안 강화를 위한 중요한 설계입니다.

- **VPC 내부 접근**: RDS Proxy는 사용자 VPC 내부에서만 접근 가능하며, 이를 통해 네트워크 보안이 향상됩니다.

#### 2.5 지원 데이터베이스 엔진

RDS Proxy는 다음 데이터베이스 엔진을 지원합니다:

- **MySQL**
- **PostgreSQL**
- **MariaDB**
- **Microsoft SQL Server**
- **Aurora (MySQL 및 PostgreSQL 호환)**

#### 2.6 코드 변경 불필요

- RDS Proxy를 도입할 때 애플리케이션 코드 변경이 거의 또는 전혀 필요 없습니다. 데이터베이스 엔드포인트를 RDS Proxy의 엔드포인트로만 변경하면 됩니다.

### 3. AWS Lambda 함수와의 시너지 효과 💡

RDS Proxy는 AWS Lambda 함수와 같은 동적으로 확장되는 애플리케이션에 특히 유용합니다.

- **Lambda의 특성**: Lambda 함수는 필요에 따라 빠르게 생성되고 사라지는(스케일 인/아웃) 특성이 있습니다. 이는 데이터베이스에 대해 <mark class="hltr-red">수 많은 새 연결을 열고 닫는 동작을 유발하여 데이터베이스에 과도한 부담</mark>을 줄 수 있습니다.

- **RDS Proxy의 역할**: Lambda 함수가 RDS Proxy에 연결하도록 설정하면, 프록시가 Lambda 함수들의 동적인 연결 요청을 처리하고, 이를 <mark class="hltr-red">데이터베이스에 대한 소수의 영구적인 연결 풀로 전환</mark>합니다.

- **결과**: 데이터베이스의 과부하를 방지하고, 연결 누수 및 타임아웃 문제를 해결하여 <mark class="hltr-red">서버리스 아키텍처의 효율성과 안정성을 극대화</mark>합니다.

### 4. RDS Proxy 요약표 ✅

| 기능            | 설명                                                                              |
| ------------- | ------------------------------------------------------------------------------- |
| **연결 풀링**     | 애플리케이션 연결을 풀링하여 데이터베이스 부하를 줄이고 효율성을 높임.                                         |
| **장애 조치 단축**  | RDS/Aurora 데이터베이스 장애 조치 시간을 최대 66% 단축. 애플리케이션은 장애 조치를 인지할 필요 없음.                |
| **IAM 인증 강제** | 데이터베이스에 대한 IAM 인증을 강제할 수 있으며, 자격 증명은 Secrets Manager에 안전하게 저장.                  |
| **서버리스**      | 완전 관리형 서비스로, 용량 관리 불필요. 자동으로 스케일링됨.                                             |
| **고가용성**      | 여러 AZ에 걸쳐 배포되어 고가용성을 제공.                                                        |
| **보안 강화**     | VPC 내부에서만 접근 가능하며, 퍼블릭 접근 불가.                                                   |
| **코드 변경 없음**  | 애플리케이션 코드 수정 없이 데이터베이스 엔드포인트만 프록시로 변경.                                          |
| **Lambda 통합** | Lambda와 같은 동적 확장 서비스의 데이터베이스 연결 과부하 문제를 해결하는 데 최적화됨.                            |
| **지원 엔진**     | MySQL, PostgreSQL, MariaDB, Microsoft SQL Server, Aurora (MySQL/PostgreSQL 호환). |

---

RDS Proxy는 데이터베이스 연결 관리의 복잡성을 줄이고, 애플리케이션의 안정성과 보안을 향상시키는 데 필수적인 서비스입니다. 특히 대규모 또는 서버리스 환경에서 데이터베이스를 운영할 때 강력한 이점을 제공합니다.
