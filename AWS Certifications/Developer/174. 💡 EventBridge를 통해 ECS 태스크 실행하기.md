
Amazon ECS는 다양한 방법으로 태스크를 실행할 수 있습니다. 그중 하나는 **Amazon EventBridge**를 사용하여 특정 이벤트에 반응해 ECS 태스크를 자동으로 실행하는 것입니다. 이 아키텍처는 이벤트 기반 워크플로우를 구축하는 데 매우 효과적입니다.

---

### S3 이벤트로 ECS 태스크 실행하기 🚀

![[Pasted image 20250810193939.png]]

![[Pasted image 20250810194429.png]]

![[Pasted image 20250810194520.png]]

![[Pasted image 20250810194535.png]]

이벤트 기반 아키텍처의 한 예시로, 사용자가 S3 버킷에 파일을 업로드할 때 ECS 태스크를 실행하는 시나리오를 살펴보겠습니다.

1. **S3 이벤트 생성:** 사용자가 S3 버킷에 객체를 업로드하면, 이 활동이 S3 이벤트가 됩니다.
    
2. **EventBridge 통합:** S3 버킷의 속성에서 **EventBridge 통합**을 활성화하면, 모든 S3 이벤트가 Amazon EventBridge로 전송됩니다.
    
3. **EventBridge 규칙:** EventBridge에서 S3 이벤트(예: `ObjectCreated`)를 감지하는 규칙을 생성합니다.
    
4. **ECS 태스크 실행:** EventBridge 규칙의 **대상(Target)**을 ECS 태스크로 설정합니다. 이 규칙은 S3 이벤트가 발생할 때마다 ECS 태스크를 실행하도록 트리거합니다.
    
5. **Fargate 사용:** ECS 클러스터가 **Fargate** 시작 유형을 사용하도록 설정하면, AWS가 태스크에 필요한 컴퓨팅 리소스를 자동으로 프로비저닝하여 관리의 복잡성을 줄입니다.
    
6. **태스크 역할(Task Role):** 실행된 ECS 태스크는 **ECS 태스크 역할**을 상속받습니다. 이 역할은 태스크가 S3 버킷에서 객체를 가져오고, 필요한 데이터 처리 작업을 수행하는 데 필요한 권한을 부여합니다.
    

---

### ECS 태스크 실행 역할 🔐

EventBridge 규칙이 ECS 태스크를 실행하기 위해서는 IAM 역할이 필요합니다.

- **ECS 실행 역할(Execution Role):** ECS 서비스가 ECR에서 Docker 이미지를 가져오고, CloudWatch Logs에 로그를 쓰는 등의 작업을 수행하는 데 필요한 권한을 제공합니다.
    
- **ECS 태스크 역할(Task Role):** 실행된 **컨테이너**가 AWS API를 호출하는 데 필요한 권한을 제공합니다. 예를 들어, S3에 접근하여 파일을 처리하는 권한은 이 역할에 부여해야 합니다.
    

이 아키텍처를 통해 S3에 업로드된 객체를 즉시 처리하는 자동화된 데이터 파이프라인을 구축할 수 있습니다.
