
## CloudWatch Alarms란?

**AWS CloudWatch Alarms**는 CloudWatch에 존재하는 지표(Metric)를 모니터링하고, 지표의 상태가 사용자가 정의한 임계값(threshold)을 벗어날 경우 알림을 보내거나 특정 액션을 수행하는 기능입니다. 이를 통해 시스템 성능 저하나 오류 발생 시 신속하게 대응할 수 있습니다.

### 알람의 세 가지 상태

CloudWatch Alarms는 다음 세 가지 상태 중 하나를 가집니다.

|상태명|의미|
|---|---|
|**OK**|지표가 정상 범위 내에 있으며, 알람이 트리거되지 않았음|
|**INSUFFICIENT_DATA**|지표 데이터가 충분하지 않아 알람 상태를 결정할 수 없음|
|**ALARM**|지표가 임계값을 벗어나 알람이 트리거되었음|

## 🎯 알람의 주요 대상(Target)

![[Pasted image 20250824205205.png]]

알람이 트리거될 때 수행할 수 있는 세 가지 주요 액션이 있습니다.

1. **EC2 인스턴스 액션**: 인스턴스를 중지(`stop`), 종료(`terminate`), 재부팅(`reboot`), 또는 복구(`recover`)하는 등의 작업을 자동으로 수행할 수 있습니다.

2. **오토 스케일링 액션**: 오토 스케일링 그룹의 규모를 확장(`scale out`)하거나 축소(`scale in`)하여 트래픽 변화에 유연하게 대응합니다.

3. **SNS 알림**: **Amazon SNS(Simple Notification Service)**를 통해 이메일, SMS 등으로 알림을 보냅니다. SNS 토픽에 **Lambda 함수**를 연동하여 알람이 발생했을 때 원하는 커스텀 스크립트를 실행하는 등 더 복잡한 자동화도 가능합니다.

---

## 🔗 복합 경보(Composite Alarms)

![[Pasted image 20250824205220.png]]

CloudWatch Alarms는 기본적으로 단일 지표를 모니터링하지만, 여러 지표를 결합하여 더 복잡한 조건을 설정하고 싶을 때 **복합 경보(Composite Alarms)**를 사용합니다.

- **기능**: 여러 하위 알람의 상태를 모니터링하여 최종적인 하나의 알람을 생성합니다.
- **논리 연산자**: `AND` 또는 `OR` 조건을 사용하여 여러 하위 알람의 상태를 조합할 수 있습니다.
- **활용**: 복합 경보는 불필요한 알람 발생(Alarm Noise)을 줄이는 데 유용합니다. 예를 들어, `CPU 사용률`과 `네트워크 I/O`라는 두 가지 지표를 각각 모니터링하는 알람을 만든 뒤, **`CPU 사용률이 높고 AND 네트워크 I/O가 높을 때만`** 알람을 울리도록 설정할 수 있습니다.

위 다이어그램처럼 `알람 A(CPU)`와 `알람 B(IOPS)`의 상태를 결합하여 `복합 알람(Composite Alarm)`을 만들고, 이 복합 알람이 `ALARM` 상태가 되면 최종적인 알림을 보낼 수 있습니다.

---

## 🚑 EC2 인스턴스 복구

![[Pasted image 20250824205234.png]]

CloudWatch Alarms는 EC2 인스턴스의 상태를 모니터링하여 자동으로 복구하는 데 사용될 수 있습니다.

- **시스템 상태 확인(System Status Check)**: EC2 인스턴스가 실행되는 기반 하드웨어의 상태를 점검합니다.
- **인스턴스 상태 확인(Instance Status Check)**: EC2 인스턴스 가상 머신의 상태를 점검합니다.

이러한 상태 확인 지표를 기반으로 알람을 설정하고, **복구(recovery)** 액션을 구성할 수 있습니다. 복구 액션이 실행되면 AWS가 자동으로 인스턴스를 다른 호스트로 이동시킵니다. 이 과정에서 **프라이빗/퍼블릭/탄력적 IP, 인스턴스 메타데이터** 등은 그대로 유지되므로, 인스턴스가 복구된 후에도 동일한 환경에서 계속 작동합니다.

## 📌 기타 CloudWatch Alarms 기능

![[Pasted image 20250824205247.png]]

- **로그 지표 필터 연동**: CloudWatch Logs의 지표 필터로 생성된 지표에 알람을 설정하여, 로그 내의 특정 이벤트(예: `ERROR`라는 단어가 1분 안에 5회 이상 발생)를 감지하고 알림을 보낼 수 있습니다.

- **`set-alarm-state` CLI**: 실제 환경에서 알람을 테스트하기 위해 CLI를 사용하여 수동으로 알람의 상태를 `ALARM`으로 변경할 수 있습니다. 이 기능은 알람이 트리거되었을 때 설정된 액션(예: SNS 알림 발송)이 제대로 작동하는지 검증할 때 유용합니다.