
## 🧐 SQS FIFO 큐란?

**FIFO(First-In-First-Out) 큐**는 메시지가 전송된 순서대로 컨슈머에게 전달되는 SQS 큐의 한 유형입니다. 일반 SQS 큐(Standard Queue)와 달리 메시지 순서를 엄격하게 보장하므로, 메시지의 순서가 중요한 금융 거래, 주문 처리, 로그 처리와 같은 애플리케이션에 적합합니다.

### 핵심 기능

![[Pasted image 20250817204557.png]]

- **순서 보장:** 메시지 그룹 내에서 메시지가 전송된 순서대로 정확히 처리됩니다.
- **정확히 한 번 처리(Exactly-Once Processing):** 중복 메시지가 큐 수준에서 자동으로 제거됩니다.

### 처리량 제한

순서 보장 메커니즘으로 인해 Standard 큐보다 처리량에 제한이 있습니다.

- **배치 처리 미사용 시:** 초당 300개 메시지 전송
- **배치 처리 사용 시:** 초당 3,000개 메시지 전송

---

## 🔑 FIFO 큐의 필수 파라미터


FIFO 큐를 사용할 때는 메시지 순서와 중복 제거를 위해 두 가지 중요한 파라미터를 사용해야 합니다.

### 1. **메시지 그룹 ID (`MessageGroupId`)**

- **용도:** 동일한 `MessageGroupId`를 가진 메시지들은 **순서가 보장**됩니다. 서로 다른 `MessageGroupId`를 가진 메시지들은 독립적으로 처리되어 병렬 처리가 가능하므로, 전체 처리량을 높일 수 있습니다.
- **필수 여부:** FIFO 큐로 메시지를 보낼 때 **반드시 포함해야 하는 필수 파라미터**입니다.

### 2. **메시지 중복 제거 ID (`MessageDeduplicationId`)**

- **용도:** 메시지 중복 전송 시, 5분 내에 동일한 `MessageDeduplicationId`가 감지되면 중복된 메시지를 자동으로 제거합니다. 이를 통해 **`정확히 한 번(Exactly-once)`** 메시지가 처리되도록 보장합니다.

- **`Content-based deduplication`:** 이 기능을 큐 설정에서 활성화하면, 메시지 본문의 해시 값을 기반으로 자동으로 중복 제거 ID가 생성됩니다. 따라서 별도의 `MessageDeduplicationId`를 지정하지 않아도 됩니다.

---

## 🧪 FIFO 큐 실습 가이드

### 1. FIFO 큐 생성

- **큐 이름:** `DemoQueue.fifo`. FIFO 큐는 **`.fifo` 접미사**를 필수로 사용해야 합니다.

- **설정:** 큐를 생성할 때 **`Content-based deduplication`**을 활성화하여 메시지 본문을 기준으로 자동으로 중복 제거가 이루어지도록 설정합니다.

### 2. 메시지 전송

- **`DemoQueue.fifo`**에서 `Send and receive messages`를 클릭합니다.

- 다음과 같이 순서대로 네 개의 메시지를 보냅니다. **모두 동일한 `Message group ID`(`demo`)**를 사용합니다.

|메시지|본문|메시지 그룹 ID|중복 제거 ID|
|---|---|---|---|
|**메시지 1**|`Hello World 1`|`demo`|`ID 1`|
|**메시지 2**|`Hello World 2`|`demo`|`ID 2`|
|**메시지 3**|`Hello World 3`|`demo`|`ID 3`|
|**메시지 4**|`Hello World 4`|`demo`|`ID 4`|

### 3. 메시지 순서 확인

- 4개의 메시지를 모두 보낸 후 **`Poll for messages`**를 클릭합니다.

- 수신된 메시지들을 확인하면, `Hello World 1`부터 `Hello World 4`까지 **메시지를 보낸 순서와 동일하게** 수신된 것을 확인할 수 있습니다.

이 실습은 FIFO 큐가 메시지 그룹 ID를 기반으로 엄격한 순서 보장을 제공하며, 중복 제거 기능을 통해 안정적인 메시지 처리 환경을 구축하는 데 필수적임을 보여줍니다.