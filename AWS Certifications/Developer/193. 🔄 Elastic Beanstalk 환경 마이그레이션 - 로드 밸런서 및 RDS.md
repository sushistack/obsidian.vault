
Elastic Beanstalk 환경의 일부 구성 요소는 생성 후 변경할 수 없기 때문에, 설정을 변경하려면 마이그레이션이 필요합니다. 시험에서는 주로 **로드 밸런서 유형 변경**과 **RDS 분리(Decoupling)**에 대한 시나리오가 출제됩니다.

---

### 🌐 로드 밸런서 유형 마이그레이션

![[Pasted image 20250812211923.png]]

Elastic Beanstalk 환경은 생성된 로드 밸런서 유형(예: Classic, Application, Network)을 변경할 수 없습니다. 유형을 변경하려면 새로운 환경을 생성해야 합니다.

1. **새 환경 생성**: 기존 환경과 동일한 설정을 사용하되, **변경하려는 로드 밸런서 유형**을 선택하여 새 Elastic Beanstalk 환경을 생성합니다. 이 과정에서는 기존 환경을 복제하는 **`클론(Clone)`** 기능을 사용할 수 없습니다. `클론` 기능은 기존 로드 밸런서 유형을 그대로 복사하기 때문입니다.
2. **애플리케이션 배포**: 새로운 환경에 애플리케이션 코드를 배포합니다.
3. **트래픽 전환**: **Cname Swap** 또는 **Route 53**을 사용하여 기존 환경의 트래픽을 새 환경으로 전환합니다.

---

### 💾 RDS 분리(Decoupling) 마이그레이션

![[Pasted image 20250812211957.png]]

Elastic Beanstalk 환경에 포함된 RDS 데이터베이스는 환경의 수명주기(Lifecycle)에 종속됩니다. 즉, 환경을 삭제하면 데이터베이스도 함께 삭제됩니다. 프로덕션 환경에서는 RDS를 Elastic Beanstalk와 분리하여 독립적으로 관리하는 것이 일반적입니다.

다음은 RDS를 Elastic Beanstalk 환경에서 분리하는 마이그레이션 절차입니다.

1. **데이터베이스 보호 및 백업**:
    - **RDS 콘솔**에서 데이터베이스의 **삭제 방지(Deletion Protection)**를 활성화합니다.
    - 만약의 사태를 대비하여 데이터베이스의 **스냅샷(Snapshot)**을 생성합니다.

2. **새 환경 생성**: RDS 데이터베이스를 **포함하지 않는** 새로운 Elastic Beanstalk 환경을 생성합니다.
    
3. **애플리케이션 설정**: 새로운 환경의 애플리케이션이 기존 RDS 데이터베이스에 연결하도록 **환경 변수** 등을 설정합니다.
    
4. **트래픽 전환**: Cname Swap 또는 Route 53을 통해 기존 환경의 트래픽을 새 환경으로 전환합니다.
    
5. **기존 환경 삭제**: 기존 Elastic Beanstalk 환경을 종료합니다. 이때, **삭제 방지**가 활성화되어 있어 RDS 데이터베이스는 삭제되지 않고 유지됩니다.
    
6. **CloudFormation 스택 정리**: 환경 삭제 과정에서 RDS가 남게 되므로, Elastic Beanstalk는 내부적으로 사용했던 **CloudFormation 스택**을 완전히 삭제하지 못하고 `DELETE_FAILED` 상태에 머무르게 됩니다. 따라서 **CloudFormation 콘솔**에서 해당 스택을 수동으로 삭제해야 합니다.