
μ΄λ² κ°€μ΄λ“μ—μ„λ” Amazon API Gatewayμ **μ‘λ‹µ μΊμ‹±(Response Caching)** κΈ°λ¥μ„ μƒμ„Έν λ‹¤λ£¨κ² μµλ‹λ‹¤. μΊμ‹±μ€ λ°±μ—”λ“ νΈμ¶ νμλ¥Ό μ¤„μ—¬ APIμ μ„±λ¥μ„ ν–¥μƒμ‹ν‚¤κ³  λΉ„μ©μ„ μ κ°ν•λ” λ° λ§¤μ° μ¤‘μ”ν• κΈ°μ μ…λ‹λ‹¤.

---

## π€ 1λ‹¨κ³„: API Gateway μΊμ‹±μ κΈ°λ³Έ μ›λ¦¬

API Gatewayμ— μΊμ‹±μ„ ν™μ„±ν™”ν•λ©΄, ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ΄ λ“¤μ–΄μ™”μ„ λ• λ°±μ—”λ“λ΅ μ§μ ‘ μ „λ‹¬λμ§€ μ•κ³ , API Gatewayκ°€ λ¨Όμ € μΊμ‹λ¥Ό ν™•μΈν•©λ‹λ‹¤.

- **μΊμ‹ ννΈ(Cache Hit)**: μ”μ²­μ— λ€ν• μ‘λ‹µμ΄ μΊμ‹μ— μ΄λ―Έ μ €μ¥λμ–΄ μμΌλ©΄, API Gatewayλ” λ°±μ—”λ“ νΈμ¶ μ—†μ΄ μ¦‰μ‹ μΊμ‹λ κ²°κ³Όλ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² λ°ν™ν•©λ‹λ‹¤.
    
- **μΊμ‹ λ―Έμ¤(Cache Miss)**: μΊμ‹μ— κ²°κ³Όκ°€ μ—†μΌλ©΄, API Gatewayλ” λ°±μ—”λ“(μ: Lambda ν•¨μ)λ¥Ό νΈμ¶ν•μ—¬ μ‘λ‹µμ„ λ°›μ€ ν›„, ν•΄λ‹Ή μ‘λ‹µμ„ μΊμ‹μ— μ €μ¥ν•κ³  ν΄λΌμ΄μ–ΈνΈμ—κ² λ°ν™ν•©λ‹λ‹¤.
    

### π’° μ£Όμ” μ„¤μ • λ° νΉμ§•

- **μΊμ‹ μ©λ‰**: 0.5GBλ¶€ν„° 237GBκΉμ§€ λ‹¤μ–‘ν• μ©λ‰μ„ μ„ νƒν•  μ μμµλ‹λ‹¤. μΊμ‹±μ€ λΉ„μ©μ΄ λ°μƒν•λ―€λ΅ ν”„λ΅λ•μ… ν™κ²½μ—μ„ μ‹ μ¤‘ν•κ² μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤.
    
- **TTL(Time to Live)**: μΊμ‹λ μ‘λ‹µμ΄ μ ν¨ν• μ‹κ°„μ…λ‹λ‹¤. κΈ°λ³Έκ°’μ€ 300μ΄(5λ¶„)μ΄λ©°, μµμ† 0μ΄(μΊμ‹± λΉ„ν™μ„±ν™”)μ—μ„ μµλ€ 3,600μ΄(1μ‹κ°„)κΉμ§€ μ„¤μ • κ°€λ¥ν•©λ‹λ‹¤.
    
- **μΊμ‹ μ•”νΈν™”**: μΊμ‹ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•μ—¬ λ³΄μ•μ„ κ°•ν™”ν•  μ μμµλ‹λ‹¤.
    
- **μ„¤μ • λ²”μ„**: μΊμ‹±μ€ **μ¤ν…μ΄μ§€(Stage)** λ λ²¨μ—μ„ ν™μ„±ν™”λλ©°, νΉμ • **λ©”μ„λ“(Method)**μ— λ€ν•΄μ„λ” κ°λ³„μ μΌλ΅ μ„¤μ •μ„ μ¬μ •μ(override)ν•  μ μμµλ‹λ‹¤.
    

---

## π›΅οΈ 2λ‹¨κ³„: μΊμ‹ λ¬΄ν¨ν™”(Invalidation) λ°©λ²•

μΊμ‹λ λ°μ΄ν„°λ” TTLμ΄ λ§λ£λ  λ•κΉμ§€ μ ν¨ν•μ§€λ§, ν•„μ”μ— λ”°λΌ μ¦‰μ‹ λ¬΄ν¨ν™”(μ‚­μ )ν•΄μ•Ό ν•  μλ„ μμµλ‹λ‹¤.

### π“ μΊμ‹ λ¬΄ν¨ν™” λ°©λ²•

1. **μλ™ λ¬΄ν¨ν™”**: API Gateway μ½μ†”μ **μ¤ν…μ΄μ§€** μ„¤μ •μ—μ„ μ „μ²΄ μΊμ‹λ¥Ό μ¦‰μ‹ λ¬΄ν¨ν™”ν•  μ μμµλ‹λ‹¤.
    
2. **ν΄λΌμ΄μ–ΈνΈ λ¬΄ν¨ν™”**: ν΄λΌμ΄μ–ΈνΈκ°€ μ”μ²­ ν—¤λ”μ— `Cache-Control: max-age=0`μ„ ν¬ν•¨ν•μ—¬ APIλ¥Ό νΈμ¶ν•λ©΄, μΊμ‹λ¥Ό λ¬΄ν¨ν™”ν•  μ μμµλ‹λ‹¤.
    
    - **λ³΄μ•**: ν΄λΌμ΄μ–ΈνΈμ λ¬΄λ¶„λ³„ν• μΊμ‹ λ¬΄ν¨ν™”λ¥Ό λ°©μ§€ν•κΈ° μ„ν•΄ **IAM κ¶ν•**μ„ λ¶€μ—¬ν•μ—¬ νΉμ • ν΄λΌμ΄μ–ΈνΈλ§ λ¬΄ν¨ν™” μ”μ²­μ„ λ³΄λ‚Ό μ μλ„λ΅ μ ν•ν•΄μ•Ό ν•©λ‹λ‹¤.
        

### β οΈ λ³΄μ• μ„¤μ •

- **λ¬΄ν¨ν™” κ¶ν• μ„¤μ •**: API Gatewayλ” `Cache-Control` ν—¤λ”λ¥Ό ν†µν•΄ λ¬΄ν¨ν™” μ”μ²­μ΄ λ“¤μ–΄μ™”μ„ λ•, μ΄λ¥Ό λ¬΄μ‹ν•κ±°λ‚, **403 Forbidden** μ¤λ¥λ¥Ό λ°ν™ν•κ±°λ‚, λλ” κ²½κ³  λ΅κ·Έλ§ λ‚¨κΈ°λ„λ΅ μ„¤μ •ν•  μ μμµλ‹λ‹¤.
    
- **κ¶ν• μλ” μ‚¬μ©μλ§ ν—μ©**: λ¬΄ν¨ν™” μ”μ²­ μ‹ **IAM κ¶ν• λ¶€μ—¬(Require authorization)**λ¥Ό μ„¤μ •ν•λ©΄, μΉμΈλ μ‚¬μ©μλ§ μΊμ‹λ¥Ό λ¬΄ν¨ν™”ν•  μ μμ–΄ μ„λΉ„μ¤ μ•μ •μ„±μ„ λ†’μΌ μ μμµλ‹λ‹¤.
    

---

## π–¥οΈ 3λ‹¨κ³„: μΊμ‹± μ„¤μ • μ‹¤μµ

μ‹¤μ λ΅ API Gateway μ½μ†”μ—μ„ μΊμ‹±μ„ ν™μ„±ν™”ν•λ” κ³Όμ •μ„ μ‚΄ν΄λ³΄κ² μµλ‹λ‹¤.

1. **μ¤ν…μ΄μ§€ μ„¤μ •μΌλ΅ μ΄λ™**: μΊμ‹±μ„ μ μ©ν•  APIμ **μ¤ν…μ΄μ§€** (μ: `prod` μ¤ν…μ΄μ§€)λ¥Ό μ„ νƒν•©λ‹λ‹¤.
    
2. **μΊμ‹ μ„¤μ • νΈμ§‘**: **μ„Έλ¶€ μ •λ³΄ νΈμ§‘(Edit)**μ„ ν΄λ¦­ν• ν›„, `μΊμ‹ μ„¤μ •(Cache Settings)` μ„Ήμ…μΌλ΅ μ΄λ™ν•©λ‹λ‹¤.
    
3. **μΊμ‹ ν™μ„±ν™”**: `API μΊμ‹ ν™μ„±ν™”(Enable API Cache)`λ¥Ό μ²΄ν¬ν•©λ‹λ‹¤.
    
4. **μ„Έλ¶€ μ„¤μ •**:
    
    - **μΊμ‹ μ©λ‰**: μ›ν•λ” μ©λ‰(μ: 0.5GB)μ„ μ„ νƒν•©λ‹λ‹¤.
        
    - **TTL**: μΊμ‹ μ ν¨ μ‹κ°„(μ: 300μ΄)μ„ μ„¤μ •ν•©λ‹λ‹¤.
        
    - **μ•”νΈν™”**: `μΊμ‹ λ°μ΄ν„° μ•”νΈν™”(Encrypt cache data)`λ¥Ό μ„ νƒν•©λ‹λ‹¤.
        
    - **λ¬΄ν¨ν™” κ¶ν•**: `Cache-Control ν—¤λ”κ°€ μμ„ λ• μΊμ‹ λ¬΄ν¨ν™”μ— μΈμ¦ μ”κµ¬(Require authorization for cache invalidation)`λ¥Ό ν™μ„±ν™”ν•κ³ , λ¬΄λ‹¨ μ”μ²­ μ‹ λ™μ‘(μ: `ν—¤λ” λ¬΄μ‹(Ignore header)`)μ„ μ„¤μ •ν•©λ‹λ‹¤.
        
5. **μ €μ¥**: μ„¤μ •μ„ μ €μ¥ν•λ©΄ ν•΄λ‹Ή μ¤ν…μ΄μ§€μ λ¨λ“  APIμ— μΊμ‹±μ΄ μ μ©λ©λ‹λ‹¤.
    

**μ°Έκ³ **: μΊμ‹±μ€ μ‹¤μ  μ”μ²­μ΄ λ°λ³µμ μΌλ΅ λ°μƒν•΄μ•Ό ν¨κ³Όλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. λ™μΌν• URLκ³Ό νλΌλ―Έν„°λ΅ μ—¬λ¬ λ² νΈμ¶ν•  κ²½μ°, μ²« νΈμ¶ μ΄ν›„λ¶€ν„°λ” Lambda ν•¨μκ°€ μ•„λ‹ μΊμ‹μ—μ„ μ‘λ‹µμ΄ λ°ν™λμ–΄ μ‘λ‹µ μ†λ„κ°€ ν„μ €ν λΉ¨λΌμ§€λ” κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

μΊμ‹±μ€ API μ„±λ¥κ³Ό λΉ„μ© μµμ ν™”λ¥Ό μ„ν• ν•„μμ μΈ κΈ°λ¥μΌλ΅, νΉν μ”μ²­μ΄ λ§μ€ ν”„λ΅λ•μ… ν™κ²½μ—μ„ ν° κ°€μΉλ¥Ό λ°νν•©λ‹λ‹¤.