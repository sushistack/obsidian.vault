## 지표 필터(Metric Filter)란?

**CloudWatch Logs 지표 필터**는 로그 데이터 내에서 특정 패턴을 식별하고, 이를 CloudWatch의 **지표(Metric)**로 변환하는 강력한 기능입니다. 이 기능을 사용하면 로그에 기반한 지표를 생성하여, 시스템의 중요한 이벤트를 실시간으로 추적하고 알림을 받을 수 있습니다.

### 주요 개념:

- **필터 표현식(Filter Expression)**: 로그에서 찾고자 하는 특정 패턴이나 키워드입니다. 예를 들어, `ERROR`라는 단어의 발생 횟수를 세거나 특정 IP 주소를 검색할 수 있습니다.

- **지표(Metric)**: 로그 필터 표현식과 일치하는 이벤트가 발생할 때마다 증가하는 수치형 데이터입니다.


## 📝 지표 필터의 동작 방식

지표 필터는 생성 시점부터 새로운 로그 이벤트에만 적용됩니다. 즉, 필터 생성 이전에 이미 CloudWatch Logs에 저장된 데이터에는 **소급 적용되지 않습니다.** 필터와 일치하는 이벤트가 발생할 때마다, CloudWatch는 지정된 지표의 값을 업데이트합니다.

|기능|설명|
|---|---|
|**로그 패턴 감지**|로그 내의 특정 키워드나 패턴을 찾아냅니다. (예: "error" 또는 "404")|
|**지표 생성**|감지된 패턴을 기반으로 수치형 지표를 생성하고 증가시킵니다.|
|**알람 연동**|생성된 지표의 값이 특정 임계값을 초과하면 **CloudWatch 경보**를 트리거하여 알림을 보냅니다.|

## 💡 활용 예시: 오류 카운팅 및 알림 설정

![[Pasted image 20250824205015.png]]

CloudWatch Logs 지표 필터의 가장 일반적인 사용 사례는 애플리케이션 로그에 발생하는 오류의 수를 세는 것입니다.

1. **로그 수집**: EC2 인스턴스에 CloudWatch 에이전트를 설치하여 애플리케이션 로그를 CloudWatch Logs로 스트리밍합니다.

2. **지표 필터 생성**: 로그 그룹에 `ERROR`라는 키워드를 찾는 지표 필터를 생성하고, 이름은 `ErrorCount`로 지정합니다. 이 필터가 일치할 때마다 지표 값을 `1`씩 증가시킵니다.

3. **경보(Alarm) 설정**: `ErrorCount` 지표가 1분 이내에 5회 이상 발생하면 **CloudWatch 경보**를 트리거하도록 설정합니다.

4. **알림 발송**: 경보가 울리면 **SNS(Simple Notification Service)** 토픽을 통해 개발자나 운영자에게 이메일 또는 다른 방식으로 즉시 알림을 보낼 수 있습니다.


이와 같은 방식으로, 로그를 직접 모니터링하지 않고도 시스템의 비정상적인 동작을 신속하게 파악하고 대응할 수 있습니다. 지표 필터는 지표에 최대 3개의 **차원(dimension)**을 추가할 수 있어, 더욱 세분화된 분석과 모니터링이 가능합니다.