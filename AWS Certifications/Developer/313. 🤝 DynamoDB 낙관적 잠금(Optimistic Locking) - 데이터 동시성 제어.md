
Amazon DynamoDBμ—μ„ μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈκ°€ λ™μΌν• λ°μ΄ν„°λ¥Ό λ™μ‹μ— μμ •ν•λ ¤κ³  ν•  λ• λ°μƒν•λ” λ¬Έμ λ¥Ό ν•΄κ²°ν•λ” ν¨κ³Όμ μΈ λ°©λ²• μ¤‘ ν•λ‚λ” <mark style="background: #FF5582A6;">λ‚™κ΄€μ  μ κΈ(Optimistic Locking)</mark>μ…λ‹λ‹¤. μ΄λ” DynamoDBμ **μ΅°κ±΄λ¶€ μ“°κΈ°(Conditional Writes)** κΈ°λ¥μ„ ν™μ©ν•μ—¬ λ°μ΄ν„° λ¬΄κ²°μ„±μ„ ν™•λ³΄ν•λ” μ¤‘μ”ν• κ°λ…μ…λ‹λ‹¤.

---

## β“ λ‚™κ΄€μ  μ κΈμ΄λ€ λ¬΄μ—‡μΈκ°€?

λ‚™κ΄€μ  μ κΈμ€ "λ°μ΄ν„° μ¶©λμ΄ μμ£Ό λ°μƒν•μ§€ μ•μ„ κ²ƒ"μ΄λΌκ³  κ°€μ •ν•κ³ , λ°μ΄ν„°λ¥Ό μ½μ„ λ• λ³„λ„μ μ κΈ μ²λ¦¬λ¥Ό ν•μ§€ μ•μµλ‹λ‹¤. λ€μ‹ , λ°μ΄ν„°λ¥Ό μμ •ν•  λ•μ—λ§ μ¶©λ μ—¬λ¶€λ¥Ό κ²€μ‚¬ν•©λ‹λ‹¤. μ΄ λ°©λ²•μ€ λ°μ΄ν„°κ°€ μμ£Ό μ¶©λν•μ§€ μ•λ” ν™κ²½μ—μ„ λ†’μ€ μ„±λ¥μ„ μ μ§€ν•λ©΄μ„ λ°μ΄ν„°μ μΌκ΄€μ„±μ„ λ³΄μ¥ν•  μ μμµλ‹λ‹¤.

### **β¨ μ‘λ™ μ›λ¦¬**

λ‚™κ΄€μ  μ κΈμ€ μΌλ°μ μΌλ΅ ν•­λ©μ— **λ²„μ „ λ²νΈ** μ—­ν• μ„ ν•λ” μ†μ„±μ„ μ¶”κ°€ν•μ—¬ κµ¬ν„ν•©λ‹λ‹¤.

1. **λ°μ΄ν„° μ½κΈ°**: ν΄λΌμ΄μ–ΈνΈκ°€ νΉμ • ν•­λ©μ„ μ½μ„ λ•, ν•­λ©μ λ°μ΄ν„°μ™€ ν•¨κ» λ²„μ „ λ²νΈλ¥Ό ν•¨κ» κ°€μ Έμµλ‹λ‹¤.
    
2. **λ°μ΄ν„° μμ •**: ν΄λΌμ΄μ–ΈνΈλ” λ΅μ»¬μ—μ„ λ°μ΄ν„°λ¥Ό μμ •ν•©λ‹λ‹¤.
    
3. **μ΅°κ±΄λ¶€ μ“°κΈ°**: μμ •ν• λ°μ΄ν„°λ¥Ό λ‹¤μ‹ DynamoDBμ— μ“°κΈ° μ‘μ—…(Update, Delete)μΌλ΅ λ³΄λ‚Ό λ•, **λ²„μ „ λ²νΈκ°€ λ³€κ²½λμ§€ μ•μ•λ”μ§€ ν™•μΈν•λ” μ΅°κ±΄μ‹**μ„ ν¬ν•¨ν•©λ‹λ‹¤.
    
4. **μ¶©λ μ²λ¦¬**:
    
    - **μ„±κ³µ**: λ§μ•½ DynamoDBμ— μ €μ¥λ ν•­λ©μ λ²„μ „ λ²νΈκ°€ ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ²„μ „ λ²νΈμ™€ μΌμΉν•λ©΄, DynamoDBλ” μ“°κΈ° μ‘μ—…μ„ μ„±κ³µμ μΌλ΅ μν–‰ν•κ³  **λ²„μ „ λ²νΈλ¥Ό 1 μ¦κ°€**μ‹ν‚µλ‹λ‹¤.
        
    - **μ‹¤ν¨**: λ§μ•½ DynamoDBμ— μ €μ¥λ λ²„μ „ λ²νΈκ°€ ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ²νΈμ™€ λ‹¤λ¥΄λ‹¤λ©΄ (μ΄λ―Έ λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈκ°€ λ°μ΄ν„°λ¥Ό μμ •ν• κ²½μ°), μ΅°κ±΄μ‹μ€ `false`κ°€ λμ–΄ μ“°κΈ° μ‘μ—…μ΄ **μ‹¤ν¨(κ±°λ¶€)**λ©λ‹λ‹¤.
        

μ΄λ¬ν• λ©”μ»¤λ‹μ¦μ„ ν†µν•΄ λ¨Όμ € λ°μ΄ν„°λ¥Ό μ—…λ°μ΄νΈν• ν΄λΌμ΄μ–ΈνΈμ λ³€κ²½ μ‚¬ν•­λ§ λ°μλκ³ , μ΄ν›„μ— λ“¤μ–΄μ¨ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ€ κ±°λ¶€λμ–΄ λ°μ΄ν„° μ¶©λμ„ λ°©μ§€ν•©λ‹λ‹¤.

---

## π“‹ λ‚™κ΄€μ  μ κΈ μ‹λ‚λ¦¬μ¤ μμ‹

λ‹¤μμ€ λ‘ λ…μ ν΄λΌμ΄μ–ΈνΈκ°€ λ™μ‹μ— κ°™μ€ ν•­λ©μ `first_name` μ†μ„±μ„ μμ •ν•λ ¤λ” μƒν™©μ— λ€ν• μμ‹μ…λ‹λ‹¤.

### **1. μ΄κΈ° μƒνƒ**

|μ†μ„±|κ°’|
|---|---|
|`user_id`|`123`|
|`first_name`|`Steve`|
|`version`|`1`|

![[Pasted image 20250903220934.png]]
### **2. ν΄λΌμ΄μ–ΈνΈ 1κ³Ό 2μ λ™μ‹ μ ‘κ·Ό**

- **ν΄λΌμ΄μ–ΈνΈ 1**: `first_name`μ„ 'John'μΌλ΅, `version`μ„ `2`λ΅ μ—…λ°μ΄νΈν•λ ¤ ν•©λ‹λ‹¤.
    
    - μ΅°κ±΄: `version = 1`

- **ν΄λΌμ΄μ–ΈνΈ 2**: `first_name`μ„ 'Lisa'λ΅, `version`μ„ `2`λ΅ μ—…λ°μ΄νΈν•λ ¤ ν•©λ‹λ‹¤.
    
    - μ΅°κ±΄: `version = 1`

### **3. DynamoDBμ μ²λ¦¬ κ³Όμ •**

1. **ν΄λΌμ΄μ–ΈνΈ 2μ μ”μ²­μ΄ λ¨Όμ € λ„μ°©**: DynamoDBλ” `version = 1` μ΅°κ±΄μ΄ μ°ΈμΈ κ²ƒμ„ ν™•μΈν•κ³ , `first_name`μ„ 'Lisa'λ΅ μ—…λ°μ΄νΈν• ν›„ `version`μ„ `2`λ΅ λ³€κ²½ν•©λ‹λ‹¤.
    
2. **ν΄λΌμ΄μ–ΈνΈ 1μ μ”μ²­μ΄ λ‚μ¤‘μ— λ„μ°©**: DynamoDBλ” `version = 1` μ΅°κ±΄μ΄ κ±°μ§“μΈ κ²ƒμ„ ν™•μΈν•©λ‹λ‹¤. ν„μ¬ ν•­λ©μ `version`μ€ `2`μ΄κΈ° λ•λ¬Έμ…λ‹λ‹¤.
    
3. **κ²°κ³Ό**: ν΄λΌμ΄μ–ΈνΈ 1μ μ”μ²­μ€ μ‹¤ν¨ν•κ³  `ConditionalCheckFailedException`κ³Ό κ°™μ€ μ¤λ¥ λ©”μ‹μ§€λ¥Ό λ°›κ² λ©λ‹λ‹¤.
    

### **π’΅ ν•΄κ²° λ°©μ•**

μ¤λ¥ λ©”μ‹μ§€λ¥Ό λ°›μ€ ν΄λΌμ΄μ–ΈνΈ 1μ€ λ‹¤μ‹ ν•­λ©μ„ `GetItem`μΌλ΅ μ½μ–΄ μµμ‹  λ²„μ „(`version = 2`, `first_name = Lisa`)μ„ κ°€μ Έμ¨ ν›„, ν•„μ”ν• κ²½μ° λ‹¤μ‹ μ—…λ°μ΄νΈ μ‘μ—…μ„ μ‹λ„ν•  μ μμµλ‹λ‹¤.

---

## π”‘ μ‹ν—μ„ μ„ν• ν•µμ‹¬ μ •λ¦¬

- **λ‚™κ΄€μ  μ κΈ(Optimistic Locking)**μ€ DynamoDBμ **μ΅°κ±΄λ¶€ μ“°κΈ°(Conditional Writes)**λ¥Ό μ‚¬μ©ν•μ—¬ κµ¬ν„λ©λ‹λ‹¤.
    
- ν•­λ©μ— **λ²„μ „ λ²νΈ** μ—­ν• μ„ ν•λ” μ†μ„±μ„ μ‚¬μ©ν•λ©°, μ΄ μ†μ„±μ€ μ—…λ°μ΄νΈ μ‹λ§λ‹¤ 1μ”© μ¦κ°€ν•©λ‹λ‹¤.
    
- **μ“°κΈ° μ‘μ—…**(`UpdateItem`, `DeleteItem` λ“±)μ„ λ³΄λ‚Ό λ•, `version = <μ΄μ „_λ²„μ „>`κ³Ό κ°™μ€ **μ΅°κ±΄μ‹**μ„ ν¬ν•¨μ‹μΌμ•Ό ν•©λ‹λ‹¤.
    
- λ™μ‹μ— μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈκ°€ λ°μ΄ν„°λ¥Ό μμ •ν•λ ¤ ν•  λ•, **κ°€μ¥ λ¨Όμ € μ„±κ³µν• μ”μ²­λ§ λ°μ**λλ©°, λ‚λ¨Έμ§€ μ”μ²­μ€ `ConditionalCheckFailedException` μ¤λ¥λ¥Ό λ°ν™ν•©λ‹λ‹¤.
    

λ‚™κ΄€μ  μ κΈμ€ λ°μ΄ν„° μ¶©λμ΄ μ μ€ μƒν™©μ—μ„ λ§¤μ° ν¨μ¨μ μ΄λ©°, μ• ν”λ¦¬μΌ€μ΄μ…μ λ°μ΄ν„° λ¬΄κ²°μ„±μ„ λ³΄μ¥ν•λ” ν•µμ‹¬μ μΈ μ „λµμ…λ‹λ‹¤.