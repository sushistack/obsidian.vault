이번 아티클에서는 **AWS SAM(Serverless Application Model) 정책 템플릿**에 대해 자세히 알아보겠습니다. SAM 정책 템플릿은 Lambda 함수에 필요한 AWS 권한을 쉽고 간결하게 부여할 수 있도록 도와주는 강력한 기능입니다. 이 기능은 AWS 시험에서도 출제될 수 있는 중요한 개념이므로, 그 특징과 주요 예시들을 함께 살펴보겠습니다.

---

### 1️⃣ SAM 정책 템플릿이란?

SAM 정책 템플릿은 Lambda 함수에 적용할 수 있는 **사전 정의된 권한 목록**입니다. 이를 사용하면 복잡한 AWS IAM 정책 JSON 문서를 직접 작성할 필요 없이, 간단한 템플릿 이름과 몇 가지 파라미터만으로 함수에 필요한 권한을 부여할 수 있습니다.

💡 **핵심 이점:**

- **간결성:** 복잡한 IAM 정책 문법 대신, 직관적인 템플릿 이름(`S3ReadPolicy`, `SQSPollerPolicy` 등)을 사용합니다.
    
- **가독성:** 템플릿 이름만으로 해당 Lambda 함수가 어떤 작업을 수행할 수 있는지 쉽게 파악할 수 있습니다.
    
- **안전성:** 최소 권한 원칙(Principle of Least Privilege)을 적용하여 필요한 권한만 부여하도록 유도합니다.

---

### 2️⃣ 주요 SAM 정책 템플릿 예시

SAM에서 제공하는 정책 템플릿은 매우 다양하지만, 그 이름만 봐도 어떤 기능을 하는지 유추하기 쉽습니다. 자주 사용되는 3가지 예시를 통해 그 동작 방식을 알아보겠습니다.

|템플릿 이름|설명|부여하는 권한|
|---|---|---|
|**`S3ReadPolicy`**|Amazon S3 버킷의 객체를 읽을 수 있는 권한을 부여합니다.|`s3:GetObject`, `s3:ListBucket` 등 S3 읽기 작업에 대한 권한|
|**`SQSPollerPolicy`**|Amazon SQS 대기열(queue)을 폴링(polling)할 수 있는 권한을 부여합니다.|`sqs:ReceiveMessage`, `sqs:DeleteMessage`, `sqs:GetQueueAttributes` 등 SQS 대기열 메시지를 읽고 삭제하는 권한|
|**`DynamoDBCrudPolicy`**|Amazon DynamoDB 테이블에 대한 CRUD(Create, Read, Update, Delete) 권한을 부여합니다.|`dynamodb:GetItem`, `dynamodb:PutItem`, `dynamodb:UpdateItem`, `dynamodb:DeleteItem` 등 DynamoDB 테이블의 데이터를 관리하는 권한|

---

### 3️⃣ `template.yaml`에 정책 템플릿 적용하기

SAM 템플릿에 정책 템플릿을 적용하는 방법은 매우 간단합니다. `AWS::Serverless::Function` 리소스의 `Properties` 아래에 `Policies` 속성을 추가하고, 원하는 정책 템플릿의 이름과 필요한 파라미터를 지정하면 됩니다.

#### **예시: SQS 대기열을 폴링하는 Lambda 함수**

SQS 대기열에서 메시지를 가져와 처리하는 Lambda 함수를 만들고 싶다고 가정해 보겠습니다. 이 함수는 SQS에 접근할 수 있는 권한이 필요합니다.

YAML

```
# SQS 대기열을 폴링하는 Lambda 함수의 template.yaml
MySQSPollerFunction:
  Type: AWS::Serverless::Function
  Properties:
    Handler: index.handler
    Runtime: python3.9
    CodeUri: my-sqs-poller/
    Policies:
      - SQSPollerPolicy:
          QueueName: MySQSQueue
```

- **`Policies`** 속성 아래에 `SQSPollerPolicy`를 지정합니다.
    
- `SQSPollerPolicy`의 파라미터인 `QueueName`에 접근하고자 하는 SQS 대기열의 이름을 입력합니다.
    

이렇게 설정하면 SAM CLI가 배포 과정에서 `MySQSPollerFunction`에 **`MySQSQueue`**에 대한 SQS 폴링 권한이 포함된 IAM 역할을 자동으로 생성하고 연결해줍니다. 개발자는 복잡한 IAM 문서를 작성할 필요 없이, 단 두 줄의 코드로 필요한 권한을 부여할 수 있습니다.

---

### 4️⃣ SAM 정책 템플릿의 이점

SAM 정책 템플릿의 가장 큰 장점은 **개발자가 IAM 역할 프로비저닝에 대해 덜 고민하게 만든다**는 것입니다. 이는 복잡한 권한 설정 오류를 줄이고 개발 속도를 높여줍니다.

SAM 정책 템플릿은 `template.yaml` 파일의 가독성을 높여, 팀원들이 템플릿만 보고도 어떤 함수가 어떤 AWS 리소스에 접근하는지 쉽게 이해할 수 있게 합니다. 이는 유지보수성과 협업 효율을 크게 향상시킵니다.

전체 SAM 정책 템플릿 목록은 [공식 문서](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-policy-templates.html)에서 확인할 수 있습니다. 직접 모든 목록을 외울 필요는 없지만, 한 번쯤 훑어보고 어떤 템플릿들이 있는지 파악해두면 시험이나 실무에서 유용하게 활용할 수 있습니다.