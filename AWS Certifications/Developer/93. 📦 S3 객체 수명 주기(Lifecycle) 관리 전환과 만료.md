
Amazon S3의 **수명 주기 규칙(Lifecycle rules)**은 객체를 자동으로 관리하고 비용을 최적화하는 강력한 기능입니다. 이 규칙을 통해 객체를 다른 스토리지 클래스로 **전환(transition)**하거나, 일정 기간 후 **만료(expire)**시켜 삭제할 수 있습니다.

---
### 1. 객체 수명 주기 규칙의 구성 요소

- **전환(Transition) 작업:** 객체를 비용이 더 저렴한 스토리지 클래스로 이동시킵니다.
    - **예시:** "생성 후 60일이 지나면 `S3 Standard-IA`로 이동"

- **만료(Expiration) 작업:** 객체를 지정된 기간이 지난 후 삭제합니다.
    - **예시:** "접근 로그 파일을 생성 후 365일이 지나면 삭제"

- **적용 범위:** 규칙은 버킷 전체에 적용되거나, 특정 **접두사(Prefix)**나 **객체 태그(Tags)**가 있는 객체에만 적용되도록 세분화할 수 있습니다.

### 2. 스토리지 클래스 전환 흐름

S3 스토리지 클래스 간의 전환에는 정해진 규칙이 있습니다.

![[Pasted image 20250803215956.png]]

- `S3 Standard` → `S3 Standard-IA` → `S3 Intelligent-Tiering` → `S3 One Zone-IA` → `Glacier Instant Retrieval` → `Glacier Flexible Retrieval` → `Glacier Deep Archive`
    

> **참고:** 이 표는 가능한 전환 경로의 일부를 보여주는 예시입니다. 모든 전환이 가능한 것은 아니며, 특정 클래스에서만 특정 클래스로 전환할 수 있습니다.

### 3. 시험 대비 시나리오 예시

#### 시나리오 1: 이미지 갤러리 관리

- **요구사항:**
    - 원본 이미지: 60일간 즉시 접근 가능해야 하며, 이후에는 접근 시간이 길어져도 상관없음.
    - 썸네일: 원본에서 쉽게 재생성 가능하며, 60일 후에는 삭제되어야 함.
        
- **해결 방안:**
    - **원본 이미지:** `S3 Standard` 클래스에 저장 후, 60일이 지나면 `Glacier Flexible Retrieval`로 전환하는 수명 주기 규칙을 설정합니다.
    - **썸네일:** 접두사를 사용하여 `S3 One Zone-IA` 클래스에 저장합니다. 60일이 지나면 만료되도록 수명 주기 규칙을 설정합니다.

#### 시나리오 2: 삭제된 객체 복구 및 아카이빙

- **요구사항:**
    - 삭제된 객체를 30일간 즉시 복구할 수 있어야 함.
    - 30일 이후에는 365일까지 48시간 내에 복구 가능해야 함.

- **해결 방안:**
    - S3 **버전 관리(Versioning)**를 활성화합니다. 이렇게 하면 객체가 삭제될 때 `삭제 마커(Delete Marker)`가 생성되어 이전 버전이 보존됩니다.

    - **비-현재 버전(Non-current version)**에 대해 수명 주기 규칙을 설정합니다.
        - 비-현재 버전이 된 후 30일이 지나면 `S3 Standard-IA`로 전환합니다.
        - 365일이 지나면 `Glacier Deep Archive`로 전환하여 장기 보관합니다.

### 4. S3 분석(Analytics)으로 최적화하기 📊

어떤 객체를 어떤 스토리지 클래스로 전환해야 할지 결정하기 어려운 경우, **S3 분석** 기능을 활용할 수 있습니다.

- **기능:** S3 버킷의 객체 접근 패턴을 분석하여, 어떤 데이터를 `S3 Standard-IA`로 전환하면 비용을 얼마나 절감할 수 있는지에 대한 권장 사항을 제공합니다.
- **결과:** 일일 `CSV` 보고서를 생성하여 객체의 접근 빈도, 저장 기간 등의 통계를 제공합니다.
- **적용:** S3 분석 보고서를 바탕으로 합리적인 수명 주기 규칙을 만들거나 개선할 수 있습니다.
- **한계:** `S3 One Zone-IA`나 `Glacier` 클래스에 대한 분석은 제공하지 않습니다.

이처럼 S3 수명 주기 규칙은 데이터를 효율적으로 관리하고 스토리지 비용을 크게 절감할 수 있는 핵심적인 AWS 기능입니다.