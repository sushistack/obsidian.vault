
### 1단계: S3 버킷 버전 관리 활성화하기

버킷에서 버전 관리를 사용하려면 먼저 해당 기능을 활성화해야 합니다.

1. S3 콘솔에서 버킷의 **속성(Properties)** 탭으로 이동합니다.
2. `버킷 버전 관리(Bucket versioning)` 섹션에서 `편집(Edit)`을 클릭합니다.
3. **활성화(Enable)**를 선택하고 변경 사항을 저장합니다.

이제 이 버킷에 있는 모든 객체의 변경 사항은 새로운 버전으로 저장됩니다.

---

### 2단계: 웹사이트 업데이트 및 버전 확인하기

정적 웹사이트의 `index.html` 파일을 수정하고 S3 버킷에 다시 업로드하여 버전이 어떻게 생성되는지 확인합니다.

1. 기존 `index.html` 파일의 내용을 "I love coffee."에서 "**I REALLY love coffee.**"로 수정합니다.
2. 수정한 `index.html` 파일을 S3 버킷에 다시 업로드합니다.
3. 버킷의 **객체(Objects)** 탭에서 `버전 표시(Show versions)` 토글을 켭니다.

**결과 확인:**

`index.html` 파일의 버전이 두 개가 된 것을 볼 수 있습니다.

- **null 버전 ID:** 버전 관리 활성화 이전에 업로드된 초기 `index.html` 파일입니다.
- **고유한 버전 ID:** 방금 수정한 후 업로드한 새로운 `index.html` 파일입니다.
    

웹사이트 URL에 접속하여 페이지를 새로고침하면, "I REALLY love coffee."가 표시되는 것을 확인할 수 있습니다.

---

### 3단계: 특정 버전 삭제를 통한 롤백하기

최신 버전이 마음에 들지 않아 이전 버전으로 되돌리고 싶을 때는 최신 버전을 **영구 삭제**하여 롤백할 수 있습니다.

1. `버전 표시(Show versions)`가 활성화된 상태에서, 최신 버전(`I REALLY love coffee.`가 포함된 버전)의 `index.html`을 선택합니다.
2. `삭제(Delete)`를 클릭합니다.
3. 삭제는 되돌릴 수 없는 영구적인 작업이므로, 확인 메시지에 **`permanently delete`**를 입력하고 삭제를 진행합니다.

**결과 확인:**

- 최신 버전이 삭제되고 이전 버전(`I love coffee.`가 포함된 버전)이 현재 최신 버전이 됩니다.
- 웹사이트 URL을 새로고침하면 "I love coffee."가 다시 표시되는 것을 볼 수 있습니다.

---

### 4단계: 객체 삭제와 삭제 마커(Delete Marker) 이해하기

일반적인 객체 삭제 작업이 버전 관리가 활성화된 버킷에서 어떻게 작동하는지 살펴봅니다.

1. `버전 표시(Show versions)` 토글을 비활성화합니다.
2. `coffee.jpg` 파일을 선택하고 `삭제(Delete)`를 클릭합니다. 이번에는 "영구 삭제"가 아닌 "삭제"만 입력합니다.

**결과 확인:**

- 버킷의 객체 목록에서 `coffee.jpg` 파일이 사라진 것처럼 보입니다.
- 하지만 `버전 표시(Show versions)`를 다시 활성화하면, `coffee.jpg` 파일에 **삭제 마커(Delete Marker)**가 추가된 것을 확인할 수 있습니다. 실제 파일 자체는 버킷에 그대로 남아있습니다.
- 웹사이트 URL에서 `coffee.jpg` 이미지를 보면 `404 Not Found` 오류가 발생합니다.

---

### 5단계: 삭제된 파일 복구하기

삭제 마커를 제거하면 삭제된 파일을 복구할 수 있습니다.

1. `버전 표시(Show versions)`가 활성화된 상태에서, `coffee.jpg`의 **삭제 마커**를 선택합니다.
2. `삭제(Delete)`를 클릭하고, 확인 메시지에 **`permanently delete`**를 입력하여 삭제 마커를 영구 삭제합니다.

**결과 확인:**

- 삭제 마커가 제거되면서 그 아래에 있던 기존 `coffee.jpg` 버전이 다시 활성화됩니다.
- 웹사이트를 새로고침하면 `coffee.jpg` 이미지가 다시 정상적으로 표시됩니다.

S3 버전 관리는 이처럼 실수로 인한 데이터 손실을 방지하고, 안정적인 웹사이트 운영을 돕는 필수적인 기능입니다. 