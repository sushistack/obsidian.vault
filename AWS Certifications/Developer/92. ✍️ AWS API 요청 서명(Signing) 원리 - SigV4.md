
AWS의 모든 API 요청은 보안을 위해 **서명(Signing)** 과정을 거쳐야 합니다. 이 서명은 요청을 보낸 사람이 누구인지, 그리고 요청이 변조되지 않았음을 AWS가 확인할 수 있도록 해주는 디지털 서명입니다. 이 과정을 위해 사용되는 표준이 바로 **Signature Version 4 (SigV4)**입니다.

---

### 1. SigV4의 역할: API 요청 서명

- **목표:** AWS 서비스에 보내는 HTTP 요청을 인증하고 권한을 부여하는 것.
- **작동 방식:**
    - AWS 자격 증명(Access Key ID, Secret Access Key)을 사용하여 요청 내용을 해시(hash)하고 서명합니다.
    - 이 서명을 통해 AWS는 요청자가 누구인지 확인하고, 요청의 유효성을 검증합니다.
- **자동 서명:** `AWS CLI`와 `SDK`는 이 복잡한 서명 과정을 자동으로 처리해 줍니다. 따라서 개발자는 별도의 서명 코드를 작성할 필요가 없습니다. 하지만 내부적으로는 모든 요청이 SigV4를 통해 서명되고 있습니다.

---

### 2. SigV4 서명 전송 방식: 두 가지 방법

서명된 요청은 주로 두 가지 방식으로 AWS에 전송됩니다.

#### 방법 1: HTTP Authorization 헤더 사용

- **개념:** HTTP 요청 헤더에 `Authorization` 필드를 추가하여 서명 정보를 전송합니다.
- **사용처:** `AWS CLI`와 대부분의 `AWS SDK`는 이 방식을 기본적으로 사용합니다.
- **장점:** URL에 서명 정보가 노출되지 않아 보안에 더 유리합니다.
- **예시:**

```
Authorization: AWS4-HMAC-SHA256 Credential=... SignedHeaders=... Signature=...
```

#### 방법 2: 쿼리 스트링(Query String) 사용

- **개념:** 서명 정보를 URL의 쿼리 파라미터로 포함하여 전송합니다.
- **사용처:** 주로 웹 브라우저에서 S3 객체 같은 리소스에 대한 **사전 서명된 URL(Pre-signed URL)**을 생성할 때 사용됩니다. 이 URL에는 유효 기간이 설정되어 있어 해당 기간 동안만 리소스에 접근할 수 있습니다.
- **쿼리 파라미터 예시:**
    - `X-Amz-Signature`
    - `X-Amz-Credential`
    - `X-Amz-Date`
    - `X-Amz-Expires`
    - `X-Amz-Algorithm`
- **예시 URL:**
    
    ```
    https://my-bucket.s3.amazonaws.com/coffee.jpg?
    X-Amz-Signature=...
    &X-Amz-Algorithm=AWS4-HMAC-SHA256
    &X-Amz-Date=20250803T123456Z
    &X-Amz-Expires=3600
    &X-Amz-Credential=...
    ```
    

### 3. S3 사전 서명된 URL 실습

실제로 S3 콘솔에서 객체를 열 때 생성되는 URL은 쿼리 스트링 방식의 서명을 사용합니다. 이 URL은 특정 기간 동안만 유효하며, 서명 정보가 포함되어 있어 권한 없는 접근을 방지합니다.

- **확인:** S3 버킷의 객체 URL을 보면, `?X-Amz-Signature=...`와 같은 여러 쿼리 파라미터가 포함되어 있는 것을 확인할 수 있습니다.
    

**핵심 요약:**

- **SigV4**는 AWS API 요청을 서명하는 표준입니다.
    
- `AWS CLI/SDK`는 요청 서명을 자동으로 처리합니다.
    
- 서명 전송 방식에는 **HTTP `Authorization` 헤더**와 **URL `쿼리 스트링`** 두 가지가 있습니다.
    
- 쿼리 스트링 방식은 주로 사전 서명된 URL에 사용되며, `X-Amz-Signature` 같은 파라미터가 포함됩니다.