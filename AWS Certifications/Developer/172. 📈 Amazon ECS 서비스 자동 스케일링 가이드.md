
Amazon ECS는 애플리케이션의 요구사항 변화에 따라 컨테이너(태스크) 수를 자동으로 조절하는 **서비스 자동 스케일링(Service Auto Scaling)** 기능을 제공합니다. 이 기능은 AWS Application Auto Scaling 서비스를 활용하며, Fargate와 EC2 시작 유형 모두에서 사용할 수 있습니다.

---

### 1. ECS 서비스 스케일링 메트릭 📊

ECS 서비스는 다음 세 가지 주요 지표를 기반으로 스케일링할 수 있습니다.

- **CPU 사용률(CPU Utilization):** 컨테이너의 평균 CPU 사용률을 기반으로 태스크 수를 조절합니다.
- **메모리 사용률(Memory Utilization):** 컨테이너의 평균 메모리 사용량을 기반으로 태스크 수를 조절합니다.
- **ALB 대상별 요청 수(ALB Request Count Per Target):** Application Load Balancer(ALB)의 지표로, 각 컨테이너(대상)가 받는 요청 수를 기반으로 스케일링합니다.

이러한 지표를 기반으로 **대상 추적(Target Tracking)**, **단계 스케일링(Step Scaling)**, **예약 스케일링(Scheduled Scaling)**과 같은 다양한 스케일링 정책을 설정할 수 있습니다.

---

### 2. ECS 스케일링 시나리오: 태스크 vs. 클러스터

ECS에서 **서비스 스케일링**은 컨테이너(태스크)의 수를 늘리거나 줄이는 것을 의미합니다. 그러나 **EC2 시작 유형**을 사용하는 경우, 태스크가 늘어나는 것과 컨테이너를 실행할 EC2 인스턴스의 수를 늘리는 것은 별개의 문제입니다.

- **Fargate 시작 유형:**
    
    - 서버리스이므로, 태스크 수가 늘어나면 AWS가 필요한 컴퓨팅 리소스를 자동으로 프로비저닝합니다.
    - 따라서 서비스 스케일링만 신경 쓰면 되므로 관리가 매우 간편합니다. 이것이 Fargate가 시험에서 선호되는 이유입니다.
- **EC2 시작 유형:**
    
    - **서비스 스케일링**만으로는 EC2 인스턴스가 자동으로 늘어나지 않습니다. 새로운 태스크가 실행될 공간이 부족하면 태스크는 `PENDING` 상태로 남게 됩니다.
    - 이를 해결하기 위해 **클러스터 스케일링**을 별도로 설정해야 합니다.

---

### 3. EC2 클러스터 스케일링 방법 ⚙️

![[Pasted image 20250810194140.png]]

EC2 시작 유형을 사용하는 경우, EC2 인스턴스 클러스터의 용량을 자동으로 조절하는 두 가지 방법이 있습니다.

- **Auto Scaling 그룹 스케일링:**
    
    - EC2 인스턴스의 CPU 사용률과 같은 지표를 직접 모니터링하여 Auto Scaling 그룹(ASG)의 용량을 조절하는 방식입니다.
    - ECS와 직접적인 연동 없이 독립적으로 작동하므로, 태스크가 실행될 용량이 부족해도 ASG가 즉시 반응하지 못할 수 있습니다.

- **ECS 클러스터 용량 공급자(Cluster Capacity Provider):**
    
    - **권장되는 최신 방식**입니다. ECS 클러스터와 ASG를 직접 연결하여, ECS가 ASG의 용량을 자동으로 관리하게 합니다.
    - ECS가 새로운 태스크를 실행하려고 하는데 리소스(CPU/RAM)가 부족하면, **용량 공급자가 이를 감지하고 ASG를 통해 EC2 인스턴스를 자동으로 확장합니다.**
    - 이 방식은 ECS의 태스크 배치 요구사항에 맞춰 인프라를 지능적으로 스케일링하므로, 기존 방식보다 훨씬 효율적이고 안정적입니다.
