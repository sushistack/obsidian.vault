
λλ‹¤ ν•¨μλ¥Ό VPCμ— λ°°ν¬ν•λ” μ‹¤μµμ„ λ‹¨κ³„λ³„λ΅ μ•λ‚΄ν•΄ λ“λ¦¬κ² μµλ‹λ‹¤. μ΄ κ³Όμ •μ„ ν†µν•΄ λλ‹¤ ν•¨μκ°€ VPC λ‚΄ λ¦¬μ†μ¤μ™€ μ–΄λ–»κ² ν†µμ‹ ν•λ”μ§€ μ§μ ‘ ν™•μΈν•κ³ , ν•„μ”ν• κ¶ν• μ„¤μ • λ°©λ²•μ„ μ΄ν•΄ν•  μ μμµλ‹λ‹¤.

---

## 1. μ‚¬μ „ μ¤€λΉ„: λ³΄μ• κ·Έλ£Ή μƒμ„±

λ¨Όμ €, λλ‹¤ ν•¨μμ— ν• λ‹Ήν•  λ³΄μ• κ·Έλ£Ήμ„ μƒμ„±ν•©λ‹λ‹¤.

1. **EC2 μ½μ†”**λ΅ μ΄λ™ν•μ—¬ **`Security Groups`** λ©”λ‰΄λ¥Ό μ„ νƒν•©λ‹λ‹¤.
    
2. **`Create security group`**μ„ ν΄λ¦­ν•©λ‹λ‹¤.
    
3. **`Security group name`**μ— `Lambda-SG`λ¥Ό μ…λ ¥ν•©λ‹λ‹¤.
    
4. **`VPC`**λ¥Ό μ„ νƒν•κ³ , **`Create security group`**μ„ ν΄λ¦­ν•μ—¬ μƒμ„±ν•©λ‹λ‹¤.
    
5. μ΄ λ³΄μ• κ·Έλ£Ήμ€ λλ‹¤ ν•¨μκ°€ VPC λ‚΄λ¶€μ λ‹¤λ¥Έ λ¦¬μ†μ¤μ™€ ν†µμ‹ ν•  λ• μ‚¬μ©λ©λ‹λ‹¤.

---

## 2. λλ‹¤ ν•¨μ VPC μ„¤μ • β™οΈ

μƒλ΅μ΄ λλ‹¤ ν•¨μ(`lambda-vpc-demo`)λ¥Ό μƒμ„±ν• ν›„, VPC μ„¤μ •μ„ μ μ©ν•©λ‹λ‹¤.

1. λλ‹¤ ν•¨μμ **`Configuration`** νƒ­μΌλ΅ μ΄λ™ν•©λ‹λ‹¤.
    
2. μ™Όμ½ λ©”λ‰΄μ—μ„ **`VPC`**λ¥Ό μ„ νƒν•κ³  **`Edit`** λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
    
3. **`VPC`** λ“λ΅­λ‹¤μ΄μ—μ„ ν•¨μλ¥Ό λ°°ν¬ν•  VPCλ¥Ό μ„ νƒν•©λ‹λ‹¤.
    
4. **`Subnets`**μ—μ„ VPC λ‚΄μ μ„λΈλ„·μ„ μ„ νƒν•©λ‹λ‹¤. **β οΈμ£Όμ:** λλ‹¤ ν•¨μλ” νΌλΈ”λ¦­ μ„λΈλ„·μ— λ°°ν¬ν•΄λ„ μΈν„°λ„· μ ‘κ·Όμ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤. μΈν„°λ„· μ—°κ²°μ΄ ν•„μ”ν•λ‹¤λ©΄ ν”„λΌμ΄λΉ— μ„λΈλ„·μ— NAT κ²μ΄νΈμ›¨μ΄λ¥Ό κµ¬μ„±ν•΄μ•Ό ν•©λ‹λ‹¤.
    
5. **`Security groups`**μ—μ„ μ„μ—μ„ μƒμ„±ν• **`Lambda-SG`**λ¥Ό μ„ νƒν•©λ‹λ‹¤.
    
6. **`Save`**λ¥Ό ν΄λ¦­ν•©λ‹λ‹¤. μ΄ λ‹¨κ³„μ—μ„ κ¶ν• λ¶€μ΅± μ¤λ¥κ°€ λ°μƒν•©λ‹λ‹¤.

---

## 3. IAM κ¶ν• μ¶”κ°€: ENI κ΄€λ¦¬ π”‘

λλ‹¤ ν•¨μκ°€ VPCμ— μ†ν•λ ¤λ©΄ EC2μ λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤(ENI)λ¥Ό μƒμ„±ν•  κ¶ν•μ΄ ν•„μ”ν•©λ‹λ‹¤. μ΄ κ¶ν•μ€ λλ‹¤ ν•¨μμ μ‹¤ν–‰ μ—­ν• μ— μ¶”κ°€ν•΄μ•Ό ν•©λ‹λ‹¤.

1. λλ‹¤ ν•¨μ μ½μ†”μ—μ„ **`Configuration`** νƒ­ > **`Permissions`** λ©”λ‰΄λ΅ μ΄λ™ν•©λ‹λ‹¤.
    
2. **`Role name`** λ§ν¬λ¥Ό ν΄λ¦­ν•μ—¬ IAM μ½μ†”μ μ—­ν•  νμ΄μ§€λ΅ μ΄λ™ν•©λ‹λ‹¤.
    
3. **`Add permissions`** > **`Attach policies`**λ¥Ό ν΄λ¦­ν•©λ‹λ‹¤.
    
4. κ²€μƒ‰μ°½μ— `Lambda`λ¥Ό μ…λ ¥ν•κ³  **`AWSLambdaVPCAccessExecutionRole`** μ •μ±…μ„ μ°Ύμ•„ μ—°κ²°ν•©λ‹λ‹¤.
    
5. μ΄ μ •μ±…μ€ `ec2:CreateNetworkInterface`, `ec2:DeleteNetworkInterface` λ“± ENIλ¥Ό κ΄€λ¦¬ν•λ” λ° ν•„μ”ν• κ¶ν•μ„ λ¶€μ—¬ν•©λ‹λ‹¤.

---

## 4. VPC λ°°ν¬ λ° κ²°κ³Ό ν™•μΈ β…

IAM κ¶ν•μ„ μ¶”κ°€ν• ν›„, λ‹¤μ‹ λλ‹¤ ν•¨μμ VPC μ„¤μ • νμ΄μ§€λ΅ λμ•„μ™€ **`Save`**λ¥Ό ν΄λ¦­ν•©λ‹λ‹¤.

- λλ‹¤ ν•¨μκ°€ VPCμ— λ°°ν¬λλ” λ° λ‡ λ¶„ μ •λ„ μ†μ”λ  μ μμµλ‹λ‹¤.
    
- λ°°ν¬κ°€ μ™„λ£λλ©΄ λλ‹¤ ν•¨μλ¥Ό ν…μ¤νΈν•μ—¬ μ •μƒ λ™μ‘μ„ ν™•μΈν•©λ‹λ‹¤.

μ΄μ  **EC2 μ½μ†”**μ **`Network Interfaces`** λ©”λ‰΄λ΅ μ΄λ™ν•©λ‹λ‹¤. λλ‹¤ ν•¨μκ°€ λ°°ν¬λ μ„λΈλ„·μ κ°μλ§νΌ μƒλ΅μ΄ **ENIκ°€ μƒμ„±λ κ²ƒ**μ„ ν™•μΈν•  μ μμµλ‹λ‹¤. μ΄ ENIλ“¤μ΄ λλ‹¤ ν•¨μκ°€ VPC λ‚΄μ—μ„ ν†µμ‹ ν•  μ μλ” ν†µλ΅ μ—­ν• μ„ ν•©λ‹λ‹¤.

μ΄ μ‹¤μµμ„ ν†µν•΄ λλ‹¤ ν•¨μλ¥Ό VPC λ‚΄μ— λ°°ν¬ν•κ³ , VPC λ¦¬μ†μ¤μ— μ ‘κ·Όν•κΈ° μ„ν•΄ ν•„μ”ν• IAM κ¶ν•κ³Ό λ„¤νΈμ›ν¬ κµ¬μ„±μ μ¤‘μ”μ„±μ„ μ§μ ‘ ν™•μΈν•  μ μμµλ‹λ‹¤.