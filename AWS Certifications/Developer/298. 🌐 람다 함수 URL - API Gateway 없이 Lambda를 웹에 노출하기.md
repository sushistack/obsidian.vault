
AWS 람다(Lambda) 함수를 HTTP 엔드포인트로 노출해야 할 때, 복잡한 API Gateway나 Application Load Balancer를 설정하는 대신 **람다 함수 URL**을 사용할 수 있습니다. 이 기능은 람다 함수에 고유하고 영구적인 URL을 제공하여 웹 브라우저, cURL, Postman 등 모든 HTTP 클라이언트를 통해 직접 접근할 수 있게 합니다.

---

## 🔗 함수 URL의 특징 및 작동 원리

람다 함수 URL은 다음과 같은 주요 특징을 가집니다.

- **고유하고 영구적인 URL**: 람다 함수에 할당된 URL은 한 번 생성되면 변경되지 않습니다.
    
- **간편한 HTTP 엔드포인트**: 별도의 서비스 없이 람다 함수를 웹에 직접 노출합니다.
    
- **공용 인터넷 접근**: 오직 공용 인터넷을 통해서만 접근 가능하며, 프라이빗 URL은 지원하지 않습니다.
    
- **버전 및 별칭**: 최신 버전 또는 특정 별칭에 대해 함수 URL을 적용할 수 있습니다. 단, 개별 함수 버전에는 적용할 수 없습니다.

---

## 🛡️ 함수 URL 보안: 인증 및 정책

함수 URL의 보안은 **인증 유형(AuthType)**과 **리소스 기반 정책(Resource-based policies)**을 통해 관리됩니다.

### 1. **인증 유형 (AuthType)**

|AuthType|설명|
|---|---|
|**NONE**|**인증되지 않은 공개 액세스**를 허용합니다. <br>인증이 필요 없는 공개 API에 적합하며, 접근 제어는 **리소스 기반 정책**으로만 이루어집니다. 이 경우, `lambda:InvokeFunctionUrl` 권한이 부여된 `Principal: *` (모든 주체) 정책이 필요합니다.|
|**AWS_IAM**|**AWS IAM 주체**를 사용한 인증 및 권한 부여를 요구합니다. <br>요청을 보낸 주체의 IAM 정책과 람다 함수의 리소스 기반 정책이 모두 **`lambda:InvokeFunctionUrl`** 권한을 허용해야 합니다. 이는 가장 안전한 방법입니다.|

### 2. **리소스 기반 정책**

![[Pasted image 20250902223044.png]]

리소스 기반 정책은 람다 함수에 직접 연결되어 어떤 계정, IP 범위(CIDR), 또는 IAM 주체가 함수 URL에 접근할 수 있는지 명시적으로 정의합니다. 이는 S3 버킷 정책과 유사한 방식으로 작동합니다.

- **동일 계정 내 접근**: IAM 주체(사용자/역할)의 **자격 증명 기반 정책(Identity-based policy)** 또는 람다 함수의 **리소스 기반 정책** 중 하나만 `lambda:InvokeFunctionUrl` 권한을 허용하면 됩니다.
    
- **교차 계정(Cross-account) 접근**: 보안을 위해 **양쪽 정책**이 모두 권한을 명시적으로 허용해야 합니다. 예를 들어, `계정 A`의 람다 함수에 `계정 B`의 IAM 역할이 접근하려면, `계정 A`의 리소스 기반 정책이 `계정 B`의 역할을 `Principal`로 허용해야 하고, 동시에 `계정 B`의 IAM 역할도 `계정 A`의 람다 함수를 호출할 수 있는 `lambda:InvokeFunctionUrl` 권한이 포함된 자격 증명 기반 정책을 가지고 있어야 합니다.

```JSON
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowAccountBInvokeFunctionUrl",
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::계정B-ID:role/역할이름"
      },
      "Action": "lambda:InvokeFunctionUrl",
      "Resource": "arn:aws:lambda:리전:계정A-ID:function:함수이름"
    }
  ]
}
```

---

## 🤝 CORS 구성 및 요청 스로틀링

### **CORS (Cross-Origin Resource Sharing)**

![[Pasted image 20250902223022.png]]

만약 다른 도메인(예: `example.com`)에서 함수 URL(예: `api.example.com`)로 요청을 보내는 경우, **CORS 설정**이 필요합니다. 람다 함수 URL에서 CORS를 활성화하면, 브라우저가 보안 정책에 따라 요청을 차단하지 않도록 허용합니다. 이는 Amazon S3와 유사한 방식으로 동작합니다.

### **요청 스로틀링**

람다 함수 URL의 호출량을 제어하려면 **예약된 동시성(Reserved Concurrency)** 기능을 사용할 수 있습니다. 이 기능을 통해 람다 함수가 동시에 실행될 수 있는 최대 인스턴스 수를 제한하여, 예상치 못한 트래픽 급증으로 인한 비용 상승을 방지하고 백엔드 서비스의 안정성을 확보할 수 있습니다.

**함수 URL은 API Gateway의 복잡한 기능을 필요로 하지 않는 간단한 웹 서비스나 웹훅(Webhook)을 구현할 때 매우 유용한 도구입니다. 🚀**