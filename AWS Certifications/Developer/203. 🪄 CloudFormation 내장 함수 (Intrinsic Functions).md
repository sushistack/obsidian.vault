

---

**내장 함수**는 CloudFormation 템플릿 내에서 특정 논리나 연산을 수행할 수 있게 해주는 기능입니다. 이를 통해 템플릿의 유연성과 재사용성을 높일 수 있습니다. 시험에서 중요하게 다루는 핵심 함수들은 다음과 같습니다.

- `!Ref` (Ref)
- `!GetAtt` (GetAtt)
- `!FindInMap` (FindInMap)
- `!ImportValue` (ImportValue)
- `!Base64` (Base64)
- 조건 함수 (`!If`, `!Equals`, `!And`, `!Or`, `!Not`)

---

### 1. `!Ref` 함수 (Reference)

`!Ref` 함수는 파라미터나 리소스를 참조하여 값을 가져옵니다.

- **파라미터 참조**: 파라미터의 **입력 값**을 반환합니다.
- **리소스 참조**: 생성된 리소스의 **물리적 ID**를 반환합니다. 예를 들어, `AWS::EC2::Instance` 리소스를 참조하면 해당 인스턴스의 ID(`i-xxxxxx`)를 반환합니다.

```YAML
# 예시: VPC 리소스의 물리적 ID를 Subnet에 할당
Resources:
  MySubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref MyVPC   # MyVPC 리소스의 ID를 참조
```

### 2. `!GetAtt` 함수 (Get Attribute)

`!GetAtt` 함수는 특정 리소스의 속성(Attribute) 값을 가져올 때 사용합니다. `!Ref`가 주로 ID를 반환하는 반면, `!GetAtt`는 더 다양한 정보를 가져올 수 있습니다.

- **구조**: `!GetAtt [리소스 논리적 ID].[속성 이름]`
- **속성 확인**: 각 리소스가 제공하는 속성은 공식 문서의 **`Return values`** 섹션에서 확인할 수 있습니다. 예를 들어, `AWS::EC2::Instance`는 `AvailabilityZone`, `PrivateIp`, `PublicIp` 등의 속성을 제공합니다.

```YAML
# 예시: EC2 인스턴스의 가용 영역(AZ) 정보를 가져와 EBS 볼륨에 할당
Resources:
  MyVolume:
    Type: AWS::EC2::Volume
    Properties:
      AvailabilityZone: !GetAtt EC2Instance.AvailabilityZone # EC2Instance의 AZ 속성 참조
```

---

### 3. 기타 주요 함수

|함수|설명|예시|
|---|---|---|
|**`!FindInMap`**|매핑에 정의된 값 중에서 특정 키에 해당하는 값을 반환합니다.|`!FindInMap [맵이름, 최상위키, 두번째키]`|
|**`!ImportValue`**|다른 스택에서 `Export`된 값을 가져옵니다. 스택 간의 의존성을 설정할 때 유용합니다.|`!ImportValue SSHSecurityGroup`|
|**`!Base64`**|문자열을 Base64 인코딩된 문자열로 변환합니다. 주로 EC2 인스턴스 `UserData`에 스크립트를 전달할 때 사용됩니다.|`UserData: !Base64 '...스크립트 내용...'`|
|**조건 함수**|`!If`, `!Equals`, `!And`, `!Or`, `!Not` 등 논리 연산을 통해 조건부 리소스 생성 등을 제어합니다.|`Condition: !Equals [!Ref Env, 'prod']`|
