이번 실습에서는 AWS CloudShell 환경에서 **AWS SAM(Serverless Application Model)**을 사용하여 간단한 `Hello World` 서버리스 애플리케이션을 생성하고 배포하는 과정을 자세히 알아보겠습니다. SAM CLI의 강력한 기능을 통해 서버리스 개발이 얼마나 간편해지는지 직접 경험해 보세요.

---

## 💻 1. SAM 애플리케이션 초기화

AWS CloudShell에는 SAM CLI가 기본적으로 설치되어 있습니다. `sam init` 명령어를 사용하여 새로운 서버리스 애플리케이션 프로젝트를 초기화합니다.

### **초기화 과정**

```Bash
# 1. SAM CLI 버전 확인
sam --version

# 2. SAM 프로젝트 초기화
sam init
```

- **선택:** `Quick Start template` (옵션 1)을 선택합니다.
    
- **템플릿 선택:** `Hello World Example` (옵션 1)을 선택합니다.
    
- **런타임 및 패키지 유형:** `python3.9` 및 `zip` 패키지 유형을 선택합니다.
    
- **추가 옵션:** X-Ray 트레이싱, CloudWatch Insights, JSON 로그 포맷 등은 `No`로 설정합니다.
    
- **프로젝트 이름:** `sam-app`으로 지정합니다.
    

초기화가 완료되면 `sam-app` 디렉터리가 생성됩니다.

### **프로젝트 구조 탐색**

`sam-app` 디렉터리에는 다음과 같은 핵심 파일들이 포함되어 있습니다.

|파일/디렉터리|역할|
|---|---|
|**`hello_world/app.py`**|**Lambda 함수 코드**가 담겨 있습니다. `Hello World` 메시지를 반환하는 간단한 Python 코드가 작성되어 있습니다.|
|**`template.yaml`**|**서버리스 애플리케이션 템플릿**입니다. SAM 리소스를 정의하며, CloudFormation으로 변환될 기본 템플릿 역할을 합니다.|
|**`requirements.txt`**|애플리케이션의 **Python 종속성**을 정의합니다. `requests` 패키지가 포함되어 있습니다.|
|**`samconfig.toml`**|SAM CLI의 **구성 파일**로, 스택 이름, 빌드 매개변수 등 배포 관련 설정이 저장됩니다.|

---

## 🛠️ 2. 애플리케이션 빌드 및 배포 준비

`sam init`으로 생성된 템플릿의 런타임 버전을 CloudShell 환경과 호환되도록 수정하고, `sam build` 명령어로 애플리케이션을 빌드합니다.

1. **`template.yaml` 수정:**
    
    - `sam-app` 디렉터리로 이동합니다. (`cd sam-app`)
        
    - `template.yaml` 파일을 편집기(예: `nano`)로 엽니다.
        
    - **`Runtime`** 값을 `python3.13`에서 CloudShell 환경에 맞는 **`python3.9`**로 변경합니다.
        
2. **`sam build` 실행:**
    
    - `sam build` 명령어를 실행하여 애플리케이션 코드를 패키징하고, CloudFormation 템플릿으로 변환하는 과정을 시작합니다.
        
    - 성공적으로 빌드되면, `.aws-sam/build` 디렉터리에 빌드 결과물(패키징된 코드, 변환된 템플릿 등)이 생성됩니다.
        

---

## 🚀 3. 클라우드에 애플리케이션 배포

이제 `sam deploy` 명령어를 사용하여 애플리케이션을 AWS 클라우드에 배포합니다. `sam deploy --guided`를 사용하면 배포에 필요한 설정을 단계별로 안내받을 수 있습니다.

### **배포 과정**

```Bash
sam deploy --guided
```

- **Stack Name:** `sam-app` (기본값)
    
- **Region:** 기본 리전
    
- **Confirm changes before deploy:** `Y`
    
- **Allow SAM CLI IAM role creation:** `Y`
    
- **Disable rollback:** `N`
    
- **Save arguments to samconfig.toml:** `Y`
    

SAM CLI는 이 과정을 통해 CloudFormation 스택을 생성하고, Lambda 함수, IAM 역할, API Gateway 등 필요한 AWS 리소스들을 자동으로 프로비저닝합니다.

### **배포 결과 확인**

배포가 완료되면 다음과 같은 리소스가 AWS 클라우드에 생성됩니다.

- **AWS CloudFormation:** `sam-app` 스택이 **`CREATE_COMPLETE`** 상태로 나타납니다.
    
- **AWS Lambda:** `sam-app-HelloWorldFunction-XYZ`와 같은 이름의 Lambda 함수가 생성됩니다.
    
- **API Gateway:** Lambda 함수를 호출하는 데 사용될 `sam-app-api`라는 API Gateway가 생성됩니다. 배포 성공 시 출력(Output)에 표시되는 엔드포인트 URL을 통해 함수를 호출할 수 있습니다.
    

### **애플리케이션 테스트**

API Gateway의 엔드포인트를 `curl` 명령어나 웹 브라우저를 통해 호출하여 애플리케이션의 동작을 확인합니다.

```Bash
curl <API Gateway 엔드포인트 URL>
```

- **예상 응답:** `{"message": "Hello world"}`
    

이 실습을 통해 SAM CLI가 얼마나 강력하고 편리한지 알 수 있습니다. 단 몇 개의 명령어로 복잡한 서버리스 인프라를 자동으로 구성하고 배포할 수 있습니다.