

이번 강의에서는 클라이언트의 IP 주소를 기준으로 트래픽을 라우팅하는 **IP 기반 라우팅 정책(IP-based Routing Policy)**에 대해 알아봅니다. 이 정책은 네트워크 관리자가 클라이언트 IP 범위(CIDR 블록)를 미리 알고 있을 때 유용하게 활용할 수 있습니다.

---

### 1. IP 기반 라우팅 정책이란? 🤔

![[Pasted image 20250727171816.png]]

- **개념**: 클라이언트의 IP 주소 범위(CIDR 블록)를 기반으로 트래픽을 특정 엔드포인트로 라우팅하는 정책입니다.
    
- **작동 방식**:
    
    1. **CIDR 블록 지정**: Route 53에서 특정 IP 주소 범위를 CIDR(Classless Inter-Domain Routing) 블록으로 정의합니다. 이 CIDR 블록은 특정 위치(Location)와 연결됩니다.
    2. **레코드 생성**: DNS 쿼리를 요청하는 클라이언트의 IP가 해당 CIDR 블록에 속하는 경우, 특정 레코드(IP 주소 등)로 라우팅되도록 설정합니다.
        
- **주요 특징**:
    
    - **명시적 라우팅**: 지리적 위치나 지연 시간 기반 라우팅과 달리, IP 기반 라우팅은 네트워크 관리자가 직접 정의한 IP 범위에 따라 명확하게 라우팅 경로를 지정합니다.
    - **고급 설정**: 특정 인터넷 서비스 제공업체(ISP)의 IP 대역이나 특정 고객 그룹의 IP 대역을 미리 알고 있을 때 성능 최적화나 네트워크 비용 절감을 위해 사용할 수 있습니다.
    - **지정된 CIDR 블록이 없는 경우**: 정의된 CIDR 블록에 속하지 않는 클라이언트 IP에 대한 **기본(Default)** 레코드를 설정할 수 있습니다.


### 2. IP 기반 라우팅 정책의 작동 예시 🗺️

`example.com` 도메인에 대한 IP 기반 라우팅 정책을 구성하는 시나리오를 살펴보겠습니다.

1. **위치(Location) 정의**:

    - **위치 1**: IP 주소 범위가 `203.0.113.0/24`인 CIDR 블록을 정의합니다.
    - **위치 2**: IP 주소 범위가 `200.0.1.0/24`인 CIDR 블록을 정의합니다.
        
2. **레코드 생성**:
    
    - **레코드 A**: `example.com` 도메인에 대해, `위치 1`에 속하는 클라이언트는 `1.2.3.4` IP 주소로 라우팅되도록 설정합니다. (이 IP는 EC2 인스턴스 A의 주소)
    - **레코드 B**: `example.com` 도메인에 대해, `위치 2`에 속하는 클라이언트는 `5.6.7.8` IP 주소로 라우팅되도록 설정합니다. (이 IP는 EC2 인스턴스 B의 주소)
        
3. **트래픽 흐름**:
    
    - **클라이언트 A**: IP 주소가 `203.0.113.10`인 클라이언트가 `example.com`에 DNS 쿼리를 보냅니다. Route 53은 이 IP가 `위치 1`에 속하는 것을 확인하고 `1.2.3.4` IP 주소를 반환합니다.
    - **클라이언트 B**: IP 주소가 `200.0.1.50`인 클라이언트가 `example.com`에 DNS 쿼리를 보냅니다. Route 53은 이 IP가 `위치 2`에 속하는 것을 확인하고 `5.6.7.8` IP 주소를 반환합니다.


### 3. 결론 💡

**IP 기반 라우팅 정책**은 클라이언트의 IP 주소 범위를 명확히 알고 있을 때 트래픽을 정밀하게 제어할 수 있는 강력한 도구입니다. 특정 네트워크 환경에 대한 성능 최적화, 네트워크 비용 관리, 또는 특정 고객 그룹에 대한 맞춤형 서비스 제공 등 특수한 요구사항을 해결하는 데 유용하게 사용됩니다. 이 정책은 다른 라우팅 정책과 달리 클라이언트의 지리적 위치나 지연 시간과는 독립적으로 동작합니다.
