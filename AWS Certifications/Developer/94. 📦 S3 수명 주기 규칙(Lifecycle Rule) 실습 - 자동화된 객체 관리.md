이번 실습에서는 S3 버킷에 **수명 주기 규칙(Lifecycle Rule)**을 직접 생성하고, 다양한 규칙 옵션을 사용하여 객체 전환 및 만료를 자동화하는 방법을 알아보겠습니다.

---

### 1단계: 수명 주기 규칙 생성 ⚙️

1. S3 콘솔에서 원하는 버킷을 선택하고 `관리(Management)` 탭으로 이동합니다.
2. `수명 주기 규칙(Lifecycle rules)` 섹션에서 `수명 주기 규칙 생성(Create lifecycle rule)`을 클릭합니다.
3. **규칙 이름:** `DemoRule`
4. **규칙 범위:** `버킷의 모든 객체에 적용(Apply to all objects in the bucket)`을 선택합니다.
5. **규칙 작업(Rule actions):** 5가지 주요 옵션을 확인하고 선택할 수 있습니다.

|규칙 작업|설명|
|---|---|
|**현재 버전의 객체 이동**|가장 최신 버전의 객체를 다른 스토리지 클래스로 전환합니다.|
|**비-현재 버전의 객체 이동**|덮어쓰기되거나 삭제 마커가 생긴 객체(이전 버전)를 다른 클래스로 전환합니다.|
|**현재 버전의 객체 만료**|최신 버전의 객체를 삭제합니다.|
|**비-현재 버전의 객체 영구 삭제**|이전 버전의 객체를 영구적으로 삭제합니다.|
|**만료된 삭제 마커 또는 불완전한 멀티파트 업로드 삭제**|더 이상 필요 없는 삭제 마커나 실패한 업로드 조각들을 삭제하여 비용을 절감합니다.|

---

### 2단계: 다양한 수명 주기 규칙 적용 실습

#### 1. 현재 버전 객체 전환

가장 자주 사용되는 규칙으로, 현재 버전의 객체를 시간이 지남에 따라 저렴한 클래스로 이동시킵니다.

- `현재 버전의 객체 이동(Transition current versions of objects between storage classes)`을 선택합니다.
    
- **전환 추가(Add transition)**를 클릭하고 다음 규칙을 설정합니다.
    - 생성 후 **30일**이 지나면 `S3 Standard-IA`로 전환
    - 생성 후 **60일**이 지나면 `S3 Intelligent-Tiering`으로 전환
    - 생성 후 **90일**이 지나면 `Glacier Instant Retrieval`로 전환
    - 생성 후 **180일**이 지나면 `Glacier Flexible Retrieval`로 전환
    - 생성 후 **365일**이 지나면 `Glacier Deep Archive`로 전환

#### 2. 비-현재 버전 객체 전환

버전 관리가 활성화된 버킷에서, 이전 버전의 객체를 빠르게 아카이빙할 때 유용합니다.

- `비-현재 버전의 객체 이동(Transition non-current versions of objects between storage classes)`을 선택합니다.
- **전환 추가(Add transition)**를 클릭하고 다음 규칙을 설정합니다.
    - 객체가 비-현재 버전이 된 후 **90일**이 지나면 `Glacier Flexible Retrieval`로 전환

#### 3. 객체 만료 규칙 설정

더 이상 필요 없는 객체나 이전 버전의 객체를 자동으로 삭제하여 스토리지 비용을 절감합니다.
- `현재 버전의 객체 만료(Expire current versions of objects)`를 선택하고 **700일**로 설정합니다.
- `비-현재 버전의 객체 영구 삭제(Permanently delete non-current versions of objects)`를 선택하고 **700일**로 설정합니다.

---

### 3단계: 규칙 미리보기 및 생성 🚀

모든 규칙을 설정하면, AWS 콘솔은 규칙에 따른 객체의 예상 수명 주기를 시각적으로 보여줍니다.
- 설정된 규칙의 타임라인을 확인합니다.
- 모든 설정이 올바른지 확인한 후 `규칙 생성(Create rule)`을 클릭합니다.

이제 S3 버킷은 백그라운드에서 이 규칙에 따라 객체들을 자동으로 관리하게 됩니다. 수동으로 객체를 관리할 필요 없이, 비용을 효율적으로 최적화할 수 있습니다.