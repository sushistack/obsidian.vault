
**매핑**은 CloudFormation 템플릿 내에 하드코딩된 **고정된 변수**를 정의하는 기능입니다. 템플릿 배포 시 환경(예: 개발, 프로덕션)이나 리전(region)과 같은 특정 조건에 따라 다른 값을 사용하고자 할 때 유용합니다. 매핑에 정의된 모든 값은 템플릿에 미리 명시되어 있으며, 런타임에 동적으로 변경되지 않습니다.

---

### 💻 매핑 구조 및 예시

매핑은 계층적인 구조로 이루어져 있으며, 일반적으로 다음과 같은 형식을 가집니다.



```YAML
Mappings:
  MapName:
    TopLevelKey:
      SecondLevelKey: Value
```

#### 예시: 리전별 AMI ID 매핑

가장 흔한 매핑 사용 사례는 리전별로 다른 AMI ID를 지정하는 것입니다.

```YAML
Mappings:
  RegionMap:
    us-east-1:
      HVM64: ami-0c55b159cbfafe1f0
      HVMG2: ami-0a672322312683074
    us-west-1:
      HVM64: ami-0275c9d1a8c3e800d
      HVMG2: ami-02d294025d2c88289
```

이 예시에서 **`RegionMap`**은 매핑의 이름이고, **`us-east-1`** 및 **`us-west-1`**은 최상위 키(TopLevelKey)입니다. 각 리전 아래에는 **`HVM64`**와 **`HVMG2`**라는 두 번째 레벨 키(SecondLevelKey)가 있으며, 이 키에 해당하는 AMI ID 값이 정의되어 있습니다.

---

### 🔎 매핑 값 검색: `!FindInMap` 함수

템플릿의 리소스에서 매핑에 정의된 값을 가져오기 위해서는 **`!FindInMap`** 함수를 사용합니다.



```YAML
Resources:
  MyInstance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: !FindInMap
        - RegionMap             # 1. 매핑 이름 (MapName)
        - !Ref AWS::Region      # 2. 최상위 키 (TopLevelKey)
        - HVM64                 # 3. 두 번째 레벨 키 (SecondLevelKey)
```

이 함수는 세 가지 인수를 필요로 합니다.

1. **매핑 이름**: `RegionMap`
2. **최상위 키**: `!Ref AWS::Region`은 **가상 파라미터**를 사용하여 스택이 배포되는 리전(예: `us-east-1`)을 자동으로 가져옵니다.
3. **두 번째 레벨 키**: `HVM64`는 아키텍처 타입을 지정합니다.

결과적으로 이 코드는 `us-east-1` 리전에서 배포될 경우 `ami-0c55b159cbfafe1f0` 값을 찾아 `ImageId`로 사용하게 됩니다.

---

### 🤔 매핑 vs. 파라미터

**매핑**과 **파라미터**는 모두 동적인 값을 템플릿에 제공하는 기능이지만, 사용 목적에 차이가 있습니다.

|구분|매핑 (Mappings)|파라미터 (Parameters)|
|---|---|---|
|**목적**|**고정된, 미리 결정된 값**을 템플릿 내에 하드코딩하고, 환경/리전 등 특정 조건에 따라 선택적으로 사용합니다.|**사용자 입력**을 받아 런타임에 값을 결정합니다.|
|**제어**|템플릿 제작자가 모든 가능한 값을 미리 정의하므로 **안전하고 엄격한 제어**가 가능합니다.|사용자에게 입력 값을 선택할 **자유**를 제공합니다.|
|**사용 시점**|**모든 가능한 값**을 사전에 알고 있으며, 변수가 (리전, 환경 등) 명확하게 분류되는 경우에 적합합니다.|값이 배포 시점에 결정되며, 사용자 의도에 따라 달라지는 경우에 적합합니다.|