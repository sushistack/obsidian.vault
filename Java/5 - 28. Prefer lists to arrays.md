**Effective Java**에서 제네릭을 다룰 때 리스트(List)를 배열(Array)보다 선호해야 한다


### 1. **리스트를 배열보다 선호해야 하는 이유**

배열과 리스트 모두 **순차적으로 데이터를 저장**하는 자료구조입니다. 하지만 자바에서 **제네릭과 배열은 완전히 다른 방식으로 동작**하며, 이 차이로 인해 **타입 안전성**에 문제가 발생할 수 있습니다. 

자바의 **배열은 공변성(covariant)**을 갖는 반면, **리스트는 불공변성(invariant)**을 지닙니다. 이로 인해 배열은 타입 안전성에서 위험한 상황이 발생할 수 있으며, 이런 이유로 제네릭을 사용할 때는 **리스트**를 선호해야 합니다.

### 2. 예시: 배열과 리스트의 차이

#### 배열의 문제점 (공변성)

배열은 공변성이 있기 때문에, 상위 타입의 배열에 하위 타입의 배열을 할당할 수 있습니다. 즉, `Sub[]` 타입의 배열을 `Super[]`로 간주할 수 있습니다.

```java
Object[] objectArray = new Long[1];
objectArray[0] = "This will throw an exception";  // ArrayStoreException 발생
```

위 코드에서 `Object[]` 배열이 `Long[]` 배열을 참조하고 있지만, 문자열(`String`)을 배열에 넣으려고 하면 런타임에 `ArrayStoreException`이 발생합니다. 컴파일러는 이를 인지하지 못하기 때문에 **런타임 오류**가 발생합니다.

#### 리스트의 타입 안전성 (불공변성)

제네릭을 사용하는 **리스트**는 공변성을 가지지 않기 때문에, 타입 안전성을 보장합니다. 즉, 서로 다른 타입의 리스트는 변환할 수 없습니다.

```java
List<Object> objectList = new ArrayList<>();
// List<Long> longList = objectList;  // 컴파일 오류 발생
```

리스트는 공변성을 허용하지 않으므로, 위 코드에서 `List<Object>`와 `List<Long>`는 호환되지 않습니다. 컴파일 타임에 오류를 발생시키므로 **런타임 오류**를 방지할 수 있습니다.

### 3. 주의점

#### 1) **배열은 런타임에 타입을 체크하고, 리스트는 컴파일 타임에 타입을 체크**합니다.

- **배열**은 공변성으로 인해 런타임에 `ArrayStoreException` 같은 오류가 발생할 수 있습니다.
- **리스트**는 불공변성 덕분에 컴파일 타임에 타입 불일치를 바로 확인할 수 있어, 더 **타입 안전**합니다.

#### 2) **제네릭 배열 생성이 불가능**

자바에서는 제네릭 타입의 배열을 직접적으로 생성할 수 없습니다. 예를 들어, 다음과 같은 코드는 허용되지 않습니다.

```java
List<String>[] stringLists = new List<String>[1];  // 컴파일 오류
```

이는 제네릭과 배열의 타입 시스템이 서로 다르기 때문에 발생하는 문제입니다. 반면, 리스트는 제네릭 타입을 안전하게 지원합니다.

#### 3) **리스트는 더 유연한 API를 제공합니다**

리스트는 다양한 **컬렉션 메서드**를 제공합니다. `size()`, `add()`, `remove()`, `contains()` 등의 메서드를 활용할 수 있어 **배열보다 더 유연**하게 사용할 수 있습니다.

예시:

```java
List<String> stringList = new ArrayList<>();
stringList.add("Hello");
stringList.remove("Hello");
int size = stringList.size();
```

배열은 크기가 고정되어 있고, 요소를 추가하거나 제거하는 등의 작업이 리스트보다 덜 유연합니다.

### 4. 해결책: **리스트 사용을 권장**

제네릭을 사용할 때는 가능한 한 **리스트**를 사용하고, **배열**은 특별한 이유가 있을 때만 사용하는 것이 좋습니다. 예를 들어, 배열이 제공하는 성능상의 이점이 필요하거나, 배열의 고정된 크기가 요구되는 상황이라면 배열을 사용할 수 있습니다. 하지만 제네릭 코드에서는 리스트를 사용하는 것이 더 안전하고 권장됩니다.

#### 배열을 리스트로 변환:

배열을 리스트로 변환할 때는 `Arrays.asList()`를 사용할 수 있습니다.

```java
String[] stringArray = {"Hello", "World"};
List<String> stringList = Arrays.asList(stringArray);
```

이렇게 하면 배열을 리스트로 변환할 수 있고, 제네릭의 이점을 활용할 수 있습니다.

### 5. 요약

- **배열**은 공변성 때문에 타입 안전하지 않으며, 런타임에 오류가 발생할 수 있습니다.
- **리스트**는 불공변성 덕분에 컴파일 타임에 타입 체크가 이루어지며, 제네릭과 함께 사용할 때 더 안전합니다.
- 제네릭을 사용할 때는 **리스트를 배열보다 선호**해야 하며, 이는 코드의 안전성과 유연성을 높이는 방법입니다.
- 제네릭 배열 생성은 불가능하기 때문에, 배열 대신 리스트를 사용하는 것이 더 나은 선택입니다.

결론적으로, **제네릭 프로그래밍**에서는 **배열보다 리스트를 사용**함으로써 코드의 **안전성**과 **가독성**을 높일 수 있습니다.
