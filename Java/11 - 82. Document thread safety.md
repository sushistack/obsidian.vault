**Document Thread Safety**는 《Effective Java》의 항목 82에서 다루는 내용으로, **스레드 안전성(thread safety)**을 명확하게 **문서화**하는 것이 중요하다는 점을 강조합니다. 멀티스레드 환경에서 **스레드 안전성**을 보장하는 클래스는 예외나 버그를 방지하기 위해 어떻게 설계되었고 어떤 방식으로 동작하는지 명확하게 설명해야 합니다. 이를 통해 개발자는 해당 클래스를 사용할 때 **스레드 안전성**에 대해 명확하게 이해하고, 적절한 방식으로 사용할 수 있습니다.

### 주요 개념:

1. **스레드 안전성(Thread Safety)란?**
   **스레드 안전성**이란 여러 스레드가 동시에 접근할 때도 객체의 **상태가 손상되지 않고** 올바르게 동작하는 것을 의미합니다. 스레드 안전성을 보장하지 않으면, 멀티스레드 환경에서 **데이터 불일치**, **경쟁 상태**(race condition), **데드락**(deadlock)과 같은 동시성 문제가 발생할 수 있습니다.

   스레드 안전성을 보장하는 방법에는 여러 가지가 있습니다:
   - **불변 객체**: 상태가 변하지 않기 때문에 여러 스레드에서 동시에 접근해도 안전합니다.
   - **동기화**: `synchronized` 키워드나 동기화 블록을 사용하여 스레드 간 자원 접근을 제어합니다.
   - **고수준 동시성 도구**: `java.util.concurrent` 패키지에 포함된 동시성 유틸리티(`Atomic` 클래스, `ConcurrentHashMap` 등)를 사용하여 동시성을 관리합니다.

2. **스레드 안전성을 문서화해야 하는 이유**
   - **정확한 사용 방법 제공**: 클래스를 사용하는 개발자에게 이 클래스가 **스레드 안전**한지, 안전하지 않은지 명확히 설명하면 개발자가 잘못된 방식으로 클래스를 사용하지 않도록 도와줍니다.
   - **잠재적 오류 방지**: 스레드 안전성을 정확히 문서화하면 스레드 간의 **경쟁 상태**나 **데드락**을 예방하고, 예기치 못한 버그 발생을 줄일 수 있습니다.
   - **유지보수성 향상**: 스레드 안전성에 대한 문서가 있으면 코드를 수정할 때 **안전성 보장**을 위해 무엇을 주의해야 하는지 명확하게 알 수 있습니다.

3. **스레드 안전성을 설명하는 기본 방식**

   **클래스의 스레드 안전성을 설명할 때, 다음을 포함해야 합니다:**
   - **스레드 안전성 보장 여부**: 이 클래스가 **스레드 안전한지** 또는 **안전하지 않은지** 명확히 설명합니다.
   - **동기화 방법**: 스레드 안전성을 어떻게 보장하는지, 동기화를 사용하거나 고수준 동시성 도구를 사용하는지 설명합니다.
   - **사용자 요구사항**: 만약 사용자 측에서 별도로 동기화가 필요하다면, 그 부분을 명확히 기술합니다.
   - **스레드 안전성 관련된 예외 사항**: 특정 메서드나 사용 패턴에서만 스레드 안전하지 않거나, 동기화가 필요하다면 이를 설명합니다.

4. **예시 1: 불변 객체의 스레드 안전성 문서화**

   **불변 객체**는 여러 스레드에서 동시에 접근하더라도 상태가 변경되지 않으므로, 스레드 안전성을 보장합니다. 불변 객체는 주로 자바에서 자동으로 스레드 안전성을 보장하므로, 불변 객체를 사용할 때는 이를 명확히 문서화합니다.

   ```java
   /**
    * ImmutablePoint는 불변 객체로 스레드 안전성을 보장합니다.
    * 이 클래스는 여러 스레드에서 동시에 안전하게 사용할 수 있습니다.
    */
   public final class ImmutablePoint {
       private final int x;
       private final int y;

       public ImmutablePoint(int x, int y) {
           this.x = x;
           this.y = y;
       }

       public int getX() { return x; }
       public int getY() { return y; }
   }
   ```

   **이유**: 불변 객체는 상태가 절대 변경되지 않으므로, 스레드 간 동기화 없이도 안전하게 사용할 수 있음을 문서화했습니다.

5. **예시 2: 동기화된 클래스의 스레드 안전성 문서화**

   **동기화된 클래스**는 내부적으로 `synchronized` 키워드나 동기화 블록을 사용하여 스레드 안전성을 보장합니다. 이 경우, 클래스가 스레드 안전하다는 사실과 동기화 방식에 대해 명시적으로 설명해야 합니다.

   ```java
   /**
    * Counter 클래스는 스레드 안전합니다. 모든 메서드는 동기화되어 있어
    * 여러 스레드가 이 클래스를 동시에 안전하게 사용할 수 있습니다.
    */
   public class Counter {
       private int count = 0;

       public synchronized void increment() {
           count++;
       }

       public synchronized int getCount() {
           return count;
       }
   }
   ```

   **이유**: `Counter` 클래스는 `synchronized` 키워드를 사용하여 스레드 안전성을 보장하며, 클래스 문서에서 이를 명확히 설명하여 개발자가 안심하고 사용할 수 있게 합니다.

6. **예시 3: 고수준 동시성 도구 사용한 클래스의 스레드 안전성 문서화**

   **`java.util.concurrent` 패키지**의 동시성 유틸리티를 사용하는 클래스는 고수준 동시성 도구를 통해 스레드 안전성을 보장할 수 있습니다. 이 경우, 어떤 도구를 사용하는지 문서에 명시해야 합니다.

   ```java
   import java.util.concurrent.atomic.AtomicInteger;

   /**
    * AtomicCounter 클래스는 스레드 안전합니다.
    * 내부적으로 AtomicInteger를 사용하여 동기화 없이도 스레드 안전성을 보장합니다.
    */
   public class AtomicCounter {
       private final AtomicInteger count = new AtomicInteger(0);

       public void increment() {
           count.incrementAndGet();
       }

       public int getCount() {
           return count.get();
       }
   }
   ```

   **이유**: `AtomicInteger`는 원자적 연산을 제공하여 동기화 없이도 스레드 안전성을 보장하며, 이를 문서화하여 개발자가 스레드 안전성을 이해할 수 있도록 돕습니다.

7. **스레드 안전하지 않은 클래스의 문서화**

   **스레드 안전하지 않은 클래스**의 경우, 사용자 측에서 별도의 동기화가 필요하다는 사실을 문서화해야 합니다. 이 클래스가 스레드 안전하지 않다는 것을 명시하고, 언제 어떻게 동기화해야 하는지 설명하는 것이 중요합니다.

   ```java
   /**
    * UnsafeCounter 클래스는 스레드 안전하지 않습니다.
    * 여러 스레드에서 이 클래스를 사용할 때는 외부에서 동기화를 적용해야 합니다.
    */
   public class UnsafeCounter {
       private int count = 0;

       public void increment() {
           count++;
       }

       public int getCount() {
           return count;
       }
   }
   ```

   **이유**: `UnsafeCounter`는 스레드 안전하지 않으므로, 이 클래스는 멀티스레드 환경에서 직접 사용할 수 없으며, 외부에서 동기화가 필요하다는 점을 명확히 문서화합니다.

8. **스레드 안전성과 관련된 중요한 정보**

   스레드 안전성과 관련해 문서화해야 할 중요한 정보:
   - **동기화 방식**: 클래스가 스레드 안전을 보장하는지, 그 방식이 무엇인지 설명합니다.
   - **스레드 안전성이 보장되는 범위**: 클래스 전체가 스레드 안전한지, 특정 메서드만 안전한지 구체적으로 명시합니다.
   - **멀티스레드 환경에서의 사용 조건**: 클래스가 스레드 안전하지 않은 경우, 사용자 측에서 어떤 조건에서 동기화를 적용해야 하는지 설명합니다.

### 요약:

- **스레드 안전성을 문서화**하면 클래스를 사용하는 개발자가 멀티스레드 환경에서 안전하게 해당 클래스를 사용할 수 있습니다.
- **스레드 안전한지 여부**를 명확하게 설명하고, 안전한 경우에는 어떻게 스레드 안전성을 보장하는지 설명해야 합니다.
- **불변 객체**, **동기화된 메서드**, **고수준 동시성 도구** 등을 사용하여 스레드 안전성을 확보한 경우, 그 방식과 사용 방법을 명확하게 문서화합니다.
- **스레드 안전하지 않은 클래스**는 사용자 측에서 별도의 동기화가 필요함을 명시하고, 구체적인 사용 지침을 제공해야 합니다.
